<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover">
<meta name="theme-color" content="#060810">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<title>CONV√äNIO DPE-OAB 001/2026 | PAINEL LEND√ÅRIO ‚Äî C√ÅSSIA KELLY</title>
<link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700;900&family=DM+Sans:wght@300;400;500;600&family=DM+Mono:wght@400;500&display=swap" rel="stylesheet">
<style>
:root {
  --gold: #C9A84C;
  --gold-bright: #F0C860;
  --gold-dark: #8B6914;
  --obsidian: #060810;
  --deep: #0C1120;
  --surface: #111827;
  --surface2: #1C2536;
  --surface3: #253047;
  --text: #E8EDF5;
  --text-muted: #8B9AB5;
  --accent: #4A90D9;
  --green: #2ECC71;
  --red: #E74C3C;
  --border: rgba(201,168,76,0.2);
}
* { margin:0; padding:0; box-sizing:border-box; }
body {
  background: var(--obsidian);
  color: var(--text);
  font-family: 'DM Sans', sans-serif;
  min-height: 100vh;
  overflow-x: hidden;
  -webkit-text-size-adjust: 100%;
}
html {
  scroll-behavior: smooth;
  -webkit-tap-highlight-color: transparent;
}

/* PARTICLE BG */
#particles {
  position: fixed; top:0; left:0; width:100%; height:100%;
  pointer-events: none; z-index:0; overflow:hidden;
}
.particle {
  position: absolute; width:2px; height:2px;
  background: var(--gold); border-radius:50%; opacity:0;
  animation: float-up linear infinite;
}
@keyframes float-up {
  0% { transform:translateY(100vh) translateX(0); opacity:0; }
  10% { opacity:0.4; }
  90% { opacity:0.2; }
  100% { transform:translateY(-10vh) translateX(40px); opacity:0; }
}

/* HEADER */
header {
  position: sticky; top:0; z-index:100;
  background: linear-gradient(135deg, rgba(6,8,16,0.98), rgba(12,17,32,0.98));
  border-bottom: 1px solid var(--border);
  backdrop-filter: blur(20px);
  padding: 0 24px;
}
.header-inner {
  max-width: 1400px; margin:0 auto;
  display:flex; align-items:center; justify-content:space-between;
  height: 64px;
}
.logo {
  font-family: 'Playfair Display', serif;
  font-size: 1.1rem; font-weight:700;
  color: var(--gold);
  letter-spacing: 1px;
  display:flex; align-items:center; gap:10px;
}
.logo-icon {
  width:32px; height:32px;
  background: linear-gradient(135deg, var(--gold), var(--gold-dark));
  border-radius: 6px;
  display:flex; align-items:center; justify-content:center;
  font-size:14px;
}
.badge {
  background: linear-gradient(135deg, var(--gold-dark), var(--gold));
  color: var(--obsidian);
  font-size:9px; font-weight:700;
  padding: 2px 8px; border-radius:20px;
  letter-spacing:1px; text-transform:uppercase;
}
.header-stats {
  display:flex; gap:20px;
}
.hstat {
  text-align:center;
  font-size:11px; color: var(--text-muted);
}
@media(max-width:479px) { .hstat-hide-sm { display:none; } }
.hstat strong {
  display:block;
  font-size:18px; font-weight:700;
  color: var(--gold);
  font-family: 'DM Mono', monospace;
}

/* NAV TABS */
nav {
  background: var(--deep);
  border-bottom: 1px solid var(--border);
  overflow-x: auto;
}
.nav-inner {
  max-width:1400px; margin:0 auto;
  display:flex; gap:0; padding:0 16px;
}
.tab {
  background:none; border:none; outline:none;
  color: var(--text-muted);
  padding: 14px 20px;
  font-family:'DM Sans',sans-serif; font-size:12px; font-weight:600;
  cursor:pointer; text-transform:uppercase; letter-spacing:.8px;
  border-bottom: 2px solid transparent;
  transition: all .2s; white-space:nowrap;
  display:flex; align-items:center; gap:7px;
}
.tab:hover { color:var(--gold); }
.tab.active {
  color: var(--gold);
  border-bottom-color: var(--gold);
  background: rgba(201,168,76,.05);
}
.tab-icon { font-size:14px; }

/* MAIN */
main { max-width:1400px; margin:0 auto; padding:clamp(12px, 3vw, 24px); position:relative; z-index:1; }
.panel { display:none; }
.panel.active { display:block; }

/* SECTION HEADERS */
.section-header {
  margin-bottom:28px;
}
.section-title {
  font-family:'Playfair Display',serif;
  font-size:clamp(1.4rem, 4vw, 2rem); font-weight:900;
  color: var(--gold);
  line-height:1.1;
}
.section-subtitle {
  color:var(--text-muted); font-size:.9rem; margin-top:6px;
}
.gold-line {
  width:60px; height:3px;
  background:linear-gradient(90deg, var(--gold), transparent);
  margin: 10px 0;
}

/* ========== ABA 1: DOCUMENTO 24 FOLHAS ========== */
.doc-toolbar {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:14px 16px;
  display:flex; align-items:center; gap:10px;
  margin-bottom:16px; flex-wrap:wrap;
  justify-content: space-between;
}
.audio-controls { display:flex; gap:8px; align-items:center; }
.audio-btn {
  background:var(--surface2); border:1px solid var(--border);
  color:var(--gold); width:40px; height:40px; border-radius:50%;
  cursor:pointer; font-size:14px; transition:all .2s;
  display:flex; align-items:center; justify-content:center;
}
.audio-btn:hover { background:var(--gold); color:var(--obsidian); }
.audio-btn.playing { background:var(--gold); color:var(--obsidian); animation:pulse 1s infinite; }
@keyframes pulse { 0%,100%{transform:scale(1)} 50%{transform:scale(1.1)} }
.speed-control { display:flex; align-items:center; gap:8px; font-size:12px; color:var(--text-muted); }
.speed-select {
  background:var(--surface2); border:1px solid var(--border);
  color:var(--gold); padding:6px 10px; border-radius:6px; font-size:12px;
}
.page-nav { display:flex; gap:8px; margin-left:auto; }
.page-btn {
  background:var(--surface2); border:1px solid var(--border);
  color:var(--text); padding:8px 14px; border-radius:6px;
  cursor:pointer; font-size:12px; font-weight:600; transition:.2s;
}
.page-btn:hover { border-color:var(--gold); color:var(--gold); }
.page-progress {
  font-family:'DM Mono',monospace; font-size:12px;
  color:var(--gold); padding:8px 14px;
  background:var(--surface2); border-radius:6px;
  border:1px solid var(--border);
}

.doc-pages-container {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; overflow:hidden;
}
.doc-page {
  display:none;
  padding:50px 60px;
  background: white;
  color: #1a1a1a;
  min-height: 900px;
  position:relative;
  line-height:1.8;
}
.doc-page.active { display:block; }
.doc-page h1 { font-size:1.2rem; text-align:center; margin-bottom:8px; }
.doc-page h2 { font-size:1.05rem; text-align:center; color:#333; margin-bottom:16px; }
.doc-page h3 { font-size:1rem; margin:20px 0 10px; color:#111; border-bottom:1px solid #e0c060; padding-bottom:4px; }
.doc-page p { margin-bottom:12px; font-size:13.5px; }
.doc-page ul { margin:8px 0 12px 20px; }
.doc-page li { margin-bottom:6px; font-size:13px; }
.doc-page .page-header {
  text-align:center; margin-bottom:30px;
  border-bottom:2px solid #C9A84C; padding-bottom:20px;
}
.doc-page .page-num-badge {
  position:absolute; top:20px; right:30px;
  background:#C9A84C; color:#000;
  padding:3px 12px; border-radius:20px;
  font-size:11px; font-weight:700;
}
.doc-page .table-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; margin:16px 0; }
.doc-page table {
  width:100%; border-collapse:collapse; font-size:12px; min-width:400px;
}
.doc-page th {
  background:#C9A84C; color:#000; padding:8px;
  font-weight:700; text-align:left;
}
.doc-page td { padding:7px 8px; border-bottom:1px solid #e0e0e0; }
.doc-page tr:nth-child(even) td { background:#f9f5e8; }
.doc-page .highlight { background:#FFF9E6; border-left:4px solid #C9A84C; padding:12px 16px; margin:16px 0; }
.doc-page .art-num { font-weight:700; color:#8B6914; }

/* ========== ABA 2: FLASHCARDS ========== */
.flash-controls {
  display:flex; gap:10px; margin-bottom:20px; flex-wrap:wrap; align-items:center;
  overflow-x: visible;
}
.cat-filter {
  display:flex; gap:6px; flex-wrap:wrap;
  overflow-x: auto; -webkit-overflow-scrolling: touch;
  padding-bottom: 4px; max-width: 100%;
}
.fc-stat {
  background:var(--surface); border:1px solid var(--border);
  border-radius:8px; padding:10px 16px;
  font-size:12px; color:var(--text-muted);
}
.fc-stat strong { display:block; font-size:20px; font-weight:700; color:var(--gold); }
/* cat-filter moved above */
.cat-btn {
  background:var(--surface); border:1px solid var(--border);
  color:var(--text-muted); padding:6px 14px; border-radius:20px;
  cursor:pointer; font-size:11px; font-weight:600; transition:.2s;
  text-transform:uppercase; letter-spacing:.5px;
}
.cat-btn:hover, .cat-btn.active { background:var(--gold); color:var(--obsidian); border-color:var(--gold); }

.cards-grid {
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
  gap:16px;
}
.flashcard {
  height:200px; cursor:pointer;
  /* Perspective no pr√≥prio card para melhor compatibilidade mobile */
  perspective:1000px;
  -webkit-perspective:1000px;
}
.fc-inner {
  width:100%; height:100%;
  transform-style:preserve-3d;
  -webkit-transform-style:preserve-3d;
  transition:transform .6s cubic-bezier(.4,0,.2,1);
  -webkit-transition:-webkit-transform .6s cubic-bezier(.4,0,.2,1);
  position:relative;
}
.flashcard.flipped .fc-inner {
  transform:rotateY(180deg);
  -webkit-transform:rotateY(180deg);
}
.fc-front, .fc-back {
  position:absolute; width:100%; height:100%;
  backface-visibility:hidden;
  -webkit-backface-visibility:hidden;
  border-radius:12px;
  padding:20px; display:flex; flex-direction:column;
  justify-content:space-between;
  /* Force GPU layer para evitar glitch */
  -webkit-transform:translateZ(0);
  will-change:transform;
}
.fc-front {
  background:var(--surface);
  border:1px solid var(--border);
  -webkit-transform:rotateY(0deg);
  transform:rotateY(0deg);
  /* fav button positions relative to this */
  overflow:visible;
}
.fc-back {
  background:linear-gradient(135deg, var(--gold-dark), var(--gold));
  color:var(--obsidian);
  -webkit-transform:rotateY(180deg);
  transform:rotateY(180deg);
}
.fc-cat {
  font-size:10px; font-weight:700; text-transform:uppercase;
  letter-spacing:1px; color:var(--gold); margin-bottom:8px;
}
.fc-back .fc-cat { color:rgba(0,0,0,0.5); }
.fc-question { font-size:.9rem; font-weight:600; color:var(--text); flex:1; display:flex; align-items:center; }
.fc-back .fc-answer { font-size:.85rem; font-weight:600; flex:1; display:flex; align-items:center; color:var(--obsidian); }
.fc-hint { font-size:10px; color:var(--text-muted); text-align:right; }
.fc-back .fc-hint { color:rgba(0,0,0,0.4); }
.fc-stars {
  display:flex; gap:3px;
}
.fc-star { font-size:12px; color:var(--gold-dark); cursor:pointer; }
.fc-star.lit { color:var(--gold-bright); }

/* REGRAS PANEL */
.rules-grid {
  display:grid; grid-template-columns:repeat(auto-fill, minmax(340px, 1fr));
  gap:16px;
}
.rule-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:20px;
  border-left:4px solid var(--gold);
  transition:all .2s;
}
.rule-card:hover { border-left-color:var(--gold-bright); background:var(--surface2); transform:translateY(-2px); }
.rule-num {
  font-family:'DM Mono',monospace; font-size:10px;
  color:var(--gold); font-weight:700; margin-bottom:6px;
}
.rule-title { font-weight:700; font-size:.95rem; margin-bottom:8px; color:var(--text); }
.rule-text { font-size:.82rem; color:var(--text-muted); line-height:1.6; }
.rule-tag {
  display:inline-block;
  background:rgba(201,168,76,.1); border:1px solid var(--border);
  color:var(--gold); padding:2px 8px; border-radius:10px;
  font-size:9px; font-weight:700; text-transform:uppercase;
  margin-top:8px; letter-spacing:.5px;
}

/* QUIZ */
.quiz-start {
  text-align:center; padding:clamp(24px,5vw,60px) clamp(16px,4vw,40px);
}
.quiz-start h2 {
  font-family:'Playfair Display',serif;
  font-size:2.5rem; color:var(--gold); margin-bottom:12px;
}
.quiz-start p { color:var(--text-muted); margin-bottom:32px; font-size:1rem; }
.btn-gold {
  background:linear-gradient(135deg, var(--gold-dark), var(--gold));
  color:var(--obsidian); border:none; padding:14px 36px;
  border-radius:8px; font-size:1rem; font-weight:700;
  cursor:pointer; transition:all .2s; letter-spacing:.5px;
}
.btn-gold:hover { transform:translateY(-2px); box-shadow:0 8px 30px rgba(201,168,76,.3); }
.btn-outline {
  background:transparent; border:1px solid var(--gold);
  color:var(--gold); padding:10px 24px; border-radius:8px;
  font-size:.9rem; font-weight:600; cursor:pointer; transition:.2s;
}
.btn-outline:hover { background:var(--gold); color:var(--obsidian); }
.quiz-start .stats-row {
  display:flex; justify-content:center; gap:30px; margin-bottom:40px;
}
.quiz-start .stat-box {
  background:var(--surface); border:1px solid var(--border);
  border-radius:10px; padding:16px 24px; text-align:center;
}
.quiz-start .stat-box strong {
  display:block; font-size:2rem; color:var(--gold);
  font-family:'DM Mono',monospace;
}
.quiz-start .stat-box span { font-size:.8rem; color:var(--text-muted); }

.quiz-container { display:none; }
.quiz-header {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:16px 20px;
  display:flex; align-items:center; gap:16px; margin-bottom:24px;
}
.quiz-progress-bar {
  flex:1; height:8px; background:var(--surface2);
  border-radius:4px; overflow:hidden;
}
.quiz-progress-fill {
  height:100%; background:linear-gradient(90deg, var(--gold-dark), var(--gold));
  border-radius:4px; transition:width .5s;
}
.quiz-num {
  font-family:'DM Mono',monospace; font-size:13px; color:var(--gold); font-weight:600;
}
.quiz-timer {
  background:var(--surface2); border:1px solid var(--border);
  padding:6px 14px; border-radius:20px;
  font-family:'DM Mono',monospace; font-size:14px; font-weight:700;
  color:var(--gold); min-width:60px; text-align:center;
}
.quiz-timer.urgent { color:var(--red); animation:pulse .5s infinite; }
.quiz-score-live {
  font-size:13px; color:var(--text-muted);
}
.quiz-score-live span { color:var(--green); font-weight:700; }

.quiz-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:16px; padding:32px; margin-bottom:24px;
}
.quiz-category {
  font-size:10px; text-transform:uppercase; letter-spacing:1px;
  color:var(--gold); font-weight:700; margin-bottom:12px;
}
.quiz-question {
  font-size:1.15rem; font-weight:600; line-height:1.6;
  margin-bottom:28px; color:var(--text);
}
.quiz-options {
  display:grid;
  grid-template-columns: repeat(auto-fit, minmax(min(100%, 280px), 1fr));
  gap:10px;
}
.quiz-opt {
  background:var(--surface2); border:1px solid var(--border);
  border-radius:10px; padding:14px 18px;
  cursor:pointer; transition:all .2s;
  text-align:left; font-size:.9rem; color:var(--text);
  font-family:'DM Sans',sans-serif;
}
.quiz-opt:hover:not(:disabled) { border-color:var(--gold); background:var(--surface3); }
.quiz-opt.correct { background:rgba(46,204,113,.15); border-color:var(--green); color:var(--green); }
.quiz-opt.wrong { background:rgba(231,76,60,.15); border-color:var(--red); color:var(--red); }
.quiz-opt:disabled { cursor:default; }
.quiz-explanation {
  display:none;
  background:rgba(201,168,76,.08); border:1px solid var(--border);
  border-radius:10px; padding:16px; margin-top:16px;
  font-size:.85rem; color:var(--text-muted); line-height:1.6;
}
.quiz-explanation.show { display:block; }
.quiz-explanation strong { color:var(--gold); }
.quiz-next {
  display:none; margin-top:20px;
}
.quiz-next.show { display:flex; justify-content:flex-end; }

/* CERTIFICATE */
.cert-container { display:none; text-align:center; padding:40px 20px; }
.cert-container.show { display:block; }
.cert-box {
  background: linear-gradient(135deg, #0C1120, #1C2536);
  border:2px solid var(--gold);
  border-radius:16px; padding:clamp(24px, 5vw, 60px);
  max-width:800px; margin:0 auto;
  position:relative; overflow:hidden;
}
.cert-box::before {
  content:'';
  position:absolute; top:0; left:0; right:0; bottom:0;
  background:
    radial-gradient(ellipse at 20% 20%, rgba(201,168,76,.05), transparent 50%),
    radial-gradient(ellipse at 80% 80%, rgba(201,168,76,.05), transparent 50%);
  pointer-events:none;
}
.cert-corner {
  position:absolute; width:60px; height:60px;
  border-color:var(--gold); border-style:solid; border-width:0;
}
.cert-corner.tl { top:16px; left:16px; border-top-width:2px; border-left-width:2px; }
.cert-corner.tr { top:16px; right:16px; border-top-width:2px; border-right-width:2px; }
.cert-corner.bl { bottom:16px; left:16px; border-bottom-width:2px; border-left-width:2px; }
.cert-corner.br { bottom:16px; right:16px; border-bottom-width:2px; border-right-width:2px; }
.cert-seal { font-size:64px; margin-bottom:16px; }
.cert-title {
  font-family:'Playfair Display',serif; font-size:1rem;
  color:var(--gold); letter-spacing:3px; text-transform:uppercase;
  margin-bottom:6px;
}
.cert-subtitle {
  font-family:'Playfair Display',serif; font-size:clamp(1.2rem, 4vw, 2.2rem);
  color:var(--text); margin-bottom:8px; font-weight:700;
}
.cert-name {
  font-family:'Playfair Display',serif; font-size:clamp(1.4rem, 5vw, 2.8rem);
  color:var(--gold); font-weight:900; margin:16px 0;
  word-break: break-word;
}
.cert-text { color:var(--text-muted); font-size:.95rem; line-height:1.7; margin-bottom:24px; }
.cert-score {
  display:inline-block;
  background:linear-gradient(135deg, var(--gold-dark), var(--gold));
  color:var(--obsidian); padding:12px 36px; border-radius:8px;
  font-size:1.5rem; font-weight:900; margin:16px 0;
}
.cert-date { color:var(--text-muted); font-size:.85rem; margin-top:20px; }
.cert-line { border:none; border-top:1px solid var(--border); margin:24px auto; width:200px; }
.cert-issued { font-size:.8rem; color:var(--text-muted); font-style:italic; }
.cert-stars { font-size:24px; margin:12px 0; color:var(--gold); }
.cert-actions { margin-top:24px; display:flex; gap:12px; justify-content:center; flex-wrap:wrap; }

/* DESAFIOS */
.challenges-grid {
  display:grid; grid-template-columns:repeat(auto-fill, minmax(300px, 1fr));
  gap:20px;
}
.challenge-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:24px;
  position:relative; overflow:hidden;
  transition:all .3s;
}
.challenge-card::before {
  content:''; position:absolute; top:0; left:0; right:0; height:3px;
  background:linear-gradient(90deg, var(--gold-dark), var(--gold));
}
.challenge-card:hover { transform:translateY(-3px); box-shadow:0 12px 40px rgba(201,168,76,.15); }
.ch-icon { font-size:36px; margin-bottom:12px; }
.ch-title { font-weight:700; font-size:1rem; margin-bottom:8px; color:var(--text); }
.ch-desc { font-size:.82rem; color:var(--text-muted); line-height:1.5; margin-bottom:12px; }
.ch-progress {
  background:var(--surface2); border-radius:4px;
  height:6px; overflow:hidden; margin-bottom:8px;
}
.ch-fill { height:100%; background:linear-gradient(90deg, var(--gold-dark), var(--gold)); border-radius:4px; }
.ch-stats { display:flex; justify-content:space-between; font-size:11px; color:var(--text-muted); }
.ch-badge {
  position:absolute; top:16px; right:16px;
  background:rgba(201,168,76,.1); border:1px solid var(--border);
  color:var(--gold); padding:2px 8px; border-radius:10px;
  font-size:9px; font-weight:700; text-transform:uppercase;
}
.ch-locked { opacity:.5; filter:grayscale(.5); }
.ch-locked::after {
  content:'üîí';
  position:absolute; top:50%; left:50%; transform:translate(-50%,-50%);
  font-size:32px; z-index:2;
}

/* TABELA DE HONOR√ÅRIOS */
.honorarios-section h3 {
  font-family:'Playfair Display',serif;
  font-size:1.3rem; color:var(--gold);
  margin:28px 0 16px; padding-bottom:8px;
  border-bottom:1px solid var(--border);
}
.hon-table {
  width:100%; border-collapse:collapse; font-size:12px; margin-bottom:8px;
  min-width:460px;
}
.hon-table-wrap { overflow-x:auto; -webkit-overflow-scrolling:touch; margin-bottom:8px; border-radius:8px; }
.hon-table th {
  background:var(--surface2); padding:10px 12px;
  text-align:left; color:var(--gold); font-weight:700;
  font-size:11px; text-transform:uppercase; letter-spacing:.5px;
  border-bottom:1px solid var(--border);
}
.hon-table td {
  padding:9px 12px; border-bottom:1px solid rgba(255,255,255,.04);
  color:var(--text);
}
.hon-table tr:hover td { background:var(--surface2); }
.hon-table .code { font-family:'DM Mono',monospace; color:var(--gold); font-weight:600; }
.hon-table .value { font-family:'DM Mono',monospace; color:var(--green); }
.hon-table .pct70 { color:#F39C12; font-family:'DM Mono',monospace; }


/* ===== BUSCA NO DOCUMENTO ===== */
.doc-search-bar {
  display:flex; align-items:center; gap:8px; margin-bottom:12px;
}
.doc-search-input {
  flex:1; padding:10px 16px; background:var(--surface2);
  border:1px solid var(--border); border-radius:8px;
  color:var(--text); font-size:13px; outline:none;
  font-family:'DM Sans',sans-serif; max-width:400px;
}
.doc-search-input:focus { border-color:var(--gold); }
.search-hit { background:#C9A84C55; border-radius:2px; }
.search-status { font-size:11px; color:var(--text-muted); }

/* ===== PROGRESSO DE LEITURA ===== */
.reading-progress-bar {
  height:4px; background:var(--surface2); margin-bottom:20px;
  border-radius:2px; overflow:hidden;
}
.reading-progress-fill {
  height:100%; background:linear-gradient(90deg, var(--gold-dark), var(--gold));
  border-radius:2px; transition:width .5s;
}
.page-read-indicator {
  display:inline-block; width:8px; height:8px;
  background:var(--gold); border-radius:50%;
  margin-left:6px; opacity:0; transition:.3s;
}
.page-read-indicator.read { opacity:1; }
.reading-summary {
  font-size:11px; color:var(--gold); font-family:'DM Mono',monospace;
  padding:4px 10px; background:rgba(201,168,76,.1);
  border-radius:20px; border:1px solid var(--border);
}

/* ===== FAVORITOS NOS FLASHCARDS ===== */
.fc-fav-btn {
  background:none; border:none; cursor:pointer;
  font-size:16px; line-height:1; padding:2px;
  transition:transform .2s;
  position:absolute; top:10px; right:10px;
}
.fc-fav-btn:hover { transform:scale(1.3); }
.cat-btn.fav-active { background:#e74c3c; border-color:#e74c3c; color:#fff; }
.fc-stat.fav-stat strong { color:#e74c3c; }

/* ===== % ACERTO POR CATEGORIA ===== */
.cert-cat-breakdown {
  margin: 20px 0; text-align:left;
  background:var(--surface2); border:1px solid var(--border);
  border-radius:10px; padding:16px 20px;
  max-width:600px; margin:16px auto;
}
.cert-cat-breakdown h4 {
  font-family:'Playfair Display',serif; color:var(--gold);
  font-size:.9rem; letter-spacing:1px; margin-bottom:12px;
  text-align:center; text-transform:uppercase;
}
.cat-row {
  display:flex; align-items:center; gap:10px; margin-bottom:8px;
}
.cat-row-label {
  font-size:10px; font-weight:700; text-transform:uppercase;
  color:var(--text-muted); min-width:90px; letter-spacing:.5px;
}
.cat-row-bar {
  flex:1; height:8px; background:var(--surface3); border-radius:4px; overflow:hidden;
}
.cat-row-fill {
  height:100%; border-radius:4px;
  background:linear-gradient(90deg, var(--gold-dark), var(--gold));
  transition:width .8s;
}
.cat-row-fill.low { background:linear-gradient(90deg, #c0392b, #e74c3c); }
.cat-row-fill.mid { background:linear-gradient(90deg, #e67e22, #f39c12); }
.cat-row-pct {
  font-family:'DM Mono',monospace; font-size:11px;
  font-weight:700; color:var(--gold); min-width:38px; text-align:right;
}

/* ===== HIST√ìRICO DE TENTATIVAS ===== */
.history-section {
  margin-top:20px; max-width:600px; margin:20px auto;
}
.history-title {
  font-family:'Playfair Display',serif; font-size:.85rem;
  color:var(--gold); text-transform:uppercase; letter-spacing:1px;
  margin-bottom:10px; text-align:center;
}
.history-list {
  display:flex; flex-direction:column; gap:6px;
}
.history-item {
  background:var(--surface); border:1px solid var(--border);
  border-radius:8px; padding:10px 16px;
  display:flex; justify-content:space-between; align-items:center;
  font-size:12px;
}
.history-item .h-name { color:var(--text); font-weight:600; max-width:160px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
.history-item .h-score { font-family:'DM Mono',monospace; color:var(--gold); font-weight:700; }
.history-item .h-date { color:var(--text-muted); font-size:10px; }
.history-item .h-stars { font-size:10px; }
.history-empty { text-align:center; color:var(--text-muted); font-size:12px; font-style:italic; padding:10px; }


/* ===== FLASHCARD FLIP FALLBACK (para browsers sem preserve-3d perfeito) ===== */
body.no-3d .fc-inner {
  transform-style:flat !important;
  -webkit-transform-style:flat !important;
  transition:none !important;
}
body.no-3d .fc-front,
body.no-3d .fc-back {
  transition: opacity .25s, transform .25s;
  backface-visibility:visible !important;
  -webkit-backface-visibility:visible !important;
}
body.no-3d .fc-back {
  opacity:0;
  transform:rotateY(0deg) scale(0.95) !important;
  -webkit-transform:rotateY(0deg) scale(0.95) !important;
  pointer-events:none;
}
body.no-3d .flashcard.flipped .fc-inner {
  transform:none !important;
  -webkit-transform:none !important;
}
body.no-3d .flashcard.flipped .fc-front {
  opacity:0;
  transform:scale(0.95) !important;
  pointer-events:none;
}
body.no-3d .flashcard.flipped .fc-back {
  opacity:1;
  transform:rotateY(0deg) scale(1) !important;
  -webkit-transform:rotateY(0deg) scale(1) !important;
  pointer-events:auto;
}


/* ===================================================
   MAPA MENTAL
=================================================== */
#mapa-container { min-height: 520px; cursor: grab; }
#mapa-container:active { cursor: grabbing; }

/* ===================================================
   ASSISTENTE IA
=================================================== */
.ia-container {
  max-width: 860px; margin: 0 auto;
  display: flex; flex-direction: column; gap: 16px;
}
.ia-suggestions {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 12px; padding: 16px 20px;
}
.ia-sug-title {
  font-size: 11px; font-weight: 700; text-transform: uppercase;
  letter-spacing: 1px; color: var(--gold); margin-bottom: 10px;
}
.ia-sug-grid {
  display: grid; grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
  gap: 8px;
}
.ia-sug-btn {
  background: var(--surface2); border: 1px solid var(--border);
  color: var(--text-muted); padding: 8px 12px; border-radius: 8px;
  font-size: .8rem; text-align: left; cursor: pointer;
  transition: all .2s; font-family: 'DM Sans', sans-serif;
  line-height: 1.4;
}
.ia-sug-btn:hover { border-color: var(--gold); color: var(--gold); background: var(--surface3); }

.ia-chat {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 12px; padding: 20px;
  min-height: 300px; max-height: 420px; overflow-y: auto;
  display: flex; flex-direction: column; gap: 16px;
  scroll-behavior: smooth;
}
.ia-msg { display: flex; gap: 12px; align-items: flex-start; }
.ia-msg.ia-msg-user { flex-direction: row-reverse; }
.ia-avatar {
  width: 36px; height: 36px; border-radius: 50%; flex-shrink: 0;
  background: linear-gradient(135deg, var(--gold-dark), var(--gold));
  display: flex; align-items: center; justify-content: center;
  font-size: 16px;
}
.ia-msg.ia-msg-user .ia-avatar {
  background: var(--surface3); border: 1px solid var(--border);
}
.ia-bubble {
  background: var(--surface2); border: 1px solid var(--border);
  border-radius: 12px; padding: 12px 16px;
  font-size: .88rem; line-height: 1.7; color: var(--text);
  max-width: 82%;
}
.ia-msg.ia-msg-user .ia-bubble {
  background: rgba(201,168,76,.12); border-color: rgba(201,168,76,.3);
  color: var(--text);
}
.ia-bubble strong { color: var(--gold); }
.ia-bubble em { color: var(--text-muted); }
.ia-typing { display: flex; gap: 4px; padding: 8px 0; align-items: center; }
.ia-typing span {
  width: 7px; height: 7px; background: var(--gold); border-radius: 50%;
  animation: typing-bounce .9s infinite;
}
.ia-typing span:nth-child(2) { animation-delay: .15s; }
.ia-typing span:nth-child(3) { animation-delay: .3s; }
@keyframes typing-bounce {
  0%, 60%, 100% { transform: translateY(0); opacity: .4; }
  30% { transform: translateY(-8px); opacity: 1; }
}

.ia-input-row {
  display: flex; gap: 10px;
}
.ia-input {
  flex: 1; padding: 14px 18px;
  background: var(--surface); border: 2px solid var(--border);
  border-radius: 12px; color: var(--text); font-size: .95rem;
  font-family: 'DM Sans', sans-serif; outline: none; transition: border-color .2s;
}
.ia-input:focus { border-color: var(--gold); }
.ia-send-btn {
  width: 52px; height: 52px; border-radius: 12px; border: none; cursor: pointer;
  background: linear-gradient(135deg, var(--gold-dark), var(--gold));
  color: var(--obsidian); font-size: 18px; font-weight: 900;
  transition: all .2s; display: flex; align-items: center; justify-content: center;
  flex-shrink: 0;
}
.ia-send-btn:hover { transform: scale(1.05); box-shadow: 0 4px 20px rgba(201,168,76,.4); }
.ia-send-btn:disabled { opacity: .5; transform: none; }

/* ===================================================
   CONQUISTAS
=================================================== */
.conquistas-stats {
  display: flex; gap: 16px; margin-bottom: 24px; flex-wrap: wrap;
}
.cq-stat {
  background: var(--surface); border: 1px solid var(--border);
  border-radius: 10px; padding: 14px 20px; flex: 1; min-width: 120px;
  text-align: center;
}
.cq-stat strong {
  display: block; font-size: 2rem; font-weight: 900;
  color: var(--gold); font-family: 'DM Mono', monospace;
}
.cq-stat span { font-size: .8rem; color: var(--text-muted); }

.conquistas-grid {
  display: grid;
  grid-template-columns: repeat(auto-fill, minmax(240px, 1fr));
  gap: 16px;
}
.conquista-card {
  background: var(--surface); border: 2px solid var(--border);
  border-radius: 16px; padding: 24px 20px; text-align: center;
  position: relative; overflow: hidden; transition: all .3s;
}
.conquista-card.unlocked {
  border-color: var(--gold);
  background: linear-gradient(135deg, rgba(201,168,76,.08), var(--surface));
}
.conquista-card.unlocked::before {
  content: '';
  position: absolute; top: 0; left: 0; right: 0; height: 3px;
  background: linear-gradient(90deg, var(--gold-dark), var(--gold-bright), var(--gold-dark));
  animation: shimmer 2s infinite;
}
@keyframes shimmer {
  0% { background-position: -200% center; }
  100% { background-position: 200% center; }
}
.conquista-card.locked { opacity: .45; filter: grayscale(.7); }
.cq-badge-icon {
  font-size: 3rem; margin-bottom: 12px; display: block;
  transition: transform .3s;
}
.conquista-card.unlocked:hover .cq-badge-icon { transform: scale(1.2) rotate(5deg); }
.cq-badge-name {
  font-family: 'Playfair Display', serif; font-size: 1rem; font-weight: 700;
  color: var(--text); margin-bottom: 6px;
}
.conquista-card.unlocked .cq-badge-name { color: var(--gold); }
.cq-badge-desc {
  font-size: .78rem; color: var(--text-muted); line-height: 1.5; margin-bottom: 12px;
}
.cq-badge-status {
  font-size: .75rem; font-weight: 700; text-transform: uppercase; letter-spacing: .5px;
  padding: 4px 12px; border-radius: 20px; display: inline-block;
}
.conquista-card.unlocked .cq-badge-status {
  background: rgba(201,168,76,.2); color: var(--gold); border: 1px solid var(--gold);
}
.conquista-card.locked .cq-badge-status {
  background: var(--surface2); color: var(--text-muted); border: 1px solid var(--border);
}
.cq-unlock-anim {
  animation: unlock-pop .5s cubic-bezier(.175,.885,.32,1.275);
}
@keyframes unlock-pop {
  0% { transform: scale(.8); opacity: 0; }
  60% { transform: scale(1.08); }
  100% { transform: scale(1); opacity: 1; }
}

/* Toast notification */
.toast {
  position: fixed; bottom: 24px; right: 24px; z-index: 9999;
  background: linear-gradient(135deg, var(--gold-dark), var(--gold));
  color: var(--obsidian); padding: 14px 20px; border-radius: 12px;
  font-weight: 700; font-size: .9rem; box-shadow: 0 8px 32px rgba(201,168,76,.4);
  transform: translateY(100px); opacity: 0;
  transition: all .4s cubic-bezier(.175,.885,.32,1.275);
  max-width: 320px; display: flex; align-items: center; gap: 10px;
}
.toast.show { transform: translateY(0); opacity: 1; }

@media(max-width:479px) {
  .ia-sug-grid { grid-template-columns: 1fr; }
  .ia-chat { max-height: 320px; }
  .conquistas-grid { grid-template-columns: repeat(2, 1fr); }
  .conquista-card { padding: 16px 12px; }
  .cq-badge-icon { font-size: 2.2rem; }
  #mapa-container { min-height: 360px; }
}
@media(min-width:480px) and (max-width:767px) {
  .conquistas-grid { grid-template-columns: repeat(2, 1fr); }
}


/* ===========================================================
   TEMAS / THEMES
=========================================================== */
:root {
  --theme-name: 'Obsidian Gold';
}
body.theme-silver {
  --gold: #A8B8C8;
  --gold-bright: #D0E0F0;
  --gold-dark: #607080;
  --obsidian: #080C10;
  --surface: #101820;
  --surface2: #182030;
  --surface3: #202840;
  --border: rgba(168,184,200,0.2);
}
body.theme-bronze {
  --gold: #CD7F32;
  --gold-bright: #E8A050;
  --gold-dark: #7A4010;
  --obsidian: #080608;
  --surface: #120E0A;
  --surface2: #1E1610;
  --surface3: #281E18;
  --border: rgba(205,127,50,0.2);
}
body.theme-light {
  --gold: #8B6914;
  --gold-bright: #C9A84C;
  --gold-dark: #5A4008;
  --obsidian: #F5F0E8;
  --deep: #EDE8DC;
  --surface: #FFFFFF;
  --surface2: #F5F0E8;
  --surface3: #EDE8DC;
  --text: #1A1A1A;
  --text-muted: #666655;
  --border: rgba(139,105,20,0.2);
}
body.theme-light .doc-page { background:#FFFFFF; color:#1a1a1a; }
body.theme-light nav { background:#EDE8DC; }

/* Tab transition */
.panel {
  animation: panel-fade .3s ease;
}
@keyframes panel-fade {
  from { opacity:0; transform:translateY(8px); }
  to { opacity:1; transform:translateY(0); }
}

/* ===========================================================
   MODO BATALHA
=========================================================== */
.batalha-start {
  text-align:center; padding:clamp(24px,5vw,60px) 20px;
}
.batalha-hero {
  font-size:5rem; margin-bottom:16px;
  animation: float-hero 3s ease-in-out infinite;
}
@keyframes float-hero {
  0%,100% { transform:translateY(0) rotate(-5deg); }
  50% { transform:translateY(-16px) rotate(5deg); }
}
.batalha-title {
  font-family:'Playfair Display',serif; font-size:clamp(1.6rem,5vw,3rem);
  color:var(--gold); margin-bottom:10px; font-weight:900;
  text-shadow: 0 0 30px rgba(201,168,76,.4);
}
.batalha-subtitle {
  color:var(--text-muted); margin-bottom:30px; font-size:.95rem; line-height:1.6;
}
.batalha-stats-row {
  display:flex; justify-content:center; gap:20px; margin-bottom:36px; flex-wrap:wrap;
}
.b-stat {
  background:var(--surface); border:1px solid var(--border);
  border-radius:10px; padding:14px 20px; text-align:center; min-width:80px;
}
.b-stat strong {
  display:block; font-size:1.8rem; color:var(--gold);
  font-family:'DM Mono',monospace; font-weight:900;
}
.b-stat span { font-size:.75rem; color:var(--text-muted); }
.btn-batalha {
  background:linear-gradient(135deg, #8B1A1A, #C0392B);
  color:#fff; border:none; padding:16px 48px; border-radius:12px;
  font-size:1.1rem; font-weight:800; cursor:pointer;
  letter-spacing:1px; text-transform:uppercase;
  transition:all .2s; width:100%; max-width:320px;
  box-shadow: 0 4px 20px rgba(192,57,43,.4);
}
.btn-batalha:hover { transform:translateY(-2px); box-shadow:0 8px 32px rgba(192,57,43,.6); }
.batalha-header {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:14px 20px;
  display:flex; align-items:center; gap:16px; margin-bottom:20px; flex-wrap:wrap;
}
.b-lives { font-size:1.4rem; letter-spacing:4px; }
.b-score-live { color:var(--gold); font-weight:700; font-family:'DM Mono',monospace; font-size:1rem; }
.b-timer-bar {
  flex:1; height:10px; background:var(--surface2);
  border-radius:5px; overflow:hidden; min-width:80px;
}
.b-timer-fill {
  height:100%; background:linear-gradient(90deg,#27AE60,#F39C12,#E74C3C);
  border-radius:5px; transition:width .1s linear;
}
.b-timer-num {
  font-family:'DM Mono',monospace; font-weight:900;
  font-size:1.2rem; color:var(--gold); min-width:30px; text-align:center;
}
.b-timer-num.urgent { color:#E74C3C; animation:pulse .4s infinite; }
.batalha-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:16px; padding:clamp(20px,3vw,32px);
}
.b-cat {
  font-size:10px; text-transform:uppercase; letter-spacing:1.5px;
  color:var(--gold); font-weight:700; margin-bottom:10px;
}
.b-question {
  font-size:clamp(1rem,2.5vw,1.2rem); font-weight:700; line-height:1.6;
  margin-bottom:24px; color:var(--text);
}
.b-options {
  display:grid; grid-template-columns:repeat(auto-fit,minmax(min(100%,260px),1fr));
  gap:10px;
}
.b-opt {
  background:var(--surface2); border:2px solid var(--border);
  border-radius:10px; padding:14px 18px; cursor:pointer;
  font-size:.9rem; color:var(--text); text-align:left;
  font-family:'DM Sans',sans-serif; transition:all .15s;
}
.b-opt:hover:not(:disabled) { border-color:var(--gold); transform:translateY(-1px); }
.b-opt.correct { background:rgba(46,204,113,.2); border-color:#2ECC71; color:#2ECC71; }
.b-opt.wrong { background:rgba(231,76,60,.2); border-color:#E74C3C; color:#E74C3C;
  animation:shake .3s; }
@keyframes shake {
  0%,100%{transform:translateX(0)}
  25%{transform:translateX(-6px)}
  75%{transform:translateX(6px)}
}
.batalha-over-screen {
  text-align:center; padding:clamp(24px,5vw,60px) 20px;
  animation:panel-fade .5s ease;
}
.b-over-icon { font-size:4rem; margin-bottom:16px; }
.batalha-over-screen h2 {
  font-family:'Playfair Display',serif; font-size:2rem; color:var(--gold); margin-bottom:12px;
}
.b-over-score {
  font-size:3rem; font-weight:900; color:var(--gold);
  font-family:'DM Mono',monospace; margin:12px 0;
}
.b-over-record { color:var(--text-muted); font-size:.9rem; margin-bottom:8px; }
.b-over-combo { color:#F39C12; font-weight:700; font-size:1rem; }

/* ===========================================================
   PLANO 30 DIAS
=========================================================== */
.plano-header {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:16px 20px; margin-bottom:24px;
}
.plano-prog-bar {
  height:10px; background:var(--surface2); border-radius:5px; overflow:hidden;
}
.plano-prog-fill {
  height:100%; background:linear-gradient(90deg,var(--gold-dark),var(--gold));
  border-radius:5px; transition:width .6s;
}
.plano-grid {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(280px,1fr)); gap:12px;
}
.plano-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:16px 18px; cursor:pointer;
  transition:all .2s; position:relative; overflow:hidden;
}
.plano-card.done {
  border-color:var(--gold);
  background:linear-gradient(135deg,rgba(201,168,76,.06),var(--surface));
}
.plano-card.done::before {
  content:''; position:absolute; top:0; left:0; right:0; height:2px;
  background:linear-gradient(90deg,var(--gold-dark),var(--gold));
}
.plano-card:hover { transform:translateY(-2px); border-color:var(--gold); }
.plano-day {
  font-size:10px; color:var(--text-muted); font-weight:700;
  text-transform:uppercase; letter-spacing:1px; margin-bottom:4px;
}
.plano-title {
  font-weight:700; font-size:.9rem; color:var(--text); margin-bottom:6px;
}
.plano-card.done .plano-title { color:var(--gold); }
.plano-desc { font-size:.78rem; color:var(--text-muted); line-height:1.5; }
.plano-check {
  position:absolute; top:14px; right:14px;
  font-size:1.2rem; transition:transform .3s;
}
.plano-card.done .plano-check { transform:scale(1.2); }
.plano-week-header {
  grid-column: 1/-1;
  font-family:'Playfair Display',serif; color:var(--gold);
  font-size:1rem; font-weight:700; padding:8px 0 4px;
  border-bottom:1px solid var(--border); margin-bottom:4px;
}

/* ===========================================================
   AN√ÅLISE IA
=========================================================== */
.analise-container { max-width:900px; margin:0 auto; }
.analise-cards-row {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(180px,1fr));
  gap:14px; margin-bottom:24px;
}
.analise-card {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:16px; text-align:center;
}
.analise-card .ac-icon { font-size:2rem; margin-bottom:8px; }
.analise-card .ac-val {
  font-size:1.8rem; font-weight:900; color:var(--gold);
  font-family:'DM Mono',monospace;
}
.analise-card .ac-label { font-size:.75rem; color:var(--text-muted); margin-top:4px; }
.analise-block {
  background:var(--surface); border:1px solid var(--border);
  border-radius:12px; padding:20px; margin-bottom:20px;
}
.analise-block-title {
  font-family:'Playfair Display',serif; color:var(--gold); font-size:1rem;
  margin-bottom:16px; font-weight:700;
}
.weak-item {
  display:flex; align-items:center; gap:12px;
  padding:10px 0; border-bottom:1px solid rgba(255,255,255,.05);
}
.weak-item:last-child { border-bottom:none; }
.weak-item .wi-cat {
  min-width:100px; font-size:11px; font-weight:700; text-transform:uppercase;
  color:var(--text-muted); letter-spacing:.5px;
}
.weak-item .wi-bar {
  flex:1; height:8px; background:var(--surface2); border-radius:4px; overflow:hidden;
}
.weak-item .wi-fill {
  height:100%; border-radius:4px;
  background:linear-gradient(90deg,#C0392B,#E74C3C);
}
.weak-item .wi-fill.ok { background:linear-gradient(90deg,var(--gold-dark),var(--gold)); }
.weak-item .wi-fill.mid { background:linear-gradient(90deg,#E67E22,#F39C12); }
.weak-item .wi-pct {
  min-width:38px; text-align:right; font-family:'DM Mono',monospace;
  font-size:11px; font-weight:700;
}
.analise-ia-box {
  background:var(--surface); border:2px solid var(--border);
  border-radius:16px; padding:24px;
}
.analise-ia-header {
  display:flex; align-items:center; gap:10px;
  font-family:'Playfair Display',serif; color:var(--gold);
  font-size:1.1rem; font-weight:700; margin-bottom:16px;
}
.analise-ia-response {
  font-size:.9rem; line-height:1.8; color:var(--text);
  white-space:pre-wrap;
}
.analise-ia-response strong { color:var(--gold); }

/* ===========================================================
   STREAK
=========================================================== */
.streak-container {
  max-width:700px; margin:0 auto;
  display:flex; flex-direction:column; gap:28px;
}
.streak-main {
  background:var(--surface); border:1px solid var(--border);
  border-radius:16px; padding:clamp(24px,4vw,48px);
  text-align:center;
}
.streak-fire-icon {
  font-size:5rem; margin-bottom:8px;
  animation:float-hero 2s ease-in-out infinite;
}
.streak-number {
  font-size:clamp(4rem,10vw,7rem); font-weight:900; color:var(--gold);
  font-family:'DM Mono',monospace; line-height:1;
  text-shadow:0 0 40px rgba(201,168,76,.5);
}
.streak-label {
  color:var(--text-muted); font-size:.95rem; margin-bottom:8px;
}
.streak-msg {
  font-size:1rem; color:var(--text); font-weight:600; margin-bottom:4px;
}
.streak-calendar {
  background:var(--surface); border:1px solid var(--border);
  border-radius:16px; padding:20px;
}
.streak-cal-title {
  color:var(--gold); font-family:'Playfair Display',serif;
  font-size:1rem; font-weight:700; margin-bottom:14px; text-align:center;
}
.streak-cal-grid {
  display:grid; grid-template-columns:repeat(7,1fr); gap:6px;
}
.streak-cal-day {
  aspect-ratio:1; border-radius:6px; display:flex; align-items:center;
  justify-content:center; font-size:10px; font-weight:700;
  background:var(--surface2); color:var(--text-muted);
  border:1px solid var(--border); transition:all .2s;
}
.streak-cal-day.studied {
  background:rgba(201,168,76,.2); color:var(--gold); border-color:var(--gold);
}
.streak-cal-day.today {
  border-color:var(--gold-bright); box-shadow:0 0 10px rgba(201,168,76,.3);
}
.streak-cal-day.studied.today {
  background:linear-gradient(135deg,var(--gold-dark),var(--gold));
  color:var(--obsidian); border-color:var(--gold-bright);
}
.streak-miles-grid {
  display:grid; grid-template-columns:repeat(auto-fill,minmax(140px,1fr)); gap:10px;
}
.streak-mile {
  background:var(--surface); border:1px solid var(--border);
  border-radius:10px; padding:12px; text-align:center;
  transition:all .2s;
}
.streak-mile.reached {
  border-color:var(--gold);
  background:rgba(201,168,76,.08);
}
.streak-mile .sm-icon { font-size:1.8rem; margin-bottom:4px; display:block; }
.streak-mile .sm-days { color:var(--gold); font-weight:900; font-size:1.1rem; font-family:'DM Mono',monospace; }
.streak-mile .sm-label { font-size:.72rem; color:var(--text-muted); }

/* ===========================================================
   RESPONSIVE additions
=========================================================== */
@media(max-width:479px) {
  .batalha-stats-row { gap:10px; }
  .b-stat { min-width:64px; padding:10px 12px; }
  .b-stat strong { font-size:1.4rem; }
  .analise-cards-row { grid-template-columns:repeat(2,1fr); }
  .plano-grid { grid-template-columns:1fr; }
  .streak-miles-grid { grid-template-columns:repeat(3,1fr); }
  .b-options { grid-template-columns:1fr; }
}

/* SCROLLBAR */
::-webkit-scrollbar { width:6px; }
::-webkit-scrollbar-track { background:var(--obsidian); }
::-webkit-scrollbar-thumb { background:var(--gold-dark); border-radius:3px; }
::-webkit-scrollbar-thumb:hover { background:var(--gold); }

/* FOOTER */
footer {
  text-align:center; padding:clamp(16px,3vw,20px); font-size:11px;
  color:var(--text-muted); border-top:1px solid var(--border);
  margin-top:clamp(24px,4vw,40px); position:relative; z-index:1;
  padding-bottom:max(20px, env(safe-area-inset-bottom, 20px));
}

/* MODAL */
.modal-overlay {
  display:none; position:fixed; top:0; left:0; right:0; bottom:0;
  background:rgba(0,0,0,.85); z-index:1000; align-items:center; justify-content:center;
}
.modal-overlay.open { display:flex; }
.modal {
  background:var(--surface); border:1px solid var(--border);
  border-radius:16px; padding:32px; max-width:500px; width:90%;
  animation:slide-up .3s;
}
@keyframes slide-up { from{transform:translateY(20px);opacity:0} to{transform:translateY(0);opacity:1} }
.modal h3 { font-family:'Playfair Display',serif; color:var(--gold); margin-bottom:12px; }
.modal p { color:var(--text-muted); font-size:.9rem; line-height:1.6; margin-bottom:20px; }
.modal-actions { display:flex; gap:12px; justify-content:flex-end; }

/* TOOLTIP */
[data-tip] { position:relative; cursor:help; }
[data-tip]:hover::after {
  content:attr(data-tip);
  position:absolute; bottom:calc(100% + 8px); left:50%;
  transform:translateX(-50%);
  background:var(--surface2); border:1px solid var(--border);
  color:var(--text); padding:8px 12px; border-radius:6px;
  font-size:11px; white-space:nowrap; z-index:99;
}

/* RESPONSIVE */

/* =====================================================
   RESPONSIVE ‚Äî MOBILE FIRST
   Breakpoints: 480px (sm), 768px (md), 1024px (lg)
===================================================== */

/* ---- BASE MOBILE (< 480px) ---- */
@media (max-width: 479px) {
  /* Header */
  header { padding: 0 12px; }
  .header-inner { height: 56px; }
  .logo { font-size: .85rem; gap: 6px; }
  .logo-icon { width: 26px; height: 26px; font-size: 12px; }
  .badge { display: none; }
  .header-stats { gap: 10px; }
  .hstat { display: none; }
  .hstat:first-child { display: block; }

  /* Nav ‚Äî horizontal scroll, bot√µes menores */
  nav { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  nav::-webkit-scrollbar { display: none; }
  .nav-inner { padding: 0 4px; gap: 0; }
  .tab { padding: 10px 10px; font-size: 10px; gap: 4px; white-space: nowrap; flex-shrink: 0; }
  .tab-icon { font-size: 13px; }

  /* Main */
  main { padding: 12px; }
  .section-title { font-size: 1.4rem; }
  .section-subtitle { font-size: .8rem; }

  /* Documento */
  .doc-toolbar { flex-direction: column; align-items: stretch; gap: 8px; padding: 12px; }
  .audio-controls { justify-content: center; }
  .speed-control { justify-content: center; }
  #audio-status { text-align: center; font-size: 10px; }
  .page-nav { justify-content: center; }
  .doc-page { padding: 20px 14px; min-height: auto; font-size: 13px; }
  .doc-page h1 { font-size: 1rem; }
  .doc-page h3 { font-size: .9rem; }
  .doc-page table { font-size: 10px; }
  .doc-search-bar { flex-direction: column; }
  .doc-search-input { max-width: 100%; }

  /* Flashcards ‚Äî 1 coluna */
  .cards-grid { grid-template-columns: 1fr; }
  .flashcard { height: 220px; }
  .flash-controls { gap: 8px; }
  .fc-stat { padding: 8px 12px; }
  .fc-stat strong { font-size: 16px; }
  .cat-filter { gap: 6px; }
  .cat-btn { padding: 5px 10px; font-size: 10px; }

  /* Regras ‚Äî 1 coluna */
  .rules-grid { grid-template-columns: 1fr; }

  /* Quiz */
  .quiz-options { grid-template-columns: 1fr; gap: 8px; }
  .quiz-card { padding: 20px 14px; }
  .quiz-question { font-size: 1rem; }
  .quiz-opt { padding: 12px 14px; font-size: .85rem; }
  .quiz-header { gap: 8px; padding: 10px 14px; flex-wrap: wrap; }
  .quiz-start .stats-row { gap: 12px; flex-wrap: wrap; justify-content: center; }
  .quiz-start .stat-box { padding: 12px 16px; }
  .quiz-start .stat-box strong { font-size: 1.4rem; }

  /* Certificado */
  .cert-box { padding: 28px 16px; }
  .cert-name { font-size: 1.5rem; }
  .cert-subtitle { font-size: 1.4rem; }
  .cert-title { font-size: .8rem; letter-spacing: 1px; }
  .cert-score { font-size: 1.1rem; padding: 10px 20px; }
  .cert-actions { flex-direction: column; align-items: center; }
  .cert-actions button { width: 100%; max-width: 280px; }

  /* Desafios ‚Äî 1 coluna */
  .challenges-grid { grid-template-columns: 1fr; }

  /* Honor√°rios */
  .hon-table { font-size: 10px; }
  .hon-table th, .hon-table td { padding: 6px 6px; }

  /* Hist√≥rico */
  .history-item { flex-wrap: wrap; gap: 4px; }
  .history-item .h-name { max-width: 100%; font-size: 11px; }

  /* Input nome quiz */
  #input-nome-quiz { font-size: .9rem; padding: 12px 14px; }

  /* Breakdown cats */
  .cat-row-label { min-width: 70px; font-size: 9px; }

  /* Header stats */
  .header-stats { gap: 8px; }
}

/* ---- SMALL MOBILE (480px ‚Äì 767px) ---- */
@media (min-width: 480px) and (max-width: 767px) {
  .header-stats .hstat:last-child { display: none; }
  .badge { display: none; }

  nav { overflow-x: auto; -webkit-overflow-scrolling: touch; }
  nav::-webkit-scrollbar { display: none; }
  .tab { padding: 12px 14px; font-size: 11px; white-space: nowrap; flex-shrink: 0; }

  main { padding: 16px; }
  .section-title { font-size: 1.6rem; }

  .cards-grid { grid-template-columns: repeat(2, 1fr); }
  .flashcard { height: 200px; }

  .rules-grid { grid-template-columns: 1fr; }

  .quiz-options { grid-template-columns: 1fr; gap: 10px; }
  .quiz-card { padding: 24px 18px; }

  .doc-toolbar { flex-wrap: wrap; gap: 10px; }
  .doc-page { padding: 28px 20px; font-size: 13px; }

  .cert-box { padding: 40px 24px; }
  .cert-name { font-size: 2rem; }

  .challenges-grid { grid-template-columns: 1fr; }
  .hon-table { font-size: 11px; }
}

/* ---- TABLET (768px ‚Äì 1023px) ---- */
@media (min-width: 768px) and (max-width: 1023px) {
  .header-inner { height: 60px; }

  .tab { padding: 13px 16px; font-size: 11px; }

  main { padding: 20px; }
  .section-title { font-size: 1.8rem; }

  .cards-grid { grid-template-columns: repeat(2, 1fr); }
  .flashcard { height: 200px; }

  .rules-grid { grid-template-columns: repeat(2, 1fr); }
  .challenges-grid { grid-template-columns: repeat(2, 1fr); }

  .quiz-options { grid-template-columns: 1fr 1fr; }
  .doc-page { padding: 40px 40px; }

  .cert-box { padding: 50px 40px; }
  .cert-name { font-size: 2.4rem; }

  .hon-table { font-size: 12px; }
}

/* ---- DESKTOP (1024px+) ---- */
@media (min-width: 1024px) {
  .cards-grid { grid-template-columns: repeat(auto-fill, minmax(280px, 1fr)); }
  .rules-grid { grid-template-columns: repeat(auto-fill, minmax(340px, 1fr)); }
  .challenges-grid { grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); }
  .quiz-options { grid-template-columns: 1fr 1fr; }
}

/* ---- TOUCH IMPROVEMENTS (all mobile) ---- */
@media (hover: none) {
  .quiz-opt:hover:not(:disabled) { border-color: var(--border); background: var(--surface2); }
  .cat-btn:hover { color: var(--text-muted); background: var(--surface); border-color: var(--border); }
  .audio-btn { width: 44px; height: 44px; }
  .page-btn { padding: 10px 16px; }
  .btn-gold { min-height: 44px; }
  .btn-outline { min-height: 44px; }
  .fc-fav-btn { font-size: 20px; }
}

</style>
</head>
<body>

<!-- PARTICLES -->
<div id="particles"></div>

<!-- HEADER -->
<header>
  <div class="header-inner">
    <div class="logo">
      <div class="logo-icon">‚öñ</div>
      CONV√äNIO DPE/OAB-SP 001/2026
      <span class="badge" style="background:linear-gradient(135deg,#C9A84C,#fff700);color:#060810;font-weight:900;">üëë LENDA</span>
    </div>
    <div class="header-stats">
      <div class="hstat"><strong id="stat-flash">50</strong>Cards</div>
      <div class="hstat"><strong id="stat-quiz">50</strong>Quiz</div>
      <div class="hstat hstat-hide-sm"><strong id="stat-rules">50</strong>Regras</div>
      <div class="hstat hstat-hide-sm"><strong id="stat-pages">24</strong>Folhas</div>
    </div>
    <div style="display:flex;align-items:center;gap:10px;">
      <button id="themeBtn" onclick="cycleTheme()" title="Mudar tema" style="background:none;border:1px solid var(--border);border-radius:8px;color:var(--gold);width:36px;height:36px;cursor:pointer;font-size:16px;display:flex;align-items:center;justify-content:center;transition:all .2s;">üé®</button>
      <button onclick="openTab('streak')" title="Streak di√°rio" style="background:none;border:1px solid var(--border);border-radius:8px;color:var(--gold);padding:4px 10px;cursor:pointer;font-size:12px;font-weight:700;transition:all .2s;" id="streakHeaderBtn">üî• 0</button>
    </div>
  </div>
</header>

<!-- NAV -->
<nav>
  <div class="nav-inner">
    <button class="tab" onclick="openTab('streak')"><span class="tab-icon">üî•</span>Streak</button>
    <button class="tab active" onclick="openTab('doc')"><span class="tab-icon">üìÑ</span>Documento</button>
    <button class="tab" onclick="openTab('flash')"><span class="tab-icon">üÉè</span>Flashcards</button>
    <button class="tab" onclick="openTab('rules')"><span class="tab-icon">‚ö°</span>50 Regras</button>
    <button class="tab" onclick="openTab('honorarios')"><span class="tab-icon">üí∞</span>Honor√°rios</button>
    <button class="tab" onclick="openTab('quiz')"><span class="tab-icon">üéØ</span>Quiz</button>
    <button class="tab" onclick="openTab('desafios')"><span class="tab-icon">üèÜ</span>Desafios</button>
    <button class="tab" onclick="openTab('mapa')"><span class="tab-icon">üó∫Ô∏è</span>Mapa Mental</button>
    <button class="tab" onclick="openTab('ia')"><span class="tab-icon">ü§ñ</span>Assistente IA</button>
    <button class="tab" onclick="openTab('conquistas')"><span class="tab-icon">üèÖ</span>Conquistas</button>
    <button class="tab" onclick="openTab('batalha')"><span class="tab-icon">‚öîÔ∏è</span>Batalha</button>
    <button class="tab" onclick="openTab('plano')"><span class="tab-icon">üìÖ</span>Plano 30d</button>
    <button class="tab" onclick="openTab('analise')"><span class="tab-icon">üìä</span>An√°lise IA</button>
  </div>
</nav>

<main>

<!-- ============================
     ABA 1: DOCUMENTO
============================= -->
<div id="panel-doc" class="panel active">
  <div class="section-header">
    <div class="section-title">Conv√™nio DPE-OAB/SP N¬∫ 001/2026</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Documento completo ‚Äî 24 folhas com audiobook integrado</div>
  </div>

  <!-- Barra de leitura -->
  <div class="reading-progress-bar">
    <div class="reading-progress-fill" id="readProgressFill" style="width:0%"></div>
  </div>
  <div style="display:flex; align-items:center; gap:10px; margin-bottom:12px; flex-wrap:wrap;">
    <input class="doc-search-input" id="docSearchInput" type="text" placeholder="üîç Buscar no documento..." oninput="searchDoc(this.value)" style="flex:1; min-width:180px;" />
    <span class="search-status" id="searchStatus" style="font-size:10px;"></span>
    <span class="reading-summary" id="readingSummary" style="white-space:nowrap;">0 / 24 lidas</span>
  </div>
  <div class="doc-toolbar">
    <div class="audio-controls">
      <button class="audio-btn" id="btnPlay" onclick="audioPlay()" title="Reproduzir" style="min-width:44px;min-height:44px;">‚ñ∂</button>
      <button class="audio-btn" onclick="audioPause()" title="Pausar" style="min-width:44px;min-height:44px;">‚è∏</button>
      <button class="audio-btn" onclick="audioStop()" title="Parar" style="min-width:44px;min-height:44px;">‚èπ</button>
    </div>
    <div class="speed-control">
      <span>Velocidade:</span>
      <select class="speed-select" id="speedSelect">
        <option value="0.8">0.8√ó</option>
        <option value="1" selected>1√ó</option>
        <option value="1.2">1.2√ó</option>
        <option value="1.5">1.5√ó</option>
        <option value="2">2√ó</option>
      </select>
    </div>
    <div id="audio-status" style="font-size:11px;color:var(--text-muted);">Clique ‚ñ∂ para iniciar o audiobook desta p√°gina</div>
    <div class="page-nav" style="gap:8px;">
      <button class="page-btn" onclick="changePage(-1)" style="min-height:40px; min-width:80px;">‚óÄ Ant.</button>
      <span class="page-progress" id="pageProgress">1 / 24</span>
      <button class="page-btn" onclick="changePage(1)" style="min-height:40px; min-width:80px;">Pr√≥x. ‚ñ∂</button>
    </div>
  </div>

  <div class="doc-pages-container">

    <!-- P√ÅG 1 -->
    <div class="doc-page active" id="dp1">
      <span class="page-num-badge">P√°g. 1 / 24</span>
      <div class="page-header">
        <h1>DEFENSORIA P√öBLICA DO ESTADO DE S√ÉO PAULO</h1>
        <h2>CONV√äNIO N¬∫ 001/2026 ‚Äî PROCESSO SEI N¬∫ 2026/0001363</h2>
      </div>
      <p>Termo de Conv√™nio que entre si celebram a <strong>DEFENSORIA P√öBLICA DO ESTADO DE S√ÉO PAULO</strong> e a <strong>ORDEM DOS ADVOGADOS DO BRASIL ‚Äì SE√á√ÉO DE S√ÉO PAULO</strong>, para a presta√ß√£o de assist√™ncia judici√°ria gratuita suplementar pela advocacia dativa, nos limites deste Conv√™nio, √† popula√ß√£o carente do Estado de S√£o Paulo.</p>
      <p><strong>DEFENSORIA P√öBLICA DO ESTADO DE S√ÉO PAULO</strong>, CNPJ n¬∫ 08.036.157/0001-89, sede: Rua Boa Vista, n¬∫ 200, 8¬∫ andar, Centro, S√£o Paulo-SP, representada pela Defensora P√∫blica-Geral do Estado, Doutora <strong>LUCIANA JORD√ÉO DA MOTTA ARMILIATO DE CARVALHO</strong>, CPF n¬∫ 005.493.519-90.</p>
      <p><strong>ORDEM DOS ADVOGADOS DO BRASIL, Se√ß√£o de S√£o Paulo</strong>, sede: Pra√ßa da S√©, n¬∫ 385, Centro, S√£o Paulo-SP, CNPJ n¬∫ 43.419.613/0001-70, representada pelo Presidente, Doutor <strong>LEONARDO SICA</strong>, CPF n¬∫ 265.532.808-60.</p>
      <p>Celebrado nos termos da <strong>Lei n¬∫ 14.133/21</strong> e suas altera√ß√µes posteriores.</p>
      <h3>T√çTULO I ‚Äì DISPOSI√á√ïES GERAIS ‚Äî Se√ß√£o I ‚Äì Do Objeto e √Çmbito de Aplica√ß√£o</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA PRIMEIRA</strong> ‚Äì Constitui objeto deste conv√™nio a presta√ß√£o de assist√™ncia judici√°ria gratuita suplementar √† popula√ß√£o economicamente hipossuficiente do Estado de S√£o Paulo, nos termos da Delibera√ß√£o CSDP n¬∫ 89/08.</p>
      </div>
      <p><strong>¬ß1¬∫ ‚Äî √Åreas abrangidas:</strong></p>
      <ul>
        <li><strong>I ‚Äì √Årea C√≠vel:</strong> procedimentos ordin√°rios, execu√ß√µes, a√ß√µes declarat√≥rias, possess√≥rias, locat√≠cias, mandados de seguran√ßa, processos cautelares, curadoria especial e Juizados Especiais C√≠vel e da Fazenda P√∫blica.</li>
        <li><strong>II ‚Äì Fam√≠lia e Sucess√µes:</strong> alimentos, invent√°rios, separa√ß√£o, div√≥rcio, uni√£o est√°vel, investiga√ß√£o de paternidade, tutela, curatela e regulamenta√ß√£o de guarda e visitas.</li>
        <li><strong>III ‚Äì √Årea Criminal:</strong> ritos ordin√°rio, sum√°rio e sumar√≠ssimo, Tribunal do J√∫ri, execu√ß√£o penal, viol√™ncia dom√©stica, acordos de n√£o persecu√ß√£o penal e atua√ß√£o como advogado do querelante.</li>
        <li><strong>IV ‚Äì Inf√¢ncia e Juventude:</strong> procedimentos nas √°reas c√≠vel e infracional pertinentes.</li>
        <li><strong>V ‚Äì Atividades Especiais:</strong> cartas precat√≥rias, plant√µes em dias √∫teis e n√£o √∫teis.</li>
      </ul>
    </div>

    <!-- P√ÅG 2 -->
    <div class="doc-page" id="dp2">
      <span class="page-num-badge">P√°g. 2 / 24</span>
      <h3>¬ß3¬∫ ‚Äî Execu√ß√£o Penal (hip√≥teses excepcionais ‚Äî Res. 749/2016 TJ-SP):</h3>
      <ul>
        <li>I ‚Äì Execu√ß√µes em regime aberto</li>
        <li>II ‚Äì Livramento condicional</li>
        <li>III ‚Äì Suspens√£o condicional da pena (sursis)</li>
        <li>IV ‚Äì Penas restritivas de direitos</li>
      </ul>
      <p><strong>¬ß4¬∫</strong> ‚Äî Indica√ß√£o na execu√ß√£o penal somente quando: (I) processo tramitar fora do DEECRIM; (II) houver necessidade de defesa t√©cnica para ato espec√≠fico; (III) existir pr√©via solicita√ß√£o do TJ no M√≥dulo de Indica√ß√µes; (IV) constar expressa autoriza√ß√£o da Assessoria de Conv√™nios.</p>
      <h3>Se√ß√£o II ‚Äì Das Exclus√µes e Exce√ß√µes de Atua√ß√£o</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA SEGUNDA</strong> ‚Äì Excluem-se da abrang√™ncia desse conv√™nio as √°reas: <strong>eleitoral, administrativa, trabalhista e previdenci√°ria</strong>, ainda que nos casos de compet√™ncia delegada √† Justi√ßa Estadual.</p>
      </div>
      <ul>
        <li><strong>¬ß1¬∫</strong> ‚Äî Vedada indica√ß√£o para propositura/prosseguimento em processos de <strong>revis√£o criminal</strong>.</li>
        <li><strong>¬ß2¬∫</strong> ‚Äî Vedada indica√ß√£o para defesa de <strong>pessoa jur√≠dica</strong>, salvo curadoria especial.</li>
        <li><strong>¬ß3¬∫</strong> ‚Äî Vedada nomea√ß√£o para defesa de v√≠tima na √°rea criminal, exceto: (I) a√ß√£o penal privada ou subsidi√°ria; (II) acompanhamento de v√≠timas/testemunhas em depoimento especial (autoriza√ß√£o pr√©via); (III) acompanhamento de v√≠timas de racismo em oitiva (autoriza√ß√£o pr√©via).</li>
      </ul>
      <h3>T√çTULO II ‚Äì DAS PARTES CONVENENTES ‚Äî Se√ß√£o I ‚Äì Das Obriga√ß√µes Da OAB/SP</h3>
      <p><strong>CL√ÅUSULA TERCEIRA</strong> ‚Äì A OAB/SP dever√°, entre outras obriga√ß√µes:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Conferir e atestar regularidade da inscri√ß√£o do advogado conveniado.</li>
        <li><strong>II</strong> ‚Äì Zelar pela regularidade da atua√ß√£o profissional, informando impedimentos e incompatibilidades.</li>
        <li><strong>III</strong> ‚Äì Promover ampla divulga√ß√£o dos termos do conv√™nio e do edital de inscri√ß√µes.</li>
        <li><strong>IV</strong> ‚Äì Afixar cartazes de identifica√ß√£o do conv√™nio em todos os locais de atendimento.</li>
        <li><strong>V</strong> ‚Äì Prestar atendimento inicial nas Subse√ß√µes indicadas pela DEFENSORIA (vigente enquanto sistema informatizado n√£o estiver em pleno funcionamento).</li>
      </ul>
    </div>

    <!-- P√ÅG 3 -->
    <div class="doc-page" id="dp3">
      <span class="page-num-badge">P√°g. 3 / 24</span>
      <h3>OAB/SP ‚Äî Obriga√ß√µes (continua√ß√£o)</h3>
      <ul>
        <li><strong>VI</strong> ‚Äì Participar por meio da CAD de reuni√µes peri√≥dicas com a DEFENSORIA.</li>
        <li><strong>VII</strong> ‚Äì Adequar-se aos sistemas informatizados utilizados pela DEFENSORIA.</li>
        <li><strong>VIII</strong> ‚Äì Disponibilizar aos advogados conveniados extratos de pagamentos em acesso restrito com certificado digital.</li>
        <li><strong>IX</strong> ‚Äì Utilizar dados coletados dos bancos da DEFENSORIA exclusivamente na execu√ß√£o do conv√™nio.</li>
        <li><strong>X</strong> ‚Äì Cumprir leis de prote√ß√£o de dados (LGPD) em todo momento.</li>
        <li><strong>XI</strong> ‚Äì Comunicar incidentes de seguran√ßa de dados o mais breve poss√≠vel.</li>
        <li><strong>XII</strong> ‚Äì Responsabilizar-se por multas impostas por autoridades de prote√ß√£o de dados.</li>
        <li><strong>XIII</strong> ‚Äì Zelar pela economicidade na presta√ß√£o suplementar, evitando demandas j√° custeadas por outras fontes.</li>
      </ul>
      <p><strong>¬ß1¬∫</strong> ‚Äî O atendimento inicial compreende: an√°lise do problema, avalia√ß√£o econ√¥mico-financeira, orienta√ß√£o jur√≠dica e indica√ß√£o de advogado conveniado quando o caso.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Para fins da avalia√ß√£o econ√¥mico-financeira, a declara√ß√£o de inexist√™ncia de qualquer renda para subsist√™ncia deve ser precedida de devida fundamenta√ß√£o.</p>
      <p><strong>¬ß3¬∫</strong> ‚Äî Quando o atendimento for realizado nas instala√ß√µes da OAB/SP, dever√°: (I) disponibilizar local espec√≠fico, adequado e acess√≠vel; (II) manter atendimento semanal em dias √∫teis predefinidos e autorizados pela DEFENSORIA; (III) atender todos os usu√°rios nos dias e hor√°rios definidos; (IV) disponibilizar acesso √† internet e ao sistema de indica√ß√µes; (V) dispor de pessoal para atendimento inicial.</p>
      <p><strong>¬ß4¬∫</strong> ‚Äî Sempre que realizado o atendimento inicial, ser√° exigido o preenchimento de cadastro do cidad√£o, de acordo com os crit√©rios definidos pela DEFENSORIA.</p>
      <p><strong>¬ß5¬∫</strong> ‚Äî A abertura de novos postos de atendimento dever√° ser previamente autorizada pela DEFENSORIA que dever√° decidir em at√© <strong>60 dias</strong>.</p>
    </div>

    <!-- P√ÅG 4 -->
    <div class="doc-page" id="dp4">
      <span class="page-num-badge">P√°g. 4 / 24</span>
      <h3>Se√ß√£o II ‚Äì Das Obriga√ß√µes Da Defensoria P√∫blica</h3>
      <p><strong>CL√ÅUSULA QUARTA</strong> ‚Äì A DEFENSORIA obriga-se a:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Processar e efetuar o pagamento das certid√µes regulares apresentadas pelos advogados conveniados.</li>
        <li><strong>II</strong> ‚Äì Disponibilizar ao advogado conveniado, por meio eletr√¥nico, extrato detalhado da certid√£o de honor√°rios.</li>
        <li><strong>III</strong> ‚Äì Disponibilizar, anualmente, os informes de rendimento para declara√ß√£o do IR.</li>
        <li><strong>IV</strong> ‚Äì Manter em seu portal, na internet, espa√ßo reservado para informa√ß√µes relativas ao presente conv√™nio.</li>
        <li><strong>V</strong> ‚Äì Desenvolver e implementar sistema informatizado pr√≥prio para atendimento inicial aos usu√°rios.</li>
        <li><strong>VI</strong> ‚Äì Disponibilizar estrutura f√≠sica e material para sess√µes da Comiss√£o Mista Processante.</li>
        <li><strong>VII</strong> ‚Äì Recolher a contribui√ß√£o previdenci√°ria legalmente devida em raz√£o das certid√µes pagas.</li>
        <li><strong>VIII</strong> ‚Äì Analisar e julgar pedidos de ren√∫ncia de indica√ß√£o apresentados pelos advogados.</li>
        <li><strong>IX</strong> ‚Äì Realizar reuni√µes peri√≥dicas com a CAD da OAB/SP.</li>
        <li><strong>X</strong> ‚Äì Desenvolver sistema eletr√¥nico que permita ao advogado acompanhamento das indica√ß√µes e envio eletr√¥nico de certid√µes.</li>
      </ul>
      <div class="highlight">
        <p><strong>¬ß1¬∫</strong> ‚Äî As certid√µes regularmente expedidas dever√£o ser protocolizadas no sistema digital de protocolo de certid√µes da CAD/OAB-SP, que dever√° encaminhar as certid√µes digitalmente √† DEFENSORIA <strong>at√© o dia 25 de cada m√™s</strong>, para pagamento no <strong>1¬∫ dia √∫til do segundo m√™s subsequente</strong>.</p>
      </div>
    </div>

    <!-- P√ÅG 5 -->
    <div class="doc-page" id="dp5">
      <span class="page-num-badge">P√°g. 5 / 24</span>
      <h3>Se√ß√£o III ‚Äì Das Obriga√ß√µes Dos Advogados Conveniados</h3>
      <p><strong>CL√ÅUSULA QUINTA</strong> ‚Äî A inscri√ß√£o representa anu√™ncia irrestrita ao regime especial de presta√ß√£o de servi√ßos e sujei√ß√£o ao procedimento fiscalizat√≥rio.</p>
      <p><strong>CL√ÅUSULA S√âTIMA</strong> ‚Äî O advogado conveniado deve observar:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Manter endere√ßo de e-mail atualizado com extens√£o <strong>@adv.oabsp.org.br</strong>.</li>
        <li><strong>II</strong> ‚Äì Dispor de acesso √† internet e certifica√ß√£o digital.</li>
        <li><strong>III</strong> ‚Äì Participar de todo atendimento inicial, cumprindo escala de plant√£o da Subse√ß√£o.</li>
        <li><strong>IV</strong> ‚Äì Manter dados cadastrais atualizados junto √† DEFENSORIA e √† OAB/SP.</li>
        <li><strong>V</strong> ‚Äì Manter instala√ß√µes adequadas, com espera sentada e acessibilidade.</li>
        <li><strong>VI</strong> ‚Äì Atender pessoal e/ou telepresencialmente todos os usu√°rios e familiares com presteza e urbanidade.</li>
        <li><strong>VII</strong> ‚Äì Abster-se, em suas peti√ß√µes, do uso de s√≠mbolos ou timbres da DEFENSORIA ou da OAB.</li>
        <li><strong>VIII</strong> ‚Äì Conversar pessoal e reservadamente com r√©u preso ou adolescente internado, no m√≠nimo antes do interrogat√≥rio.</li>
        <li><strong>IX</strong> ‚Äì Documentar todos os atendimentos e orienta√ß√µes efetuados.</li>
        <li><strong>X</strong> ‚Äì Enviar √† DEFENSORIA, quando solicitado, c√≥pias dos documentos.</li>
        <li><strong>XI</strong> ‚Äì Fornecer aos usu√°rios, por escrito, rol de documentos necess√°rios para medidas judiciais.</li>
      </ul>
    </div>

    <!-- P√ÅG 6 -->
    <div class="doc-page" id="dp6">
      <span class="page-num-badge">P√°g. 6 / 24</span>
      <h3>Deveres dos Advogados (continua√ß√£o)</h3>
      <ul>
        <li><strong>XII</strong> ‚Äì Fornecer recibo detalhado de todos os documentos entregues no atendimento.</li>
        <li><strong>XIII</strong> ‚Äì Fornecer ao usu√°rio informa√ß√£o atualizada, clara e compreens√≠vel sobre os processos.</li>
        <li><strong>XIV</strong> ‚Äì Peticionar pelo desarquivamento de processos, extra√ß√£o de c√≥pias e emiss√£o de certid√µes quando necess√°rio, sem qualquer √¥nus para o usu√°rio.</li>
        <li><strong>XV</strong> ‚Äì Zelar pela economicidade, buscando tutela antecipada e reuni√£o de pedidos na mesma a√ß√£o.</li>
        <li><strong>XVI</strong> ‚Äì Zelar pela busca de solu√ß√£o consensual do conflito, sempre que poss√≠vel.</li>
        <li><strong>XVII</strong> ‚Äì Adotar todas as medidas judiciais cab√≠veis em todos os graus de jurisdi√ß√£o.</li>
        <li><strong>XVIII</strong> ‚Äì Atuar de forma diligente nos feitos, acompanhando-os at√© o <strong>tr√¢nsito em julgado</strong>.</li>
        <li><strong>XIX</strong> ‚Äì Observar os prazos para ado√ß√£o das medidas jur√≠dicas.</li>
        <li><strong>XX</strong> ‚Äì Orientar o usu√°rio e adotar medidas para efetiva√ß√£o de averba√ß√µes e registros, mesmo ap√≥s recebimento da certid√£o de honor√°rios.</li>
        <li><strong>XXI</strong> ‚Äì Acompanhar intima√ß√µes publicadas na Imprensa Oficial.</li>
        <li><strong>XXII</strong> ‚Äì Conferir o regular preenchimento da certid√£o de honor√°rios expedida pelo ju√≠zo.</li>
        <li><strong>XXIII</strong> ‚Äì Solicitar substitui√ß√£o da certid√£o de honor√°rios em caso de preenchimento em desconformidade com o conv√™nio.</li>
        <li><strong>XXIV</strong> ‚Äì Atuar no cumprimento de senten√ßa, quando iniciado em at√© <strong>12 meses do tr√¢nsito em julgado</strong>, sem direito a nova certid√£o.</li>
        <li><strong>XXVII</strong> ‚Äì Comunicar prontamente ao usu√°rio em todos os casos de recusas de indica√ß√£o.</li>
        <li><strong>XXX</strong> ‚Äì Acompanhar todos os feitos sob seu patroc√≠nio, independentemente de ulterior cancelamento de inscri√ß√£o.</li>
      </ul>
    </div>

    <!-- P√ÅG 7 -->
    <div class="doc-page" id="dp7">
      <span class="page-num-badge">P√°g. 7 / 24</span>
      <h3>T√çTULO III ‚Äì DAS INSCRI√á√ïES ‚Äî Se√ß√£o I ‚Äì Da Abertura Das Inscri√ß√µes</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA OITAVA</strong> ‚Äì A DEFENSORIA abrir√° inscri√ß√µes <strong>ao menos uma vez ao ano</strong>, na forma e nos prazos estabelecidos em edital.</p>
      </div>
      <p><strong>¬ß1¬∫</strong> ‚Äî O advogado poder√° se inscrever como pessoa f√≠sica ou como sociedade individual, sendo <strong>vedada a participa√ß√£o simult√¢nea</strong> em ambas as qualifica√ß√µes.</p>
      <p><strong>¬ß3¬∫</strong> ‚Äî At√© que o novo edital produza seus regulares efeitos, permanecer√£o v√°lidas as inscri√ß√µes ativas remanescentes do √∫ltimo edital.</p>
      <div class="highlight">
        <p><strong>CL√ÅUSULA NONA</strong> ‚Äì O Edital de inscri√ß√µes dever√° prever abertura e encerramento em dias √∫teis, por per√≠odo <strong>n√£o inferior a 15 dias</strong>, publicado na Imprensa Oficial com anteced√™ncia m√≠nima de <strong>10 dias</strong> da data de in√≠cio.</p>
      </div>
      <p><strong>¬ß2¬∫</strong> ‚Äî A inscri√ß√£o ter√° <strong>vig√™ncia anual</strong>, devendo sempre ser renovada quando da publica√ß√£o de novo edital.</p>
      <h3>Se√ß√£o II ‚Äì Dos Requisitos E Documenta√ß√£o</h3>
      <p><strong>CL√ÅUSULA D√âCIMA</strong> ‚Äì Exig√™ncias do Edital:</p>
      <ul>
        <li><strong>V</strong> ‚Äì Endere√ßo eletr√¥nico fornecido pela OAB-SP: <strong>@adv.oabsp.org.br</strong></li>
        <li><strong>VII</strong> ‚Äì Para atua√ß√£o no Tribunal do J√∫ri, Inf√¢ncia e Juventude e medidas protetivas de viol√™ncia dom√©stica: comprova√ß√£o de experi√™ncia profissional.</li>
        <li><strong>XI</strong> ‚Äì Comprova√ß√£o de adimplemento com os cofres da OAB/SP.</li>
      </ul>
    </div>

    <!-- P√ÅG 8 -->
    <div class="doc-page" id="dp8">
      <span class="page-num-badge">P√°g. 8 / 24</span>
      <h3>CL√ÅUSULA D√âCIMA PRIMEIRA ‚Äî Requisitos para Inscri√ß√£o</h3>
      <ul>
        <li><strong>I</strong> ‚Äì Em dia com os cofres da OAB/SP</li>
        <li><strong>II</strong> ‚Äì No pleno exerc√≠cio da profiss√£o</li>
        <li><strong>III</strong> ‚Äì N√£o cumprindo san√ß√£o administrativa de descredenciamento ou san√ß√£o disciplinar</li>
        <li><strong>IV</strong> ‚Äì N√£o incidindo nas proibi√ß√µes do art. 12, I a III, da Lei n¬∫ 8.249/92</li>
        <li><strong>V</strong> ‚Äì N√£o exercendo emprego/fun√ß√£o/cargo p√∫blico com carga hor√°ria ‚â• 6 horas/dia incompat√≠vel com a advocacia</li>
      </ul>
      <div class="highlight">
        <p><strong>¬ß5¬∫</strong> ‚Äî Inscri√ß√£o para Tribunal do J√∫ri: comprovar haver atuado em <strong>4 sess√µes plen√°rias</strong>, ou em <strong>1 sess√£o plen√°ria + conclus√£o de curso espec√≠fico</strong>.</p>
        <p><strong>¬ß6¬∫</strong> ‚Äî Inscri√ß√£o para medidas protetivas aut√¥nomas de viol√™ncia dom√©stica e Inf√¢ncia e Juventude: comprovar conclus√£o de <strong>curso espec√≠fico</strong>.</p>
        <p><strong>¬ß7¬∫</strong> ‚Äî Os cursos devem ser ministrados em conjunto pela <strong>EDEPE</strong> e pela <strong>Escola Superior da Advocacia da OAB/SP</strong>.</p>
      </div>
      <p><strong>¬ß11</strong> ‚Äî Inscri√ß√µes para √°rea c√≠vel divididas em C√≠vel e Fam√≠lia/Sucess√µes, permitindo ao advogado escolher as √°reas de interesse.</p>
      <h3>SE√á√ÉO III ‚Äì Do Cancelamento Da Inscri√ß√£o</h3>
      <p><strong>CL√ÅUSULA D√âCIMA SEGUNDA</strong> ‚Äì O pedido de cancelamento deve ser realizado em campo espec√≠fico no portal do advogado.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Salvo impedimento legal ou ren√∫ncia deferida pela DEFENSORIA, o advogado dever√° continuar, <strong>at√© o tr√¢nsito em julgado</strong>, no patroc√≠nio das a√ß√µes para as quais tenha sido indicado.</p>
    </div>

    <!-- P√ÅG 9 -->
    <div class="doc-page" id="dp9">
      <span class="page-num-badge">P√°g. 9 / 24</span>
      <h3>T√çTULO IV ‚Äì DAS INDICA√á√ïES E ATUA√á√ÉO ‚Äî Se√ß√£o I ‚Äì Disposi√ß√µes Gerais</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA D√âCIMA TERCEIRA</strong> ‚Äî A presta√ß√£o de assist√™ncia judici√°ria ao usu√°rio √© <strong>totalmente gratuita</strong>. Vedada qualquer cobran√ßa a t√≠tulo de honor√°rios advocat√≠cios, taxas, emolumentos ou despesas de qualquer natureza, sob pena de <strong>descredenciamento</strong>.</p>
      </div>
      <p><strong>CL√ÅUSULA D√âCIMA QUARTA</strong> ‚Äî A indica√ß√£o pressup√µe a verifica√ß√£o do estado real de pobreza do usu√°rio, observada a Delibera√ß√£o CSDP n¬∫ 89/08.</p>
      <p><strong>¬ß4¬∫</strong> ‚Äî As indica√ß√µes dever√£o obedecer √† <strong>ordem alfab√©tica crescente</strong>. Ap√≥s homologa√ß√£o das novas listas, haver√° continuidade a partir do √∫ltimo profissional nomeado na lista anterior.</p>
      <p><strong>¬ß11</strong> ‚Äî Aus√™ncia tempor√°ria: o advogado poder√° lan√ßar no M√≥dulo de Indica√ß√µes aus√™ncia tempor√°ria por <strong>60 dias por ano</strong>, permitido o gozo em dois per√≠odos de 30 dias.</p>
      <p><strong>¬ß14</strong> ‚Äî Substabelecimento: permitido <strong>uma √∫nica vez em cada feito</strong>, para um √∫nico ato de audi√™ncia, a outro advogado conveniado, que n√£o far√° jus a quaisquer valores. Tem car√°ter personal√≠ssimo o m√∫nus assumido.</p>
      <h3>Se√ß√£o II ‚Äì Das Indica√ß√µes Na √Årea C√≠vel</h3>
      <p><strong>CL√ÅUSULA D√âCIMA QUINTA ‚Äî Prazos para √°rea c√≠vel:</strong></p>
      <ul>
        <li><strong>¬ß2¬∫ ‚Äî I:</strong> <strong>6 meses</strong> para recebimento da documenta√ß√£o, contados da nomea√ß√£o.</li>
        <li><strong>¬ß2¬∫ ‚Äî II:</strong> <strong>30 dias</strong> para o ajuizamento, contados a partir do recebimento da documenta√ß√£o necess√°ria.</li>
        <li><strong>¬ß3¬∫:</strong> Medidas urgentes devem ser propostas em tempo h√°bil. Defesa deve ser protocolada dentro do prazo processual.</li>
      </ul>
    </div>

    <!-- P√ÅG 10 -->
    <div class="doc-page" id="dp10">
      <span class="page-num-badge">P√°g. 10 / 24</span>
      <h3>√Årea C√≠vel (continua√ß√£o)</h3>
      <p><strong>¬ß4¬∫</strong> ‚Äî A√ß√µes onde haja cumula√ß√£o de pedidos: advogado receber√° <strong>uma √∫nica nomea√ß√£o</strong>, obrigando-se a propor medida judicial concentrando os pleitos em um √∫nico processo.</p>
      <p><strong>¬ß6¬∫</strong> ‚Äî Separa√ß√£o e div√≥rcio consensuais: ser√° indicado <strong>apenas um advogado para representar ambas as partes</strong>.</p>
      <p><strong>¬ß7¬∫</strong> ‚Äî O advogado indicado dever√° formular todos os pedidos cab√≠veis: guarda de filhos, alimentos, regulamenta√ß√£o de visitas, partilha de bens e outros provimentos correlatos.</p>
      <p><strong>¬ß8¬∫</strong> ‚Äî N√£o ser√° permitida indica√ß√£o de novo advogado para cumprimento de senten√ßa de execu√ß√£o de alimentos em tempo inferior a <strong>60 dias</strong>, contados do pagamento integral ou da suspens√£o do processo.</p>
      <h3>Se√ß√£o III ‚Äì Das Indica√ß√µes Na √Årea Criminal</h3>
      <p><strong>CL√ÅUSULA D√âCIMA SEXTA</strong> ‚Äî A indica√ß√£o para atua√ß√£o em favor do r√©u ser√° feita:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Para a audi√™ncia de cust√≥dia, se houver.</li>
        <li><strong>II</strong> ‚Äì Ap√≥s apresenta√ß√£o da proposta ou inten√ß√£o de formula√ß√£o do ANPP.</li>
        <li><strong>III</strong> ‚Äì Ap√≥s a cita√ß√£o v√°lida do acusado.</li>
      </ul>
      <p><strong>¬ß1¬∫</strong> ‚Äî O advogado nomeado desde a audi√™ncia de cust√≥dia ser√° respons√°vel por <strong>todos os atos do processo</strong>, inclusive eventual ANPP.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Recebida indica√ß√£o para atua√ß√£o em favor de r√©u preso, obriga-se o advogado a adotar <strong>todas as medidas para obten√ß√£o da liberdade</strong> a partir da ci√™ncia da indica√ß√£o. N√£o poder√£o ser expedidas novas indica√ß√µes para impetra√ß√£o de HC quando esse for necess√°rio.</p>
      <p><strong>¬ß4¬∫</strong> ‚Äî Nas a√ß√µes criminais, o advogado √© respons√°vel pela manifesta√ß√£o sobre a <strong>multa</strong> perante o Ju√≠zo do Conhecimento, antes do envio ao Ju√≠zo de Execu√ß√µes Criminais.</p>
    </div>

    <!-- P√ÅG 11 -->
    <div class="doc-page" id="dp11">
      <span class="page-num-badge">P√°g. 11 / 24</span>
      <h3>Subse√ß√£o II ‚Äì Tribunal do J√∫ri</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA D√âCIMA S√âTIMA</strong> ‚Äî A atua√ß√£o sem o preenchimento dos requisitos exigidos <strong>impede o pagamento das certid√µes</strong>.</p>
      </div>
      <p><strong>¬ß1¬∫</strong> ‚Äî A nomea√ß√£o para a 1¬™ fase (at√© a pron√∫ncia) permanecer√° v√°lida para a 2¬™ fase (plen√°rio) e eventual segundo plen√°rio.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Em caso de realiza√ß√£o de novo J√∫ri, o advogado que patrocinou a defesa far√° jus a <strong>nova certid√£o de honor√°rios</strong>.</p>
      <h3>Subse√ß√£o III ‚Äì Medidas Protetivas</h3>
      <p><strong>CL√ÅUSULA D√âCIMA OITAVA</strong> ‚Äî Atua√ß√£o em medidas protetivas pode ocorrer em favor da v√≠tima ou do requerido, exclusivamente em pedidos aut√¥nomos.</p>
      <p><strong>¬ß1¬∫ ‚Äî Nomea√ß√£o em favor de mulheres v√≠timas</strong> nas seguintes hip√≥teses:</p>
      <ul>
        <li>I ‚Äì Recusa da concess√£o pela autoridade policial em raz√£o da complexidade jur√≠dica da medida</li>
        <li>II ‚Äì Necessidade de interposi√ß√£o de recurso contra decis√£o que indeferiu</li>
        <li>III ‚Äì Necessidade de pedido de reconsidera√ß√£o contra decis√£o desfavor√°vel</li>
        <li>IV ‚Äì Necessidade de maior instru√ß√£o probat√≥ria</li>
      </ul>
      <p><strong>¬ß2¬∫</strong> ‚Äî O advogado nomeado ficar√° vinculado √†s demandas correlatas da mesma benefici√°ria pelo per√≠odo de <strong>12 meses</strong>, contado da primeira decis√£o.</p>
      <p><strong>¬ß4¬∫ ‚Äî Nomea√ß√£o em favor do requerido</strong>: depende de an√°lise socioecon√¥mica e pr√©via cita√ß√£o/intima√ß√£o.</p>
      <p><strong>¬ß5¬∫</strong> ‚Äî O advogado nomeado para o requerido ficar√° vinculado pelo per√≠odo de <strong>12 meses</strong>.</p>
    </div>

    <!-- P√ÅG 12 -->
    <div class="doc-page" id="dp12">
      <span class="page-num-badge">P√°g. 12 / 24</span>
      <h3>Se√ß√£o IV ‚Äì Das Indica√ß√µes Na √Årea Da Inf√¢ncia E Juventude</h3>
      <p><strong>CL√ÅUSULA D√âCIMA NONA</strong> ‚Äî Crit√©rios para indica√ß√£o:</p>
      <ul>
        <li><strong>I</strong> ‚Äì A√ß√µes c√≠veis: somente ap√≥s <strong>cita√ß√£o da parte</strong> + avalia√ß√£o socioecon√¥mica</li>
        <li><strong>II</strong> ‚Äì A√ß√µes infracionais: exclusivamente ap√≥s <strong>cita√ß√£o para audi√™ncia de apresenta√ß√£o</strong></li>
      </ul>
      <p><strong>¬ß2¬∫ ‚Äî N√ÉO haver√° indica√ß√£o</strong> nas seguintes hip√≥teses:</p>
      <ul>
        <li>I ‚Äì Oitiva informal perante o Minist√©rio P√∫blico</li>
        <li>II ‚Äì Remiss√£o simples desacompanhada de medida socioeducativa ou protetiva</li>
      </ul>
      <p><strong>¬ß4¬∫</strong> ‚Äî O advogado que atuou na fase de apura√ß√£o de ato infracional <strong>permanecer√° respons√°vel pela execu√ß√£o da medida socioeducativa</strong>, sem direito a nova certid√£o.</p>
      <h3>Se√ß√£o V ‚Äì Do Aceite, Recusa E Ren√∫ncia</h3>
      <p><strong>CL√ÅUSULA VIG√âSIMA PRIMEIRA</strong> ‚Äî O pedido de recusa da indica√ß√£o ou ren√∫ncia somente ser√° deferido caso o advogado comprove:</p>
      <ul>
        <li>I ‚Äì Estar impedido de exercer a advocacia</li>
        <li>II ‚Äì Ser procurador constitu√≠do pela parte contr√°ria ou ter rela√ß√µes profissionais de interesse atual</li>
        <li>III ‚Äì J√° haver manifestado por escrito opini√£o contr√°ria ao direito que o necessitado pretende pleitear</li>
        <li>V ‚Äì Quebra na rela√ß√£o de confian√ßa</li>
        <li>VI ‚Äì Aus√™ncia do estado de car√™ncia</li>
        <li>VII ‚Äì Manifesto descabimento da medida pretendida</li>
        <li>VIII ‚Äì Inconveni√™ncia aos interesses da parte</li>
        <li>XI ‚Äì Decurso de 30 dias sem que o usu√°rio tenha contatado o advogado</li>
        <li>XII ‚Äì Nomea√ß√£o em concurso p√∫blico</li>
      </ul>
    </div>

    <!-- P√ÅG 13 -->
    <div class="doc-page" id="dp13">
      <span class="page-num-badge">P√°g. 13 / 24</span>
      <h3>Recusa e Ren√∫ncia (continua√ß√£o)</h3>
      <p><strong>¬ß1¬∫</strong> ‚Äî RECUSA: ato do advogado que rejeita a indica√ß√£o <strong>antes da ado√ß√£o da medida judicial cab√≠vel</strong> e previamente √† manifesta√ß√£o de aceite no MI.</p>
      <p><strong>¬ß3¬∫</strong> ‚Äî O advogado desincumbe-se da obriga√ß√£o de propor a medida cab√≠vel independentemente do deferimento/indeferimento do pedido de recusa.</p>
      <p><strong>¬ß7¬∫</strong> ‚Äî REN√öNCIA: ato administrativo praticado pelo advogado que deseja deixar de atuar em processo em andamento.</p>
      <p><strong>¬ß8¬∫</strong> ‚Äî Os pedidos de REN√öNCIA ser√£o avaliados e julgados pela DEFENSORIA, sempre que poss√≠vel, no prazo de <strong>5 dias √∫teis</strong>.</p>
      <p><strong>¬ß10</strong> ‚Äî Autorizada a ren√∫ncia, dever√° o advogado comunicar ao usu√°rio e juntar o documento comprobat√≥rio √† peti√ß√£o que formalizar√° o pedido judicial de ren√∫ncia nos autos.</p>
      <p><strong>¬ß12</strong> ‚Äî Na eventualidade de pedido fundado no inciso X (cancelamento h√° mais de 3 anos), fica vedada a inscri√ß√£o pelo per√≠odo de <strong>3 anos</strong> a contar da data do deferimento da ren√∫ncia.</p>
      <h3>Se√ß√£o VI ‚Äì Da Assun√ß√£o De Processos</h3>
      <p><strong>CL√ÅUSULA VIG√âSIMA SEGUNDA</strong> ‚Äî Sobrevindo a instala√ß√£o de unidade da DEFENSORIA no Munic√≠pio, os processos iniciados por indica√ß√£o do conv√™nio <strong>continuar√£o sob o patroc√≠nio do advogado conveniado</strong> previamente indicado.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî A DEFENSORIA poder√°, a qualquer tempo, em qualquer fase processual, intervir em medida judicial em andamento.</p>
    </div>

    <!-- P√ÅG 14 -->
    <div class="doc-page" id="dp14">
      <span class="page-num-badge">P√°g. 14 / 24</span>
      <h3>T√çTULO V ‚Äì DOS PLANT√ïES E ATIVIDADES ESPECIAIS</h3>
      <p><strong>CL√ÅUSULA VIG√âSIMA TERCEIRA</strong> ‚Äî A presta√ß√£o de assist√™ncia suplementar poder√° abranger: atua√ß√£o como plantonista em juizados especiais, atua√ß√£o em cartas precat√≥rias, audi√™ncias de cust√≥dia, acordos de n√£o persecu√ß√£o penal e outras atividades autorizadas.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Nas <strong>cartas precat√≥rias criminais</strong>: indicado apenas um advogado, em regime de plant√£o, com n√∫mero m√≠nimo de processos pautados (c√≥digo 701 da tabela).</p>
      <p><strong>¬ß4¬∫</strong> ‚Äî Atua√ß√£o nos <strong>Juizados Especiais</strong>:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Vedada indica√ß√£o para processos cujo valor <strong>n√£o exceda 20 sal√°rios m√≠nimos</strong>, salvo necess√°ria interposi√ß√£o de recurso.</li>
        <li><strong>IV</strong> ‚Äì O advogado plantonista dever√° permanecer √† disposi√ß√£o do ju√≠zo para <strong>todas as audi√™ncias previstas na pauta</strong>.</li>
      </ul>
      <p><strong>¬ß7¬∫</strong> ‚Äî Plant√µes em dias n√£o √∫teis:</p>
      <ul>
        <li><strong>I</strong> ‚Äì Em plant√£o duplo, obrigatoriamente, quando da ocorr√™ncia de <strong>dois dias n√£o √∫teis consecutivos</strong></li>
        <li><strong>II</strong> ‚Äì Em plant√£o √∫nico, quando n√£o for poss√≠vel a indica√ß√£o na forma anterior</li>
      </ul>
      <p><strong>¬ß8¬∫ ‚Äî IV</strong> ‚Äî No caso de nomea√ß√£o para <strong>plant√£o duplo</strong>: s√≥ ser√£o devidos os honor√°rios caso o advogado participe dos <strong>dois dias</strong> n√£o √∫teis consecutivos. Vedado pagamento parcial.</p>
      <p><strong>¬ß11</strong> ‚Äî O advogado ser√° indicado para atuar no ANPP, que abranger√° desde a proposta de acordo at√© o ato de homologa√ß√£o e extin√ß√£o da punibilidade.</p>
    </div>

    <!-- P√ÅG 15 -->
    <div class="doc-page" id="dp15">
      <span class="page-num-badge">P√°g. 15 / 24</span>
      <h3>T√çTULO VI ‚Äì DOS PAGAMENTOS, HONOR√ÅRIOS E CERTID√ïES</h3>
      <p><strong>CL√ÅUSULA VIG√âSIMA QUARTA</strong> ‚Äî Os honor√°rios ser√£o pagos segundo os valores dos Anexos I e II.</p>
      <p><strong>¬ß1¬∫</strong> ‚Äî Somente ser√£o adimplidas as certid√µes emitidas no <strong>M√≥dulo de Indica√ß√µes da Defensoria</strong>.</p>
      <p><strong>¬ß8¬∫</strong> ‚Äî N√£o ser√£o pagos honor√°rios em desacordo com a tabela, <strong>ainda que arbitrado valor distinto pelo Ju√≠zo</strong>.</p>
      <p><strong>¬ß9¬∫</strong> ‚Äî O pagamento de honor√°rios n√£o implicar√° exist√™ncia de <strong>v√≠nculo empregat√≠cio</strong> com o Estado.</p>
      <p><strong>¬ß10</strong> ‚Äî Os honor√°rios ter√£o seus valores ajustados <strong>anualmente</strong> conforme o √≠ndice <strong>IPC/FIPE</strong>, tendo como data-base o in√≠cio da vig√™ncia.</p>
      <h3>T√çTULO VIII ‚Äì DAS DISPOSI√á√ïES FINAIS ‚Äî Vig√™ncia</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA VIG√âSIMA SEXTA</strong> ‚Äî O prazo de vig√™ncia do ajuste ser√° de <strong>15 meses a partir de 1¬∫ de maio de 2026</strong>, podendo ser prorrogado por iguais per√≠odos.</p>
      </div>
      <h3>Den√∫ncia e Rescis√£o</h3>
      <p><strong>CL√ÅUSULA VIG√âSIMA S√âTIMA</strong> ‚Äî O conv√™nio poder√° ser denunciado por qualquer das part√≠cipes, mediante notifica√ß√£o, com anteced√™ncia m√≠nima de <strong>90 dias</strong>, sem qualquer √¥nus √†s convenentes.</p>
      <h3>Valor e Recursos</h3>
      <div class="highlight">
        <p><strong>CL√ÅUSULA VIG√âSIMA OITAVA</strong> ‚Äî O valor total estimado do presente conv√™nio √© de <strong>R$ 250.000.000,00 (duzentos e cinquenta milh√µes de reais)</strong>, recursos do Fundo de Assist√™ncia Judici√°ria ‚Äî UG 420030.</p>
      </div>
      <p><strong>CL√ÅUSULA VIG√âSIMA NONA</strong> ‚Äî Foro: <strong>Comarca da Capital do Estado de S√£o Paulo</strong>.</p>
    </div>

    <!-- P√ÅG 16 -->
    <div class="doc-page" id="dp16">
      <span class="page-num-badge">P√°g. 16 / 24</span>
      <h3>ANEXO I ‚Äì DOS HONOR√ÅRIOS E CERTID√ïES</h3>
      <p><strong>Art. 1¬∫</strong> ‚Äî Os honor√°rios ser√£o pagos segundo os valores da tabela do Anexo II, na forma prevista no art. 8¬∫ da Lei Complementar Estadual n¬∫ 988/06.</p>
      <h3>Processos Criminais ‚Äî Art. 3¬∫ (Ju√≠zo Singular)</h3>
      <ul>
        <li><strong>I ‚Äì Senten√ßa absolut√≥ria:</strong> 100% com tr√¢nsito em julgado; ou 70% ap√≥s senten√ßa + 30% ap√≥s tr√¢nsito em julgado do ac√≥rd√£o.</li>
        <li><strong>II ‚Äì Senten√ßa condenat√≥ria:</strong> 70% ap√≥s senten√ßa + 30% ap√≥s tr√¢nsito em julgado do ac√≥rd√£o.</li>
        <li><strong>III ‚Äì Extin√ß√£o da punibilidade:</strong> 100% do valor previsto na tabela.</li>
      </ul>
      <h3>Tribunal do J√∫ri ‚Äî Art. 4¬∫</h3>
      <p><strong>1¬™ Fase:</strong></p>
      <ul>
        <li>Impron√∫ncia, desclassifica√ß√£o ou absolvi√ß√£o sum√°ria: 100% (tr√¢nsito em julgado); recurso: 70% + 30% depois.</li>
        <li>Pron√∫ncia: 70% + 30% ap√≥s ac√≥rd√£o.</li>
      </ul>
      <p><strong>2¬™ Fase:</strong></p>
      <ul>
        <li>Absolut√≥ria: 100% (tr√¢nsito); recurso: 70% + 30%.</li>
        <li>Condenat√≥ria: 70% + 30% ap√≥s ac√≥rd√£o.</li>
        <li>Segundo J√∫ri: 60% ap√≥s tr√¢nsito em julgado.</li>
      </ul>
      <h3>Art. 5¬∫ ‚Äî Suspens√£o do Processo (art. 366 CPP)</h3>
      <p>Pagamento de <strong>30%</strong> do valor previsto na tabela para o respectivo rito processual.</p>
      <h3>Art. 6¬∫ ‚Äî Suspens√£o Condicional do Processo (Sursis Processual)</h3>
      <ul>
        <li><strong>I</strong> ‚Äì 30% ap√≥s a decis√£o que suspender o processo</li>
        <li><strong>II</strong> ‚Äì 70% restantes ap√≥s cumprimento do per√≠odo de prova com tr√¢nsito em julgado da extin√ß√£o</li>
        <li><strong>III</strong> ‚Äì Em caso de revoga√ß√£o: senten√ßa absolut√≥ria s/recurso: 70% com tr√¢nsito; c/recurso: 40% + 30%.</li>
      </ul>
    </div>

    <!-- P√ÅG 17 -->
    <div class="doc-page" id="dp17">
      <span class="page-num-badge">P√°g. 17 / 24</span>
      <h3>Art. 7¬∫ ‚Äî Execu√ß√£o Penal (hip√≥teses do ¬ß3¬∫ da Cl√°usula Primeira)</h3>
      <p><strong>30%</strong> do valor previsto na tabela. Em caso de atua√ß√£o na fase recursal: <strong>nova certid√£o no mesmo percentual</strong>.</p>
      <h3>Art. 9¬∫ ‚Äî Processos C√≠veis</h3>
      <p><strong>I ‚Äì Atua√ß√£o pela Parte Autora:</strong></p>
      <ul>
        <li>Proced√™ncia total s/recurso: <strong>100%</strong> com tr√¢nsito; c/recurso: <strong>70%</strong> ap√≥s senten√ßa + <strong>30%</strong> ap√≥s ac√≥rd√£o.</li>
        <li>Improced√™ncia/proced√™ncia parcial s/recurso: <strong>60%</strong>; c/recurso: <strong>60%</strong> + <strong>40%</strong>.</li>
      </ul>
      <p><strong>II ‚Äì Atua√ß√£o pela Parte R√©:</strong></p>
      <ul>
        <li>Improced√™ncia total s/recurso: <strong>100%</strong>; c/recurso: <strong>70%</strong> + <strong>30%</strong>.</li>
        <li>Proced√™ncia total/parcial s/recurso: <strong>60%</strong>; c/recurso: <strong>60%</strong> + <strong>40%</strong>.</li>
      </ul>
      <p><strong>III ‚Äì Acordo:</strong></p>
      <ul>
        <li>Um advogado por parte: <strong>70%</strong> na homologa√ß√£o</li>
        <li>Um advogado para duas partes: <strong>100%</strong> na homologa√ß√£o</li>
      </ul>
      <h3>Art. 10 ‚Äî Extin√ß√£o Sem Resolu√ß√£o de M√©rito (art. 485 CPC)</h3>
      <ul>
        <li>Incisos I e VII: <strong>SEM honor√°rios</strong></li>
        <li>Incisos II e III: <strong>70%</strong> para ambos os advogados (autor comprova intima√ß√£o pr√©via)</li>
        <li>Incisos IV, V, VI e X: <strong>70%</strong> exclusivamente ao advogado do r√©u</li>
        <li>Incisos VIII e IX: <strong>70%</strong> para ambos</li>
      </ul>
      <h3>Art. 11 ‚Äî Certid√£o de Honor√°rios Parciais (antecipa√ß√£o)</h3>
      <p>Poss√≠vel nas seguintes hip√≥teses (30% da tabela):</p>
      <ul>
        <li>I ‚Äì Suspens√£o do cumprimento de senten√ßa de alimentos por acordo ou inexist√™ncia de bens</li>
        <li>II ‚Äì Execu√ß√µes fiscais: acordo de parcelamento ou arquivamento (art. 40 LEF)</li>
        <li>III ‚Äì Execu√ß√µes de t√≠tulos extrajudiciais: embargos procedentes ou acordo</li>
        <li>IV ‚Äì Cita√ß√£o por edital (comprovado esgotamento das tentativas de localiza√ß√£o)</li>
      </ul>
    </div>

    <!-- P√ÅG 18 -->
    <div class="doc-page" id="dp18">
      <span class="page-num-badge">P√°g. 18 / 24</span>
      <h3>Art. 12 ‚Äî Honor√°rios por Ren√∫ncia Autorizada</h3>
      <p><strong>30%</strong> do valor previsto na tabela.</p>
      <h3>Art. 13 ‚Äî Base de C√°lculo</h3>
      <p>O valor pago tomar√° sempre por base o previsto na <strong>tabela vigente na √∫ltima data processual constante na certid√£o</strong>. Para plant√µes: tabela vigente √† √©poca da indica√ß√£o.</p>
      <h3>Art. 16 ‚Äî Atua√ß√£o Parcial em Processo</h3>
      <ul>
        <li><strong>I</strong> ‚Äì Usu√°rio constitui advogado particular: <strong>30%</strong></li>
        <li><strong>II</strong> ‚Äì Extin√ß√£o por incompet√™ncia superveniente (sem culpa do advogado): <strong>30%</strong></li>
        <li><strong>III</strong> ‚Äì Advogado nomeado ap√≥s senten√ßa para fase recursal: <strong>30%</strong></li>
        <li><strong>IV</strong> ‚Äì Advogado nomeado para dar continuidade ao processo at√© senten√ßa: <strong>60%</strong></li>
      </ul>
      <p><strong>Par√°grafo √önico</strong> ‚Äî O abandono injustificado de a√ß√µes <strong>n√£o ensejar√° pagamento de honor√°rios</strong>.</p>
      <h3>Art. 18 ‚Äî Prazo para Protocolo de Certid√µes</h3>
      <p>A certid√£o de honor√°rios dever√° ser aceita ou protocolizada eletronicamente em at√© <strong>1 ano da data de sua expedi√ß√£o</strong>.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî As certid√µes somente ser√£o adimplidas se protocolizadas dentro do prazo prescricional de <strong>5 anos</strong>, contados: (I) do tr√¢nsito em julgado; (II) da ocorr√™ncia do fato gerador que autorize pagamento parcial.</p>
    </div>

    <!-- P√ÅG 19 -->
    <div class="doc-page" id="dp19">
      <span class="page-num-badge">P√°g. 19 / 24</span>
      <h3>ANEXO II ‚Äì TABELA DE HONOR√ÅRIOS (vigente a partir de 01/05/2026)</h3>
      <table>
        <tr><th>C√≥digo</th><th>Natureza da A√ß√£o</th><th>100%</th><th>70%</th><th>60%</th><th>30%</th></tr>
        <tr><td class="code">101</td><td>Procedimento Ordin√°rio/Comum</td><td class="value">R$ 1.597,69</td><td class="pct70">R$ 1.118,38</td><td>R$ 958,61</td><td>R$ 479,31</td></tr>
        <tr><td class="code">103</td><td>Execu√ß√£o de T√≠tulo Extrajudicial</td><td class="value">R$ 1.101,61</td><td class="pct70">R$ 771,13</td><td>R$ 660,97</td><td>R$ 330,48</td></tr>
        <tr><td class="code">106</td><td>Procedimento Especial</td><td class="value">R$ 1.620,63</td><td class="pct70">R$ 1.134,44</td><td>R$ 972,38</td><td>R$ 486,19</td></tr>
        <tr><td class="code">115</td><td>Curador Especial</td><td class="value">R$ 838,52</td><td class="pct70">R$ 586,96</td><td>R$ 503,11</td><td>R$ 251,56</td></tr>
        <tr><td class="code">116</td><td>Juizado Especial C√≠vel e Fazenda</td><td class="value">R$ 436,66</td><td class="pct70">R$ 305,66</td><td>R$ 262,00</td><td>R$ 131,00</td></tr>
        <tr><td class="code">117</td><td>Medida Protetiva √† Mulher V√≠tima VD</td><td colspan="4" style="color:#C9A84C">R$ 219,55 (valor √∫nico)</td></tr>
        <tr><td class="code">200</td><td>Cumprimento de Senten√ßa - Alimentos</td><td class="value">R$ 523,22</td><td class="pct70">R$ 366,25</td><td>R$ 313,93</td><td>R$ 156,97</td></tr>
        <tr><td class="code">206</td><td>Alimentos (conhecimento)</td><td class="value">R$ 855,29</td><td class="pct70">R$ 598,70</td><td>R$ 513,17</td><td>R$ 256,59</td></tr>
        <tr><td class="code">211</td><td>Separa√ß√£o/Div√≥rcio/Uni√£o Est√°vel</td><td class="value">R$ 1.106,28</td><td class="pct70">R$ 774,40</td><td>R$ 663,77</td><td>R$ 331,88</td></tr>
        <tr><td class="code">301</td><td>Criminal - Rito Ordin√°rio</td><td class="value">R$ 1.597,69</td><td class="pct70">R$ 1.118,38</td><td>R$ 958,61</td><td>R$ 479,31</td></tr>
        <tr><td class="code">304</td><td>Defesa J√∫ri da Pron√∫ncia ao Final</td><td class="value">R$ 1.699,24</td><td class="pct70">R$ 1.189,47</td><td>R$ 1.019,54</td><td>R$ 509,77</td></tr>
        <tr><td class="code">316</td><td>Viol√™ncia Dom√©stica</td><td class="value">R$ 900,75</td><td class="pct70">R$ 630,53</td><td>R$ 540,45</td><td>R$ 270,23</td></tr>
        <tr><td class="code">318</td><td>Acordo de N√£o Persecu√ß√£o Penal</td><td colspan="4" style="color:#C9A84C">R$ 265,09 (valor √∫nico)</td></tr>
        <tr><td class="code">701</td><td>Plant√£o (Juizados)</td><td colspan="4" style="color:#2ECC71">R$ 871,96 (100%)</td></tr>
        <tr><td class="code">801</td><td>Plant√£o ‚Äî 1 Dia N√£o √ötil</td><td colspan="4" style="color:#2ECC71">R$ 706,45 (100%)</td></tr>
        <tr><td class="code">802</td><td>Plant√£o ‚Äî 2 Dias N√£o √öteis Consec.</td><td colspan="4" style="color:#2ECC71">R$ 941,92 (100%)</td></tr>
      </table>
    </div>

    <!-- P√ÅG 20 -->
    <div class="doc-page" id="dp20">
      <span class="page-num-badge">P√°g. 20 / 24</span>
      <h3>ANEXO III ‚Äì NORMAS PROCEDIMENTAIS DE FISCALIZA√á√ÉO</h3>
      <h3>Cap√≠tulo I ‚Äì Da Instaura√ß√£o e Instru√ß√£o dos Procedimentos</h3>
      <p><strong>Art. 2¬∫</strong> ‚Äî O procedimento fiscalizat√≥rio ser√° instaurado pelo/a Coordenador/a Regional da DEFENSORIA ou pelo/a Presidente da Subse√ß√£o da OAB/SP, por meio de <strong>portaria</strong>.</p>
      <p><strong>Art. 5¬∫</strong> ‚Äî Instaurado o procedimento, o advogado ser√° notificado para apresentar manifesta√ß√£o no prazo improrrog√°vel de <strong>10 dias √∫teis</strong>.</p>
      <p><strong>¬ß2¬∫</strong> ‚Äî Considerar-se-√£o v√°lidas as notifica√ß√µes eletr√¥nicas encaminhadas ao e-mail de cadastro do advogado, <strong>independentemente de confirma√ß√£o de recebimento</strong>.</p>
      <p><strong>Art. 6¬∫</strong> ‚Äî Ap√≥s manifesta√ß√£o ou certificada a aus√™ncia de resposta, dever√° ser decidido fundamentadamente pelo arquivamento, continuidade ou encaminhamento √† C√¢mara Parit√°ria, em prazo que n√£o exceda <strong>30 dias</strong>.</p>
      <p><strong>Art. 7¬∫</strong> ‚Äî Da decis√£o de arquivamento, caber√° recurso do denunciante, no prazo de <strong>10 dias √∫teis</strong>, ao Defensor P√∫blico Assessor de Conv√™nios.</p>
      <h3>Cap√≠tulo II ‚Äì Das C√¢maras Parit√°rias de Julgamento e Recursal</h3>
      <p><strong>Art. 9¬∫</strong> ‚Äî As C√¢maras Parit√°rias de Julgamento s√£o compostas por: <strong>2 Defensores P√∫blicos</strong> (designados por ato da DPG-E) + <strong>2 advogados</strong> (indicados pela OAB/SP).</p>
      <p><strong>Art. 10</strong> ‚Äî A C√¢mara Recursal: <strong>4 Defensores P√∫blicos</strong> + <strong>5 advogados</strong> indicados pela OAB/SP + Defensor P√∫blico Assessor de Conv√™nios.</p>
      <p><strong>Art. 15</strong> ‚Äî O relator ter√° <strong>30 dias</strong> do recebimento do feito para relat√°-lo e requerer inclus√£o em pauta, prorrog√°veis por igual per√≠odo.</p>
    </div>

    <!-- P√ÅG 21 -->
    <div class="doc-page" id="dp21">
      <span class="page-num-badge">P√°g. 21 / 24</span>
      <h3>Art. 19 ‚Äî Intima√ß√£o do Advogado Sindicado</h3>
      <p>O advogado sindicado ser√° intimado por meio eletr√¥nico da sess√£o de julgamento com anteced√™ncia m√≠nima de <strong>10 dias √∫teis</strong>.</p>
      <p><strong>Art. 20</strong> ‚Äî As sess√µes ser√£o, em regra, realizadas por <strong>videoconfer√™ncia</strong>.</p>
      <p><strong>Art. 21</strong> ‚Äî O advogado poder√° fazer sustenta√ß√£o oral pelo tempo improrrog√°vel de <strong>5 minutos</strong>, comunicando a inten√ß√£o em at√© <strong>3 dias √∫teis</strong> anteriores √† data da reuni√£o.</p>
      <p><strong>Art. 26</strong> ‚Äî Os recursos <strong>n√£o ter√£o efeito suspensivo</strong> e dever√£o ser protocolizados pelo advogado junto ao SEI.</p>
      <p><strong>Art. 32</strong> ‚Äî Das decis√µes da C√¢mara Recursal <strong>n√£o cabe recurso</strong>.</p>
      <h3>Cap√≠tulo IV ‚Äì Das San√ß√µes</h3>
      <p><strong>Art. 42 ‚Äî Penalidades:</strong></p>
      <ul>
        <li><strong>I</strong> ‚Äì Advert√™ncia</li>
        <li><strong>II</strong> ‚Äì Suspens√£o: prazo m√°ximo de <strong>18 meses</strong></li>
        <li><strong>III</strong> ‚Äì Exclus√£o de √°rea de atua√ß√£o</li>
        <li><strong>IV</strong> ‚Äì Descredenciamento</li>
      </ul>
      <p><strong>¬ß7¬∫ ‚Äî Descredenciamento obrigat√≥rio</strong> (ainda que primeira viola√ß√£o) quando o advogado:</p>
      <ul>
        <li>I ‚Äì Solicitar, exigir ou receber quaisquer valores do usu√°rio</li>
        <li>II ‚Äì Captar clientes</li>
        <li>III ‚Äì Incorrer em erro grave na presta√ß√£o da assist√™ncia judici√°ria</li>
        <li>IV ‚Äì Praticar ato pass√≠vel de suspens√£o j√° tendo recebido tal penalidade por duas vezes</li>
      </ul>
      <p><strong>¬ß9¬∫</strong> ‚Äî O advogado descredenciado somente poder√° pleitear nova inscri√ß√£o ap√≥s <strong>2 anos</strong> contados da ci√™ncia da decis√£o.</p>
    </div>

    <!-- P√ÅG 22 -->
    <div class="doc-page" id="dp22">
      <span class="page-num-badge">P√°g. 22 / 24</span>
      <h3>Penalidades (continua√ß√£o)</h3>
      <p><strong>¬ß5¬∫</strong> ‚Äî Exclus√£o de √°rea de atua√ß√£o: prazo de <strong>24 meses</strong>, cumul√°vel com advert√™ncia ou suspens√£o, para reitera√ß√µes de condutas at√©cnicas ou que causem preju√≠zo numa mesma √°rea.</p>
      <p><strong>¬ß7¬∫ ‚Äî Advert√™ncia</strong> (primeira vez) quando o advogado:</p>
      <ul>
        <li>I ‚Äì Deixar de comparecer ao atendimento inicial (triagem)</li>
        <li>II ‚Äì Recusar indica√ß√£o ou renunciar nomea√ß√£o em desconformidade com o conv√™nio</li>
        <li>III ‚Äì N√£o propuser a medida judicial no prazo estabelecido sem justo motivo</li>
        <li>IV ‚Äì N√£o apresentar defesa ou concordar com os termos da inicial em curadoria especial</li>
        <li>VI ‚Äì Violar outras disposi√ß√µes do conv√™nio</li>
      </ul>
      <p><strong>¬ß2¬∫ ‚Äî Suspens√£o</strong> quando o advogado:</p>
      <ul>
        <li>I ‚Äì Deixar de atualizar endere√ßo profissional ou dados cadastrais</li>
        <li>II ‚Äì Deixar de comparecer a atos processuais cuja aus√™ncia implique preclus√£o ou preju√≠zo ao usu√°rio</li>
        <li>III ‚Äì N√£o comparecer ao plant√£o de Juizado Especial para o qual tenha sido nomeado</li>
        <li>IV ‚Äì Deixar de praticar ato processual que implique preclus√£o ou preju√≠zos relevantes</li>
        <li>VII ‚Äì Violar qualquer disposi√ß√£o que implique preju√≠zo ao usu√°rio, ainda que primeira viola√ß√£o</li>
      </ul>
      <p><strong>Art. 43 ‚Äî Suspens√£o Cautelar</strong>: quando (I) n√£o mantiver dados cadastrais atualizados; (II) manuten√ß√£o puder causar preju√≠zo aos usu√°rios.</p>
      <p><strong>Art. 45</strong> ‚Äî Prescri√ß√£o: a punibilidade por infra√ß√£o prescreve em <strong>5 anos</strong> da data do conhecimento do fato.</p>
    </div>

    <!-- P√ÅG 23 -->
    <div class="doc-page" id="dp23">
      <span class="page-num-badge">P√°g. 23 / 24</span>
      <h3>Cap√≠tulo V ‚Äì Disposi√ß√µes Gerais</h3>
      <p><strong>Art. 47</strong> ‚Äî Aplicada a penalidade (exceto advert√™ncia), o advogado <strong>n√£o far√° jus a quaisquer honor√°rios</strong> nos processos relacionados √† causa da san√ß√£o. Se j√° os tiver recebido, ser√° intimado para restitui√ß√£o.</p>
      <p><strong>Art. 48 ‚Äî Interrup√ß√£o da prescri√ß√£o</strong> (somente uma vez) se dar√°:</p>
      <ul>
        <li>I ‚Äì Da ci√™ncia inequ√≠voca da instaura√ß√£o do procedimento</li>
        <li>II ‚Äì Pela apresenta√ß√£o de manifesta√ß√£o nos autos</li>
        <li>III ‚Äì Pela propositura de medida judicial impugnando a portaria</li>
        <li>IV ‚Äì Da pr√°tica de qualquer ato no bojo do procedimento</li>
      </ul>
      <p><strong>Art. 49</strong> ‚Äî A execu√ß√£o da pena aplicada prescreve em <strong>5 anos</strong> contados da data da decis√£o.</p>
      <p><strong>Art. 53</strong> ‚Äî Os procedimentos fiscalizat√≥rios possuem, em regra, <strong>car√°ter sigiloso</strong>.</p>
      <h3>CL√ÅUSULA TRIG√âSIMA ‚Äî Anexos Integrantes</h3>
      <ul>
        <li><strong>Anexo I</strong> ‚Äì Dos Honor√°rios e Certid√µes</li>
        <li><strong>Anexo II</strong> ‚Äì Tabela de Honor√°rios</li>
        <li><strong>Anexo III</strong> ‚Äì Normas Procedimentais de Fiscaliza√ß√£o</li>
        <li><strong>Anexo IV</strong> ‚Äì Ficha de Atendimento</li>
        <li><strong>Anexo V</strong> ‚Äì Recibo de Documentos</li>
        <li><strong>Anexo VI</strong> ‚Äì Plano de Trabalho</li>
      </ul>
      <div class="highlight">
        <p><strong>CL√ÅUSULA TRIG√âSIMA PRIMEIRA</strong> ‚Äî At√© a homologa√ß√£o da lista de advogados inscritos, ser√° utilizada a lista vigente para fins de indica√ß√£o dos advogados.</p>
      </div>
      <p>E por estarem certos e ajustados, firmam as part√≠cipes o presente conv√™nio, <strong>ficando revogados todos os conv√™nios anteriores</strong>.</p>
    </div>

    <!-- P√ÅG 24 -->
    <div class="doc-page" id="dp24">
      <span class="page-num-badge">P√°g. 24 / 24</span>
      <h3>ANEXO IV ‚Äì FICHA DE ATENDIMENTO</h3>
      <div style="border:2px solid #C9A84C; padding:24px; margin:16px 0; min-height:200px;">
        <p><strong>Relato dos Fatos:</strong></p>
        <div style="border:1px solid #ccc; min-height:120px; padding:8px; margin:8px 0; background:#fafafa;"></div>
        <p style="font-size:11px; text-align:center;"><em>Declaro que as informa√ß√µes prestadas s√£o express√µes da verdade, responsabilizando-me civil e criminalmente pela integralidade de seu conte√∫do.</em></p>
        <p>Assinatura do Cliente: _________________________________ Data: ____/____/________</p>
      </div>
      <h3>ANEXO V ‚Äì RECIBO DE DOCUMENTOS</h3>
      <div style="border:2px solid #C9A84C; padding:24px; font-size:12.5px;">
        <p><strong>RECIBO DE DOCUMENTOS</strong></p>
        <p>Eu, _________________________, OAB/SP n¬∫ _____, advogado(a) inscrito(a) no Conv√™nio firmado pela Defensoria P√∫blica com a OAB/SP para presta√ß√£o de assist√™ncia judici√°ria gratuita suplementar no Foro _____________________________, tendo sido nomeado para defender os interesses de ________________________________, RG n¬∫ ____________________, referente ao of√≠cio de indica√ß√£o n¬∫ ___________, pela presente, declaro haver recebido, nesta data, o(s) documento(s) abaixo relacionado(s), essencial(is) para a defesa dos interesses da parte.</p>
        <p style="margin-top:20px;">_______________, ___/___/_____ (Local e data)</p>
        <p>Nome do(a) Advogado(a) ‚Äì Inscri√ß√£o na OAB/SP n¬∫ ________</p>
      </div>
      <p style="text-align:center; margin-top:30px; font-size:11px; color:#666;">Documento assinado eletronicamente por DEFENSORIA P√öBLICA DO ESTADO DE S√ÉO PAULO e LEONARDO SICA, OAB/SP, em 06/02/2026. C√≥digo verificador: 1715918 ‚Äî CRC: B0425250</p>
    </div>

  </div><!-- doc-pages-container -->
</div><!-- panel-doc -->


<!-- ============================
     ABA 2: FLASHCARDS
============================= -->
<div id="panel-flash" class="panel">
  <div class="section-header">
    <div class="section-title">50 Flashcards ‚Äî Dom√≠nio Total</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Clique para virar ‚Ä¢ Categorize por √°rea ‚Ä¢ Monitore seu progresso</div>
  </div>
  <div class="flash-controls">
    <div class="fc-stat"><strong id="fc-total">50</strong>Total</div>
    <div class="fc-stat"><strong id="fc-flipped">0</strong>Virados</div>
    <div class="fc-stat"><strong id="fc-mastered">0</strong>Dominados ‚≠ê‚≠ê‚≠ê</div>
    <div class="fc-stat fav-stat"><strong id="fc-favs">0</strong>‚ù§Ô∏è Favoritos</div>
    <div class="cat-filter">
      <button class="cat-btn active" onclick="filterCards('all',this)">Todos</button>
      <button class="cat-btn" onclick="filterCards('C√çVEL',this)">C√≠vel</button>
      <button class="cat-btn" onclick="filterCards('CRIMINAL',this)">Criminal</button>
      <button class="cat-btn" onclick="filterCards('HONOR√ÅRIOS',this)">Honor√°rios</button>
      <button class="cat-btn" onclick="filterCards('PRAZOS',this)">Prazos</button>
      <button class="cat-btn" onclick="filterCards('SAN√á√ïES',this)">San√ß√µes</button>
      <button class="cat-btn" onclick="filterCards('INSCRI√á√ÉO',this)">Inscri√ß√£o</button>
      <button class="cat-btn" id="favFilterBtn" onclick="filterCards('FAV',this)">‚ù§Ô∏è Favoritos</button>
    </div>
  </div>
  <div class="cards-grid" id="flashContainer"></div>
</div>


<!-- ============================
     ABA 3: 50 REGRAS
============================= -->
<div id="panel-rules" class="panel">
  <div class="section-header">
    <div class="section-title">50 Regras Mais Importantes</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">As regras que todo especialista no Conv√™nio DPE-OAB deve dominar</div>
  </div>
  <div class="rules-grid" id="rulesContainer"></div>
</div>


<!-- ============================
     ABA 4: HONOR√ÅRIOS
============================= -->
<div id="panel-honorarios" class="panel">
  <div class="section-header">
    <div class="section-title">Tabela Completa de Honor√°rios</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Vigente a partir de 01/05/2026 ‚Äî Reajuste anual pelo IPC/FIPE</div>
  </div>
  <div class="honorarios-section" style="overflow-x:auto;">
    <h3>‚öñÔ∏è √Årea C√≠vel</h3>
    <div class="hon-table-wrap"><table class="hon-table">
      <tr><th>C√≥d.</th><th>Natureza da A√ß√£o</th><th>100%</th><th>70%</th><th>60%</th><th>30%</th></tr>
      <tr><td class="code">101</td><td>Procedimento Ordin√°rio/Comum</td><td class="value">1.597,69</td><td class="pct70">1.118,38</td><td>958,61</td><td>479,31</td></tr>
      <tr><td class="code">102</td><td>Procedimento Sum√°rio (at√© 18/03/2016)</td><td class="value">1.080,42</td><td class="pct70">756,29</td><td>648,25</td><td>324,13</td></tr>
      <tr><td class="code">103</td><td>Execu√ß√£o Extrajudicial e Judicial</td><td class="value">1.101,61</td><td class="pct70">771,13</td><td>660,97</td><td>330,48</td></tr>
      <tr><td class="code">104</td><td>Declarat√≥rias</td><td class="value">1.101,61</td><td class="pct70">771,13</td><td>660,97</td><td>330,48</td></tr>
      <tr><td class="code">105</td><td>Embargos de Terceiros</td><td class="value">1.101,61</td><td class="pct70">771,13</td><td>660,97</td><td>330,48</td></tr>
      <tr><td class="code">106</td><td>Procedimento Especial</td><td class="value">1.620,63</td><td class="pct70">1.134,44</td><td>972,38</td><td>486,19</td></tr>
      <tr><td class="code">108</td><td>Possess√≥rias (Usucapi√£o)</td><td class="value">1.620,63</td><td class="pct70">1.134,44</td><td>972,38</td><td>486,19</td></tr>
      <tr><td class="code">113</td><td>Mandado de Seguran√ßa</td><td class="value">1.080,42</td><td class="pct70">756,29</td><td>648,25</td><td>324,13</td></tr>
      <tr><td class="code">115</td><td>Curador Especial</td><td class="value">838,52</td><td class="pct70">586,96</td><td>503,11</td><td>251,56</td></tr>
      <tr><td class="code">116</td><td>Juizado Especial C√≠vel e Fazenda P√∫blica</td><td class="value">436,66</td><td class="pct70">305,66</td><td>262,00</td><td>131,00</td></tr>
      <tr><td class="code">117</td><td>Medida Protetiva √† Mulher V√≠tima VD</td><td colspan="4" class="value">219,55 (valor fixo)</td></tr>
      <tr><td class="code">118</td><td>Defesa em Medida Protetiva Aut√¥noma</td><td colspan="4" class="value">190,92 (valor fixo)</td></tr>
    </table></div>

    <h3>üë®‚Äçüë©‚Äçüëß Fam√≠lia e Sucess√µes</h3>
    <div class="hon-table-wrap"><table class="hon-table">
      <tr><th>C√≥d.</th><th>Natureza da A√ß√£o</th><th>100%</th><th>70%</th><th>60%</th><th>30%</th></tr>
      <tr><td class="code">200</td><td>Cumprimento de Senten√ßa - Alimentos</td><td class="value">523,22</td><td class="pct70">366,25</td><td>313,93</td><td>156,97</td></tr>
      <tr><td class="code">201</td><td>Invent√°rios e Arrolamentos</td><td class="value">1.312,73</td><td class="pct70">918,91</td><td>787,64</td><td>393,82</td></tr>
      <tr><td class="code">205</td><td>Investiga√ß√£o de Paternidade</td><td class="value">1.560,57</td><td class="pct70">1.092,40</td><td>936,34</td><td>468,17</td></tr>
      <tr><td class="code">206</td><td>Alimentos (conhecimento)</td><td class="value">855,29</td><td class="pct70">598,70</td><td>513,17</td><td>256,59</td></tr>
      <tr><td class="code">207</td><td>Tutela e Curatela</td><td class="value">872,06</td><td class="pct70">610,44</td><td>523,24</td><td>261,62</td></tr>
      <tr><td class="code">210</td><td>Modifica√ß√£o/Regulamenta√ß√£o Guarda/Visitas</td><td class="value">1.147,53</td><td class="pct70">803,27</td><td>688,52</td><td>344,26</td></tr>
      <tr><td class="code">211</td><td>Separa√ß√£o/Div√≥rcio/Uni√£o Est√°vel</td><td class="value">1.106,28</td><td class="pct70">774,40</td><td>663,77</td><td>331,88</td></tr>
    </table></div>

    <h3>‚öñÔ∏è √Årea Criminal</h3>
    <div class="hon-table-wrap"><table class="hon-table">
      <tr><th>C√≥d.</th><th>Natureza da A√ß√£o</th><th>100%</th><th>70%</th><th>60%</th><th>30%</th></tr>
      <tr><td class="code">301</td><td>Rito Ordin√°rio</td><td class="value">1.597,69</td><td class="pct70">1.118,38</td><td>958,61</td><td>479,31</td></tr>
      <tr><td class="code">302</td><td>Rito Sum√°rio</td><td class="value">1.472,42</td><td class="pct70">1.030,69</td><td>883,45</td><td>441,73</td></tr>
      <tr><td class="code">315</td><td>Rito Sumar√≠ssimo</td><td class="value">883,43</td><td class="pct70">618,40</td><td>530,06</td><td>265,03</td></tr>
      <tr><td class="code">303</td><td>Defesa J√∫ri at√© Pron√∫ncia</td><td class="value">1.147,53</td><td class="pct70">803,27</td><td>688,52</td><td>344,26</td></tr>
      <tr><td class="code">304</td><td>Defesa J√∫ri da Pron√∫ncia ao Final</td><td class="value">1.699,24</td><td class="pct70">1.189,47</td><td>1.019,54</td><td>509,77</td></tr>
      <tr><td class="code">310</td><td>Execu√ß√£o Penal</td><td class="value">675,29</td><td class="pct70">472,70</td><td>405,17</td><td>202,59</td></tr>
      <tr><td class="code">316</td><td>Viol√™ncia Dom√©stica</td><td class="value">900,75</td><td class="pct70">630,53</td><td>540,45</td><td>270,23</td></tr>
      <tr><td class="code">317</td><td>Depoimento Especial / Oitiva Racismo</td><td colspan="4" class="value">218,47 (valor fixo)</td></tr>
      <tr><td class="code">318</td><td>Acordo de N√£o Persecu√ß√£o Penal</td><td colspan="4" class="value">265,09 (valor fixo)</td></tr>
    </table></div>

    <h3>üë∂ Inf√¢ncia e Juventude / Plant√µes</h3>
    <div class="hon-table-wrap"><table class="hon-table">
      <tr><th>C√≥d.</th><th>Natureza da A√ß√£o</th><th>100%</th><th>70%</th><th>60%</th><th>30%</th></tr>
      <tr><td class="code">501</td><td>Qualquer Proc. C√≠vel (IJ)</td><td class="value">841,34</td><td class="pct70">588,94</td><td>504,80</td><td>252,40</td></tr>
      <tr><td class="code">502</td><td>Qualquer Proc. Criminal (IJ)</td><td class="value">794,96</td><td class="pct70">556,47</td><td>476,98</td><td>238,49</td></tr>
      <tr><td class="code">601</td><td>Carta Precat√≥ria</td><td class="value">427,58</td><td class="pct70">299,31</td><td>256,55</td><td>128,27</td></tr>
      <tr><td class="code">701</td><td>Plant√£o (Juizados)</td><td colspan="4" class="value">871,96 (100%)</td></tr>
      <tr><td class="code">801</td><td>Plant√£o ‚Äî 1 Dia N√£o √ötil</td><td colspan="4" class="value">706,45 (100%)</td></tr>
      <tr><td class="code">802</td><td>Plant√£o ‚Äî 2 Dias N√£o √öteis Consecutivos</td><td colspan="4" class="value">941,92 (100%)</td></tr>
    </table></div>
  </div>
</div>


<!-- ============================
     ABA 5: QUIZ
============================= -->
<div id="panel-quiz" class="panel">
  <div id="quiz-start-screen" class="quiz-start">
    <div class="section-header" style="margin-bottom:24px;">
      <div class="section-title">Quiz ‚Äî 50 Perguntas</div>
      <div class="gold-line" style="margin:10px auto;"></div>
      <div class="section-subtitle">Prove seu dom√≠nio sobre o Conv√™nio DPE-OAB 001/2026</div>
    </div>
    <div class="stats-row" style="flex-wrap:wrap; gap:12px;">
      <div class="stat-box"><strong>50</strong><span>Perguntas</span></div>
      <div class="stat-box"><strong>45s</strong><span>Por Quest√£o</span></div>
      <div class="stat-box"><strong>17</strong><span>Categorias</span></div>
      <div class="stat-box"><strong>üèÜ</strong><span>Certificado</span></div>
    </div>
    <p style="margin-bottom:16px;">Responda todas as 50 perguntas sobre o Conv√™nio.<br>Ao final, receba seu certificado personalizado com seu nome.</p>
    <div style="margin-bottom:24px;">
      <label style="display:block; color:var(--gold); font-family:'Playfair Display',serif; font-size:0.95rem; margin-bottom:8px; letter-spacing:1px;">‚úçÔ∏è SEU NOME COMPLETO (para o certificado)</label>
      <input id="input-nome-quiz" type="text" placeholder="Digite seu nome completo..." 
        style="width:100%; max-width:420px; padding:14px 20px; border-radius:8px; border:2px solid var(--gold); background:#0d1020; color:#fff; font-size:1rem; font-family:'DM Sans',sans-serif; outline:none; text-align:center; letter-spacing:0.5px;"
        onkeydown="if(event.key==='Enter') startQuiz()"
      />
    </div>
    <button class="btn-gold" onclick="startQuiz()" style="font-size:1.1rem; padding:16px 48px;">
      üéØ INICIAR QUIZ
    </button>
  </div>

  <div id="quiz-container" class="quiz-container">
    <div class="quiz-header">
      <div class="quiz-progress-bar"><div class="quiz-progress-fill" id="qProgressFill" style="width:2%"></div></div>
      <span class="quiz-num" id="qNum">1/50</span>
      <span class="quiz-timer" id="qTimer">45</span>
      <span class="quiz-score-live">Acertos: <span id="qScore">0</span></span>
    </div>
    <div class="quiz-card">
      <div class="quiz-category" id="qCat"></div>
      <div class="quiz-question" id="qQuestion"></div>
      <div class="quiz-options" id="qOptions"></div>
      <div class="quiz-explanation" id="qExplanation"></div>
    </div>
    <div class="quiz-next" id="qNext">
      <button class="btn-gold" onclick="nextQuestion()">Pr√≥xima ‚ñ∂</button>
    </div>
  </div>

  <div id="cert-container" class="cert-container">
    <div class="cert-box">
      <div class="cert-corner tl"></div>
      <div class="cert-corner tr"></div>
      <div class="cert-corner bl"></div>
      <div class="cert-corner br"></div>
      <div class="cert-seal">üèõÔ∏è</div>
      <div class="cert-title">CERTIFICADO DE ESPECIALIZA√á√ÉO</div>
      <div class="cert-subtitle">Conv√™nio DPE-OAB/SP 001/2026</div>
      <hr class="cert-line">
      <p class="cert-text">Certificamos que</p>
      <div class="cert-name" id="cert-nome-display">‚Äî</div>
      <p class="cert-text">concluiu com √™xito o programa intensivo de dom√≠nio completo do<br><strong style="color:var(--gold);">Conv√™nio N¬∫ 001/2026 ‚Äî Defensoria P√∫blica do Estado de S√£o Paulo / OAB-SP</strong><br>demonstrando conhecimento especializado em assist√™ncia judici√°ria gratuita suplementar,<br>regras de honor√°rios, prazos processuais, indica√ß√µes e regime disciplinar.</p>
      <div class="cert-score" id="certScore">0/50</div>
      <div class="cert-stars" id="certStars">‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</div>
      <p class="cert-text" id="certLevel"></p>
      <hr class="cert-line">
      <p class="cert-date" id="certDate"></p>
      <p class="cert-issued">Emitido pelo PAINEL LEND√ÅRIO DPE-OAB 001/2026</p>
    </div>
    <div class="cert-actions">
      <button class="btn-gold" onclick="printCert()">üñ®Ô∏è Imprimir Certificado</button>
      <button class="btn-outline" onclick="resetQuiz()">üîÑ Refazer Quiz</button>
    </div>
  </div>
  <!-- Breakdown por categoria -->
  <div class="cert-cat-breakdown" id="catBreakdown" style="display:none">
    <h4>üìä Desempenho por Categoria</h4>
    <div id="catBreakdownRows"></div>
  </div>
  <!-- Hist√≥rico de tentativas -->
  <div class="history-section">
    <div class="history-title">üìã Hist√≥rico de Tentativas</div>
    <div class="history-list" id="historyList"></div>
  </div>
  </div>
</div>


<!-- ============================
     ABA 6: DESAFIOS
============================= -->
<div id="panel-desafios" class="panel">
  <div class="section-header">
    <div class="section-title">Desafios de Especializa√ß√£o</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Complete os desafios para atingir o status de Especialista Total no Conv√™nio</div>
  </div>
  <div class="challenges-grid" id="challengesContainer"></div>
</div>



<!-- ============================
     ABA 7: MAPA MENTAL
============================= -->
<div id="panel-mapa" class="panel">
  <div class="section-header">
    <div class="section-title">Mapa Mental ‚Äî Conv√™nio 001/2026</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Clique nos n√≥s para explorar cada tema do conv√™nio</div>
  </div>
  <div id="mapa-container" style="position:relative; width:100%; overflow:hidden; border-radius:16px; border:1px solid var(--border); background:var(--surface);">
    <canvas id="mapaCanvas" style="display:block; width:100%;"></canvas>
    <div id="mapa-tooltip" style="display:none; position:absolute; background:var(--surface2); border:1px solid var(--gold); border-radius:10px; padding:14px 18px; max-width:280px; z-index:10; pointer-events:none; box-shadow:0 8px 32px rgba(0,0,0,.5);">
      <div id="mapa-tip-title" style="color:var(--gold); font-weight:700; font-family:'Playfair Display',serif; margin-bottom:8px; font-size:.95rem;"></div>
      <div id="mapa-tip-body" style="color:var(--text-muted); font-size:.8rem; line-height:1.6;"></div>
    </div>
  </div>
  <div style="text-align:center; margin-top:12px; font-size:11px; color:var(--text-muted);">
    üñ±Ô∏è Clique nos n√≥s para ver detalhes ‚Ä¢ Arraste para navegar ‚Ä¢ Scroll para zoom
  </div>
</div>

<!-- ============================
     ABA 8: ASSISTENTE IA
============================= -->
<div id="panel-ia" class="panel">
  <div class="section-header">
    <div class="section-title">Assistente IA ‚Äî DPE-OAB Expert</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Tire d√∫vidas sobre qualquer artigo do conv√™nio em linguagem simples</div>
  </div>
  <div class="ia-container">
    <div class="ia-suggestions">
      <div class="ia-sug-title">üí° Perguntas frequentes:</div>
      <div class="ia-sug-grid">
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">Quais √°reas o conv√™nio N√ÉO cobre?</button>
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">Como funciona o pagamento de honor√°rios?</button>
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">Quais s√£o as penalidades por infra√ß√£o?</button>
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">Qual o prazo para ajuizar a√ß√£o c√≠vel?</button>
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">Como √© o requisito para atuar no J√∫ri?</button>
        <button class="ia-sug-btn" onclick="sendSuggestion(this)">O que √© o ANPP no conv√™nio?</button>
      </div>
    </div>
    <div class="ia-chat" id="iaChat">
      <div class="ia-msg ia-msg-bot">
        <div class="ia-avatar">‚öñÔ∏è</div>
        <div class="ia-bubble">
          <strong>Ol√°! Sou o Assistente IA do Conv√™nio DPE-OAB 001/2026.</strong><br><br>
          Estou aqui para explicar qualquer artigo, regra ou d√∫vida sobre o conv√™nio em linguagem clara e direta. Pode perguntar! üëá
        </div>
      </div>
    </div>
    <div class="ia-input-row">
      <input id="iaInput" class="ia-input" type="text" placeholder="Ex: O que acontece se o advogado cobrar o cliente?" onkeydown="if(event.key==='Enter')sendIA()" />
      <button class="ia-send-btn" onclick="sendIA()" id="iaSendBtn">
        <span id="iaSendIcon">‚û§</span>
      </button>
    </div>
  </div>
</div>

<!-- ============================
     ABA 9: CONQUISTAS
============================= -->
<div id="panel-conquistas" class="panel">
  <div class="section-header">
    <div class="section-title">Conquistas & Badges</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">20 conquistas para desbloquear ‚Äî cada uma celebra um marco de aprendizado</div>
  </div>
  <div class="conquistas-stats" id="conquistasStats"></div>
  <div class="conquistas-grid" id="conquistasGrid"></div>
</div>



<!-- ============================
     ABA: BATALHA
============================= -->
<div id="panel-batalha" class="panel">
  <div class="section-header">
    <div class="section-title">‚öîÔ∏è Modo Batalha</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Responda r√°pido, preserve vidas, bata seu recorde!</div>
  </div>
  <div id="batalha-start-screen" class="batalha-start">
    <div class="batalha-hero">‚öîÔ∏è</div>
    <h2 class="batalha-title">MODO BATALHA</h2>
    <p class="batalha-subtitle">Responda correto antes do tempo acabar.<br>Voc√™ tem <strong>3 vidas</strong>. Cada erro perde uma vida.</p>
    <div class="batalha-stats-row">
      <div class="b-stat"><strong id="bt-record">0</strong><span>Recorde</span></div>
      <div class="b-stat"><strong id="bt-played">0</strong><span>Partidas</span></div>
      <div class="b-stat"><strong>3</strong><span>Vidas</span></div>
      <div class="b-stat"><strong>20s</strong><span>Por Q.</span></div>
    </div>
    <button class="btn-batalha" onclick="startBatalha()">‚öîÔ∏è ENTRAR NA BATALHA</button>
  </div>
  <div id="batalha-game" style="display:none;">
    <div class="batalha-header">
      <div class="b-lives" id="bLives">‚ù§Ô∏è‚ù§Ô∏è‚ù§Ô∏è</div>
      <div class="b-score-live">Pontos: <span id="bScore">0</span></div>
      <div class="b-timer-bar"><div class="b-timer-fill" id="bTimerFill"></div></div>
      <div class="b-timer-num" id="bTimerNum">20</div>
    </div>
    <div class="batalha-card">
      <div class="b-cat" id="bCat"></div>
      <div class="b-question" id="bQuestion"></div>
      <div class="b-options" id="bOptions"></div>
    </div>
  </div>
  <div id="batalha-over" style="display:none;" class="batalha-over-screen">
    <div class="b-over-icon" id="bOverIcon">üíÄ</div>
    <h2 id="bOverTitle">Fim de Jogo!</h2>
    <div class="b-over-score" id="bOverScore">0 pontos</div>
    <div class="b-over-record" id="bOverRecord"></div>
    <div class="b-over-combo" id="bOverCombo"></div>
    <button class="btn-batalha" onclick="startBatalha()" style="margin-top:24px;">üîÑ Jogar Novamente</button>
    <button class="btn-outline" onclick="openTab('analise')" style="margin-top:10px;width:100%;">üìä Ver An√°lise de Desempenho</button>
  </div>
</div>

<!-- ============================
     ABA: PLANO 30 DIAS
============================= -->
<div id="panel-plano" class="panel">
  <div class="section-header">
    <div class="section-title">üìÖ Plano de Estudo ‚Äî 30 Dias</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Cronograma completo para dominar o Conv√™nio 001/2026</div>
  </div>
  <div class="plano-header">
    <div class="plano-prog-bar"><div class="plano-prog-fill" id="planoPropFill"></div></div>
    <div style="display:flex;justify-content:space-between;font-size:11px;color:var(--text-muted);margin-top:6px;">
      <span id="planoProgText">0 / 30 dias conclu√≠dos</span>
      <span id="planoPercent">0%</span>
    </div>
  </div>
  <div class="plano-grid" id="planoGrid"></div>
</div>

<!-- ============================
     ABA: AN√ÅLISE IA
============================= -->
<div id="panel-analise" class="panel">
  <div class="section-header">
    <div class="section-title">üìä An√°lise de Desempenho</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">IA identifica seus pontos fracos e cria estrat√©gia personalizada</div>
  </div>
  <div class="analise-container">
    <div class="analise-cards-row" id="analiseCards"></div>
    <div class="analise-block" id="analiseWeak" style="display:none;">
      <h3 class="analise-block-title">üéØ √Åreas que Precisam de Aten√ß√£o</h3>
      <div id="analiseWeakList"></div>
    </div>
    <div class="analise-ia-box" id="analiseIaBox">
      <div class="analise-ia-header">
        <span>ü§ñ</span>
        <span>An√°lise Personalizada por IA</span>
      </div>
      <div id="analiseIaContent">
        <p style="color:var(--text-muted);font-size:.9rem;">Complete o quiz e use os flashcards para que a IA possa analisar seu desempenho e criar um plano personalizado.</p>
        <button class="btn-gold" onclick="runAnaliseIA()" style="margin-top:16px;">ü§ñ Gerar An√°lise Agora</button>
      </div>
    </div>
  </div>
</div>

<!-- ============================
     ABA: STREAK
============================= -->
<div id="panel-streak" class="panel">
  <div class="section-header">
    <div class="section-title">üî• Streak de Estudo</div>
    <div class="gold-line"></div>
    <div class="section-subtitle">Estude todos os dias e construa sua sequ√™ncia de vit√≥rias!</div>
  </div>
  <div class="streak-container">
    <div class="streak-main">
      <div class="streak-fire-icon" id="streakFireIcon">üî•</div>
      <div class="streak-number" id="streakNumber">0</div>
      <div class="streak-label">dias consecutivos</div>
      <div class="streak-msg" id="streakMsg">Comece hoje seu streak!</div>
      <button class="btn-gold" onclick="markStudyToday()" id="streakCheckBtn" style="margin-top:20px;padding:14px 40px;font-size:1rem;">‚úÖ Marcar Estudo de Hoje</button>
    </div>
    <div class="streak-calendar" id="streakCalendar"></div>
    <div class="streak-milestones">
      <h3 style="color:var(--gold);font-family:'Playfair Display',serif;margin-bottom:16px;">üèÜ Marcos do Streak</h3>
      <div class="streak-miles-grid" id="streakMilesGrid"></div>
    </div>
  </div>
</div>

</main>

<footer>
  <strong style="color:var(--gold)">CONV√äNIO N¬∫ 001/2026 ‚Äî DPE-SP / OAB-SP</strong> | PAINEL LEND√ÅRIO | C√°ssia Kelly Lins Reis
</footer>

<script>
// ============================================================
//  PARTICLES
// ============================================================
// Detect preserve-3d support
(function detect3D() {
  const test = document.createElement('div');
  test.style.cssText = 'transform-style:preserve-3d;-webkit-transform-style:preserve-3d;position:absolute;opacity:0;';
  document.body.appendChild(test);
  const style = window.getComputedStyle(test);
  const supported = style.getPropertyValue('transform-style') === 'preserve-3d' ||
                    style.getPropertyValue('-webkit-transform-style') === 'preserve-3d';
  document.body.removeChild(test);
  
  // Also check if on Android Chrome which sometimes lies
  const ua = navigator.userAgent;
  const isAndroid = /Android/i.test(ua);
  const isSafari = /^((?!chrome|android).)*safari/i.test(ua);
  
  // Force fallback on Android or if not supported
  if (!supported || isAndroid) {
    document.body.classList.add('no-3d');
  }
})();

(function createParticles() {
  const container = document.getElementById('particles');
  const isMobile = window.innerWidth < 768;
  for (let i = 0; i < (isMobile ? 10 : 30); i++) {
    const p = document.createElement('div');
    p.className = 'particle';
    p.style.cssText = `left:${Math.random()*100}%;width:${Math.random()*3+1}px;height:${Math.random()*3+1}px;animation-duration:${Math.random()*20+10}s;animation-delay:${Math.random()*20}s;opacity:${Math.random()*0.5}`;
    container.appendChild(p);
  }
})();

// ============================================================
//  TAB NAVIGATION
// ============================================================
function openTab(id) {
  // Remove active from all panels and tabs
  document.querySelectorAll('.panel').forEach(p => p.classList.remove('active'));
  document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));

  // Show the panel
  const panel = document.getElementById('panel-' + id);
  if (panel) panel.classList.add('active');

  // Activate matching tab button
  document.querySelectorAll('.tab').forEach(t => {
    if (t.getAttribute('onclick') === "openTab('" + id + "')") t.classList.add('active');
  });

  // Panel-specific init
  if (id === 'mapa') setTimeout(initMapa, 80);
  if (id === 'conquistas') { checkBadges(true); renderConquistas(); }
  if (id === 'plano') { if (typeof renderPlano === 'function') renderPlano(); }
  if (id === 'analise') { if (typeof renderAnalise === 'function') renderAnalise(); }
  if (id === 'streak') { if (typeof renderStreak === 'function') renderStreak(); }
  if (id === 'batalha') { if (typeof updateBatalhaStats === 'function') updateBatalhaStats(); }

  // Smooth fade-in
  if (panel) {
    panel.style.opacity = '0';
    panel.style.transform = 'translateY(8px)';
    requestAnimationFrame(() => {
      panel.style.transition = 'opacity .25s ease, transform .25s ease';
      panel.style.opacity = '1';
      panel.style.transform = 'translateY(0)';
    });
  }
}

// ============================================================
//  AUDIOBOOK
// ============================================================
let synth = window.speechSynthesis;
let currentUtterance = null;
let currentPage = 1;

function getPageText(pageNum) {
  const el = document.getElementById('dp'+pageNum);
  return el ? el.innerText : '';
}

function audioPlay() {
  synth.cancel();
  const speed = parseFloat(document.getElementById('speedSelect').value);
  const text = getPageText(currentPage);
  currentUtterance = new SpeechSynthesisUtterance(text);
  currentUtterance.lang = 'pt-BR';
  currentUtterance.rate = speed;
  currentUtterance.onstart = () => {
    document.getElementById('btnPlay').classList.add('playing');
    document.getElementById('audio-status').textContent = 'üîä Reproduzindo p√°gina ' + currentPage + ' de 24...';
  };
  currentUtterance.onend = () => {
    document.getElementById('btnPlay').classList.remove('playing');
    document.getElementById('audio-status').textContent = '‚úÖ P√°gina ' + currentPage + ' conclu√≠da.';
    if (currentPage < 24) {
      setTimeout(() => { changePage(1); audioPlay(); }, 1000);
    }
  };
  synth.speak(currentUtterance);
}

function audioPause() {
  synth.paused ? synth.resume() : synth.pause();
  document.getElementById('audio-status').textContent = synth.paused ? '‚è∏ Pausado' : 'üîä Reproduzindo...';
}

function audioStop() {
  synth.cancel();
  document.getElementById('btnPlay').classList.remove('playing');
  document.getElementById('audio-status').textContent = 'Audiobook parado.';
}

// Track read pages
const readPages = new Set(JSON.parse(localStorage.getItem('dpe_read_pages') || '[]'));

function markPageRead(p) {
  readPages.add(p);
  localStorage.setItem('dpe_read_pages', JSON.stringify([...readPages]));
  updateReadingProgress();
}

function updateReadingProgress() {
  const pct = (readPages.size / 24 * 100).toFixed(0);
  document.getElementById('readProgressFill').style.width = pct + '%';
  document.getElementById('readingSummary').textContent = readPages.size + ' / 24 p√°ginas lidas';
}

function changePage(dir) {
  markPageRead(currentPage);
  const newPage = currentPage + dir;
  if (newPage < 1 || newPage > 24) return;
  document.getElementById('dp'+currentPage).classList.remove('active');
  currentPage = newPage;
  document.getElementById('dp'+currentPage).classList.add('active');
  document.getElementById('pageProgress').textContent = currentPage + ' / 24';
}

// Init reading progress on load
updateReadingProgress();

// ============================================================
//  DOCUMENT SEARCH
// ============================================================
let searchTimer = null;
function searchDoc(query) {
  clearTimeout(searchTimer);
  searchTimer = setTimeout(() => {
    // Remove previous highlights
    document.querySelectorAll('.doc-page').forEach(page => {
      page.querySelectorAll('.search-hit').forEach(el => {
        el.replaceWith(document.createTextNode(el.textContent));
      });
      // Merge adjacent text nodes
      page.normalize();
    });
    
    const status = document.getElementById('searchStatus');
    if (!query || query.length < 2) { status.textContent = ''; return; }
    
    let total = 0;
    let firstPage = null;
    
    document.querySelectorAll('.doc-page').forEach((page, pidx) => {
      const walker = document.createTreeWalker(page, NodeFilter.SHOW_TEXT, null, false);
      const nodes = [];
      let node;
      while ((node = walker.nextNode())) nodes.push(node);
      
      nodes.forEach(textNode => {
        const idx = textNode.textContent.toLowerCase().indexOf(query.toLowerCase());
        if (idx === -1) return;
        const span = document.createElement('span');
        span.className = 'search-hit';
        const before = document.createTextNode(textNode.textContent.substring(0, idx));
        span.textContent = textNode.textContent.substring(idx, idx + query.length);
        const after = document.createTextNode(textNode.textContent.substring(idx + query.length));
        const frag = document.createDocumentFragment();
        frag.appendChild(before); frag.appendChild(span); frag.appendChild(after);
        textNode.parentNode.replaceChild(frag, textNode);
        total++;
        if (!firstPage) firstPage = pidx + 1;
      });
    });
    
    if (total > 0) {
      status.textContent = total + ' resultado(s) ‚Äî primeira ocorr√™ncia: p√°g. ' + firstPage;
      // Navigate to first page with result
      if (firstPage && firstPage !== currentPage) {
        document.getElementById('dp'+currentPage).classList.remove('active');
        currentPage = firstPage;
        document.getElementById('dp'+currentPage).classList.add('active');
        document.getElementById('pageProgress').textContent = currentPage + ' / 24';
      }
      // Scroll to first hit
      const firstHit = document.querySelector('.search-hit');
      if (firstHit) firstHit.scrollIntoView({ behavior:'smooth', block:'center' });
    } else {
      status.textContent = 'Nenhum resultado para "' + query + '"';
    }
  }, 400);
}

// ============================================================
//  FLASHCARDS DATA (50 cards)
// ============================================================
const flashData = [
  { cat:'GERAL', q:'Qual o n√∫mero e ano do conv√™nio estudado?', a:'Conv√™nio N¬∫ 001/2026, firmado entre a Defensoria P√∫blica do Estado de S√£o Paulo e a OAB-SP.' },
  { cat:'GERAL', q:'Qual a vig√™ncia do Conv√™nio 001/2026?', a:'15 meses a partir de 1¬∫ de maio de 2026, prorrog√°veis por iguais per√≠odos.' },
  { cat:'GERAL', q:'Qual o valor total estimado do conv√™nio?', a:'R$ 250.000.000,00 (duzentos e cinquenta milh√µes de reais).' },
  { cat:'GERAL', q:'Quem representa a Defensoria no conv√™nio?', a:'Defensora P√∫blica-Geral Doutora Luciana Jord√£o da Motta Armiliato de Carvalho.' },
  { cat:'GERAL', q:'Quem representa a OAB/SP no conv√™nio?', a:'O Presidente Doutor Leonardo Sica.' },
  { cat:'C√çVEL', q:'Qual o prazo m√°ximo para propositura de a√ß√£o c√≠vel ap√≥s receber a documenta√ß√£o?', a:'30 dias para o ajuizamento, contados a partir do recebimento da documenta√ß√£o necess√°ria.' },
  { cat:'C√çVEL', q:'Qual o prazo para o advogado receber a documenta√ß√£o ap√≥s a nomea√ß√£o?', a:'6 meses contados da nomea√ß√£o. Findo este prazo, o advogado deve recusar a nomea√ß√£o pois perder√° a validade.' },
  { cat:'C√çVEL', q:'Quantos advogados s√£o nomeados para separa√ß√£o/div√≥rcio consensual?', a:'Apenas um advogado para representar ambas as partes.' },
  { cat:'C√çVEL', q:'O que √© o ¬ß8¬∫ da Cl√°usula 15 sobre execu√ß√£o de alimentos?', a:'N√£o ser√° permitida indica√ß√£o de novo advogado para cumprimento de senten√ßa de alimentos em tempo inferior a 60 dias do pagamento integral ou suspens√£o do processo.' },
  { cat:'CRIMINAL', q:'Quando √© feita a indica√ß√£o de advogado em processo criminal?', a:'Para audi√™ncia de cust√≥dia (se houver); ap√≥s proposta de ANPP; ou ap√≥s cita√ß√£o v√°lida do acusado.' },
  { cat:'CRIMINAL', q:'O advogado nomeado desde a audi√™ncia de cust√≥dia deve fazer o qu√™?', a:'Ser respons√°vel por TODOS os atos do processo, inclusive eventual ANPP.' },
  { cat:'CRIMINAL', q:'No plant√£o duplo de dias n√£o √∫teis, quando s√£o devidos honor√°rios?', a:'Somente se o advogado participar DOS DOIS DIAS n√£o √∫teis consecutivos. √â vedado pagamento parcial.' },
  { cat:'CRIMINAL', q:'Em quais hip√≥teses √© permitida a atua√ß√£o em execu√ß√£o penal?', a:'Apenas em regime aberto, livramento condicional, sursis (suspens√£o condicional) e penas restritivas de direitos.' },
  { cat:'CRIMINAL', q:'O advogado pode atuar em revis√£o criminal pelo conv√™nio?', a:'N√ÉO. √â vedada a indica√ß√£o, nomea√ß√£o, atua√ß√£o e recebimento de honor√°rios para revis√£o criminal.' },
  { cat:'HONOR√ÅRIOS', q:'Certid√£o de honor√°rios deve ser apresentada em qual prazo?', a:'Em at√© 1 ano da data de sua expedi√ß√£o, sob pena de ser adimplida somente no exerc√≠cio financeiro seguinte.' },
  { cat:'HONOR√ÅRIOS', q:'Qual o prazo prescricional total para certid√µes de honor√°rios?', a:'5 anos, contados do tr√¢nsito em julgado ou da ocorr√™ncia do fato gerador.' },
  { cat:'HONOR√ÅRIOS', q:'Se o usu√°rio constituir advogado particular, quanto recebe o conveniado?', a:'30% do valor da tabela, desde que tenha atuado no processo.' },
  { cat:'HONOR√ÅRIOS', q:'Quanto recebe o advogado por atua√ß√£o parcial ap√≥s senten√ßa (fase recursal)?', a:'30% do valor da tabela.' },
  { cat:'HONOR√ÅRIOS', q:'Em senten√ßa condenat√≥ria criminal, como s√£o pagos os honor√°rios?', a:'70% ap√≥s a senten√ßa + 30% restantes ap√≥s tr√¢nsito em julgado do ac√≥rd√£o.' },
  { cat:'HONOR√ÅRIOS', q:'Em processo c√≠vel com proced√™ncia total, sem recurso, quanto recebe?', a:'100% do valor previsto na tabela, quando certificado o tr√¢nsito em julgado.' },
  { cat:'HONOR√ÅRIOS', q:'Em caso de acordo com dois advogados (um por parte), qual o percentual?', a:'70% na homologa√ß√£o do acordo.' },
  { cat:'HONOR√ÅRIOS', q:'Em caso de acordo com √∫nico advogado para duas partes, qual o percentual?', a:'100% quando da homologa√ß√£o do acordo.' },
  { cat:'HONOR√ÅRIOS', q:'O que ocorre se o Ju√≠zo arbitrar honor√°rios em valor diferente da tabela?', a:'N√£o ser√£o pagos honor√°rios em desacordo com a tabela, mesmo que o Ju√≠zo fixe valor distinto.' },
  { cat:'HONOR√ÅRIOS', q:'Quando h√° certid√£o parcial antecipada de 30%?', a:'Em suspens√£o de alimentos, execu√ß√µes fiscais (acordo parcelamento/arquivamento), embargos procedentes ou cita√ß√£o por edital.' },
  { cat:'PRAZOS', q:'At√© que dia as certid√µes devem ser enviadas pela OAB/SP √† Defensoria?', a:'At√© o dia 25 de cada m√™s, para pagamento no 1¬∫ dia √∫til do segundo m√™s subsequente ao do protocolo.' },
  { cat:'PRAZOS', q:'Qual o prazo de vig√™ncia anual das inscri√ß√µes?', a:'A inscri√ß√£o tem vig√™ncia anual, devendo ser renovada quando da publica√ß√£o de novo edital.' },
  { cat:'PRAZOS', q:'Quanto tempo antes do quiz pode pedir recusa de plant√£o?', a:'A recusa do plant√£o deve ser feita com, no m√≠nimo, 3 dias de anteced√™ncia via M√≥dulo de Indica√ß√£o.' },
  { cat:'PRAZOS', q:'Em quantos dias a Defensoria deve julgar pedidos de ren√∫ncia?', a:'Sempre que poss√≠vel, no prazo de 5 dias √∫teis.' },
  { cat:'PRAZOS', q:'O advogado pode ausentar-se por quantos dias no ano sem perder indica√ß√µes?', a:'60 dias por ano, permitido o gozo em dois per√≠odos de 30 dias.' },
  { cat:'PRAZOS', q:'Qual o prazo para defesa administrativa no procedimento COMISTA?', a:'10 dias √∫teis, improrrog√°veis.' },
  { cat:'PRAZOS', q:'Qual o prazo de prescri√ß√£o por infra√ß√£o aos termos do conv√™nio?', a:'5 anos da data do conhecimento do fato pelo Coordenador Regional ou Presidente da Subse√ß√£o.' },
  { cat:'PRAZOS', q:'Quantos dias de anteced√™ncia deve ter a publica√ß√£o do edital?', a:'M√≠nimo de 10 dias antes da data de in√≠cio das inscri√ß√µes.' },
  { cat:'INSCRI√á√ÉO', q:'Quantas vezes ao ano a Defensoria abre inscri√ß√µes?', a:'Ao menos uma vez ao ano, por per√≠odo n√£o inferior a 15 dias.' },
  { cat:'INSCRI√á√ÉO', q:'Qual e-mail √© obrigat√≥rio para o advogado conveniado?', a:'E-mail fornecido pela OAB-SP com extens√£o @adv.oabsp.org.br.' },
  { cat:'INSCRI√á√ÉO', q:'Pode o advogado se inscrever como PF e como Sociedade Individual simultaneamente?', a:'N√ÉO. √â vedada a participa√ß√£o simult√¢nea em ambas as qualifica√ß√µes.' },
  { cat:'INSCRI√á√ÉO', q:'Requisito para inscri√ß√£o no Tribunal do J√∫ri?', a:'Comprovar atua√ß√£o em 4 sess√µes plen√°rias do Tribunal do J√∫ri, ou 1 sess√£o plen√°ria + conclus√£o de curso espec√≠fico.' },
  { cat:'INSCRI√á√ÉO', q:'Quem ministra os cursos para J√∫ri, VD e IJ?', a:'Em conjunto pela EDEPE (Escola da Defensoria) e pela Escola Superior da Advocacia da OAB/SP.' },
  { cat:'INSCRI√á√ÉO', q:'Qual o prazo de inscri√ß√£o para o edital?', a:'Por per√≠odo n√£o inferior a 15 dias √∫teis.' },
  { cat:'SAN√á√ïES', q:'Quais s√£o as 4 penalidades administrativas do conv√™nio?', a:'(1) Advert√™ncia; (2) Suspens√£o (m√°x. 18 meses); (3) Exclus√£o de √°rea de atua√ß√£o; (4) Descredenciamento.' },
  { cat:'SAN√á√ïES', q:'Quando √© aplicada a penalidade de descredenciamento obrigat√≥rio?', a:'Quando o advogado cobrar do usu√°rio, captar clientes, incorrer em erro grave ou praticar ato de suspens√£o j√° tendo sido suspenso duas vezes.' },
  { cat:'SAN√á√ïES', q:'Ap√≥s descredenciamento, quando pode pedir nova inscri√ß√£o?', a:'Ap√≥s 2 anos contados da ci√™ncia da decis√£o da Comiss√£o Mista.' },
  { cat:'SAN√á√ïES', q:'Qual o prazo m√°ximo de suspens√£o tempor√°ria?', a:'Prazo m√°ximo de 18 meses de suspens√£o.' },
  { cat:'SAN√á√ïES', q:'Por quanto tempo se aplica a exclus√£o de √°rea de atua√ß√£o?', a:'24 meses, podendo ser cumulada com advert√™ncia ou suspens√£o.' },
  { cat:'SAN√á√ïES', q:'Das decis√µes da C√¢mara Recursal cabe recurso?', a:'N√ÉO. Das decis√µes da C√¢mara Recursal n√£o cabe recurso.' },
  { cat:'SAN√á√ïES', q:'Aplicada san√ß√£o de suspens√£o, o advogado recebe honor√°rios?', a:'N√ÉO. N√£o far√° jus a quaisquer honor√°rios nos processos relacionados √† causa da san√ß√£o. Se j√° recebeu, deve devolver.' },
  { cat:'GERAL', q:'O conv√™nio cobre √°rea trabalhista?', a:'N√ÉO. Exclu√≠das as √°reas eleitoral, administrativa, trabalhista e previdenci√°ria.' },
  { cat:'GERAL', q:'√â permitido substabelecimento pelo conveniado?', a:'Sim, uma √∫nica vez em cada feito, para um √∫nico ato de audi√™ncia, a outro advogado conveniado (sem honor√°rios para o substabelecido).' },
  { cat:'GERAL', q:'O que √© a C√¢mara Parit√°ria de Julgamento (COMISTA)?', a:'Composta por 2 Defensores P√∫blicos + 2 advogados indicados pela OAB/SP, respons√°vel por julgar as infra√ß√µes ao conv√™nio em primeira inst√¢ncia.' },
  { cat:'GERAL', q:'Qual o foro para dirimir pend√™ncias do conv√™nio?', a:'Comarca da Capital do Estado de S√£o Paulo.' },
  { cat:'GERAL', q:'O pagamento de honor√°rios gera v√≠nculo empregat√≠cio com o Estado?', a:'N√ÉO. O pagamento n√£o implica v√≠nculo empregat√≠cio com o Estado nem direitos assegurados a servidores p√∫blicos.' },
];

// ============================================================
//  RENDER FLASHCARDS
// ============================================================
let flippedCount = 0;
let masterScores = {};

// Sound effects
const audioCtx = window.AudioContext ? new AudioContext() : null;
function playSound(type) {
  if (!audioCtx) return;
  const osc = audioCtx.createOscillator();
  const gain = audioCtx.createGain();
  osc.connect(gain); gain.connect(audioCtx.destination);
  if (type === 'flip') {
    osc.frequency.setValueAtTime(440, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(880, audioCtx.currentTime + 0.1);
    gain.gain.setValueAtTime(0.1, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.15);
    osc.start(); osc.stop(audioCtx.currentTime + 0.15);
  } else if (type === 'fav') {
    osc.frequency.setValueAtTime(660, audioCtx.currentTime);
    osc.frequency.setValueAtTime(880, audioCtx.currentTime + 0.08);
    gain.gain.setValueAtTime(0.12, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.2);
    osc.start(); osc.stop(audioCtx.currentTime + 0.2);
  } else if (type === 'correct') {
    osc.type = 'sine';
    osc.frequency.setValueAtTime(523, audioCtx.currentTime);
    osc.frequency.setValueAtTime(659, audioCtx.currentTime + 0.1);
    osc.frequency.setValueAtTime(784, audioCtx.currentTime + 0.2);
    gain.gain.setValueAtTime(0.15, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.35);
    osc.start(); osc.stop(audioCtx.currentTime + 0.35);
  } else if (type === 'wrong') {
    osc.type = 'sawtooth';
    osc.frequency.setValueAtTime(300, audioCtx.currentTime);
    osc.frequency.exponentialRampToValueAtTime(150, audioCtx.currentTime + 0.2);
    gain.gain.setValueAtTime(0.12, audioCtx.currentTime);
    gain.gain.exponentialRampToValueAtTime(0.001, audioCtx.currentTime + 0.25);
    osc.start(); osc.stop(audioCtx.currentTime + 0.25);
  }
}

// Favorites
const favorites = new Set(JSON.parse(localStorage.getItem('dpe_fc_favs') || '[]'));

function toggleFav(e, idx) {
  e.stopPropagation();
  if (favorites.has(idx)) favorites.delete(idx);
  else favorites.add(idx);
  localStorage.setItem('dpe_fc_favs', JSON.stringify([...favorites]));
  document.getElementById('fc-favs').textContent = favorites.size;
  playSound('fav');
  renderFlashcards(currentFilter);
}

function renderFlashcards(filter) {
  const container = document.getElementById('flashContainer');
  container.innerHTML = '';
  let filtered;
  if (filter === 'FAV') {
    filtered = flashData.filter((d, i) => favorites.has(i));
  } else {
    filtered = filter === 'all' ? flashData : flashData.filter(d => d.cat === filter);
  }
  
  if (filtered.length === 0) {
    container.innerHTML = '<div style="color:var(--text-muted);text-align:center;padding:40px;grid-column:1/-1;">Nenhum card encontrado nesta categoria.</div>';
    return;
  }
  
  filtered.forEach((item, i) => {
    const idx = flashData.indexOf(item);
    const stars = masterScores[idx] || 0;
    const isFav = favorites.has(idx);
    const el = document.createElement('div');
    el.className = 'flashcard'; el.dataset.idx = idx; el.dataset.cat = item.cat;
    el.innerHTML = `<div class="fc-inner">
      <div class="fc-front">
        <button class="fc-fav-btn" onclick="toggleFav(event,${idx})" title="${isFav?'Remover dos favoritos':'Adicionar aos favoritos'}">${isFav?'‚ù§Ô∏è':'ü§ç'}</button>
        <div><div class="fc-cat">${item.cat}</div>
        <div class="fc-question">${item.q}</div></div>
        <div class="fc-stars">${[0,1,2].map(s=>`<span class="fc-star ${stars>s?'lit':''}" data-i="${idx}" data-s="${s+1}" onclick="rateStar(event,${idx},${s+1})">‚òÖ</span>`).join('')}</div>
      </div>
      <div class="fc-back">
        <div><div class="fc-cat">${item.cat}</div>
        <div class="fc-answer">${item.a}</div></div>
        <div class="fc-hint">Clique para voltar ‚Ü©</div>
      </div></div>`;
    el.onclick = (e) => {
      if (e.target.classList.contains('fc-star') || e.target.classList.contains('fc-fav-btn')) return;
      const wasFlipped = el.classList.contains('flipped');
      el.classList.toggle('flipped');
      playSound('flip');
      if (!wasFlipped) {
        flippedCount++;
        document.getElementById('fc-flipped').textContent = flippedCount;
      }
    };
    container.appendChild(el);
  });
}

function rateStar(e, idx, stars) {
  e.stopPropagation();
  masterScores[idx] = stars;
  if (stars === 3) {
    const dominated = Object.values(masterScores).filter(v=>v===3).length;
    document.getElementById('fc-mastered').textContent = dominated;
  }
  renderFlashcards(currentFilter);
}

let currentFilter = 'all';
function filterCards(cat, btn) {
  currentFilter = cat;
  document.querySelectorAll('.cat-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  renderFlashcards(cat);
}

renderFlashcards('all');

// ============================================================
//  50 RULES
// ============================================================
const rules = [
  { num:'REGRA 01', area:'OBJETO', title:'Assist√™ncia Suplementar Gratuita', text:'O conv√™nio tem por objeto a presta√ß√£o de assist√™ncia judici√°ria gratuita suplementar √† popula√ß√£o economicamente hipossuficiente do Estado de S√£o Paulo, pela advocacia dativa.' },
  { num:'REGRA 02', area:'VIG√äNCIA', title:'In√≠cio e Dura√ß√£o', text:'15 meses a partir de 1¬∫ de maio de 2026, prorrog√°veis por iguais per√≠odos mediante termo aditivo. Den√∫ncia com 90 dias de anteced√™ncia.' },
  { num:'REGRA 03', area:'√ÅREAS', title:'√Åreas Abrangidas', text:'C√≠vel, Fam√≠lia e Sucess√µes, Criminal, Inf√¢ncia e Juventude, Atividades Especiais (cartas precat√≥rias e plant√µes).' },
  { num:'REGRA 04', area:'EXCLUS√ïES', title:'√Åreas Exclu√≠das', text:'Eleitoral, administrativa, trabalhista e previdenci√°ria ‚Äî mesmo nos casos de compet√™ncia delegada √† Justi√ßa Estadual.' },
  { num:'REGRA 05', area:'EXCLUS√ïES', title:'Veda√ß√µes Espec√≠ficas', text:'Vedada indica√ß√£o para: revis√£o criminal, defesa de pessoa jur√≠dica (exceto curadoria especial) e defesa de v√≠tima na √°rea criminal (exceto a√ß√£o penal privada).' },
  { num:'REGRA 06', area:'ATENDIMENTO', title:'Atendimento Inicial pela OAB/SP', text:'Enquanto o sistema informatizado da Defensoria n√£o estiver em pleno funcionamento, a OAB/SP presta atendimento inicial nas Subse√ß√µes: avalia√ß√£o econ√¥mico-financeira e an√°lise jur√≠dica.' },
  { num:'REGRA 07', area:'HONOR√ÅRIOS', title:'Pagamento das Certid√µes', text:'Certid√µes devem ser protocolizadas pela OAB/SP √† Defensoria at√© o dia 25 de cada m√™s. Pagamento no 1¬∫ dia √∫til do segundo m√™s subsequente ao do protocolo.' },
  { num:'REGRA 08', area:'HONOR√ÅRIOS', title:'Prazo para Protocolo de Certid√£o', text:'A certid√£o de honor√°rios deve ser aceita/protocolizada em at√© 1 ano de sua expedi√ß√£o. Prazo prescricional total: 5 anos.' },
  { num:'REGRA 09', area:'HONOR√ÅRIOS', title:'Reajuste Anual', text:'Os honor√°rios t√™m seus valores ajustados anualmente pelo √≠ndice IPC/FIPE, com data-base no in√≠cio da vig√™ncia do termo.' },
  { num:'REGRA 10', area:'HONOR√ÅRIOS', title:'Sem V√≠nculo Empregat√≠cio', text:'O pagamento de honor√°rios n√£o implica v√≠nculo empregat√≠cio com o Estado, n√£o conferindo ao advogado quaisquer direitos assegurados a servidores p√∫blicos.' },
  { num:'REGRA 11', area:'C√çVEL', title:'Prazo para Ajuizamento', text:'30 dias para o ajuizamento, contados do recebimento da documenta√ß√£o necess√°ria. 6 meses para coleta da documenta√ß√£o, contados da nomea√ß√£o.' },
  { num:'REGRA 12', area:'C√çVEL', title:'Cumula√ß√£o de Pedidos', text:'Para a√ß√µes onde haja cumula√ß√£o de pedidos, o advogado recebe uma √∫nica nomea√ß√£o, obrigando-se a concentrar todos os pleitos em um √∫nico processo.' },
  { num:'REGRA 13', area:'C√çVEL', title:'Div√≥rcio/Separa√ß√£o Consensual', text:'Ser√° indicado apenas um advogado para representar ambas as partes em separa√ß√£o e div√≥rcio consensuais.' },
  { num:'REGRA 14', area:'C√çVEL', title:'Cumprimento de Senten√ßa de Alimentos', text:'Vedada nova indica√ß√£o para cumprimento de senten√ßa de alimentos em prazo inferior a 60 dias do pagamento integral ou da suspens√£o.' },
  { num:'REGRA 15', area:'C√çVEL', title:'Atua√ß√£o at√© o Tr√¢nsito em Julgado', text:'O advogado deve acompanhar o cumprimento de senten√ßa iniciado em at√© 12 meses do tr√¢nsito em julgado, sem direito a nova certid√£o de honor√°rios.' },
  { num:'REGRA 16', area:'CRIMINAL', title:'Momento da Indica√ß√£o Criminal', text:'Para audi√™ncia de cust√≥dia; ou ap√≥s proposta de ANPP; ou ap√≥s cita√ß√£o v√°lida do acusado.' },
  { num:'REGRA 17', area:'CRIMINAL', title:'Responsabilidade Total no Criminal', text:'O advogado nomeado desde a audi√™ncia de cust√≥dia √© respons√°vel por TODOS os atos do processo, inclusive o ANPP.' },
  { num:'REGRA 18', area:'CRIMINAL', title:'R√©u Preso: Obriga√ß√£o de HC', text:'Recebida indica√ß√£o para r√©u preso, o advogado deve adotar TODAS as medidas para obten√ß√£o da liberdade. N√£o podem ser expedidas novas indica√ß√µes para HC necess√°rio.' },
  { num:'REGRA 19', area:'CRIMINAL', title:'Multa no Ju√≠zo do Conhecimento', text:'O advogado √© respons√°vel pela manifesta√ß√£o sobre a multa perante o Ju√≠zo do Conhecimento, antes do envio ao Ju√≠zo de Execu√ß√µes Criminais.' },
  { num:'REGRA 20', area:'CRIMINAL', title:'Execu√ß√£o Penal: Hip√≥teses', text:'Atua√ß√£o na execu√ß√£o penal limitada a: regime aberto, livramento condicional, sursis e penas restritivas de direitos.' },
  { num:'REGRA 21', area:'J√öRI', title:'Requisito para Atua√ß√£o no J√∫ri', text:'Comprovar ter atuado em 4 sess√µes plen√°rias, ou em 1 sess√£o plen√°ria cumulada com conclus√£o de curso espec√≠fico.' },
  { num:'REGRA 22', area:'J√öRI', title:'Continuidade da Nomea√ß√£o no J√∫ri', text:'A nomea√ß√£o para a 1¬™ fase (at√© a pron√∫ncia) permanece v√°lida para a 2¬™ fase (plen√°rio) e eventual segundo plen√°rio.' },
  { num:'REGRA 23', area:'J√öRI', title:'Segundo J√∫ri: 60%', text:'Em caso de realiza√ß√£o de segundo J√∫ri, o advogado faz jus a 60% dos honor√°rios previstos na tabela.' },
  { num:'REGRA 24', area:'VD', title:'Medida Protetiva ‚Äì Vincula√ß√£o 12 Meses', text:'Advogado nomeado para medida protetiva em favor de v√≠tima fica vinculado √†s demandas correlatas por 12 meses, contados da primeira decis√£o.' },
  { num:'REGRA 25', area:'IJ', title:'Inf√¢ncia e Juventude: Sem Indica√ß√£o', text:'N√ÉO haver√° indica√ß√£o para: oitiva informal perante o MP e remiss√£o simples desacompanhada de medida socioeducativa.' },
  { num:'REGRA 26', area:'IJ', title:'Medida Socioeducativa: Sem Nova Certid√£o', text:'O advogado que atuou na apura√ß√£o de ato infracional permanece respons√°vel pela execu√ß√£o da medida socioeducativa aplicada, sem direito a nova certid√£o.' },
  { num:'REGRA 27', area:'PLANT√ïES', title:'Plant√£o Duplo: Dias N√£o √öteis', text:'Em dois dias n√£o √∫teis consecutivos, o plant√£o deve ser duplo. Honor√°rios somente devidos se o advogado participar dos DOIS dias. Proibido pagamento parcial.' },
  { num:'REGRA 28', area:'PLANT√ïES', title:'JEC: Limite de Valor', text:'Vedada indica√ß√£o de advogado conveniado para atua√ß√£o em processos cujo valor n√£o exceda 20 sal√°rios m√≠nimos, salvo necess√°ria interposi√ß√£o de recurso.' },
  { num:'REGRA 29', area:'RECUSA', title:'Recusa da Indica√ß√£o', text:'RECUSA: ato do advogado que rejeita a indica√ß√£o antes da ado√ß√£o da medida judicial e previamente ao aceite no M√≥dulo de Indica√ß√£o (MI). Deve ser feita exclusivamente via MI.' },
  { num:'REGRA 30', area:'RECUSA', title:'Recusa de Plant√£o', text:'A recusa do plant√£o deve ser feita via MI com no m√≠nimo 3 dias de anteced√™ncia. Deferido ou n√£o, o advogado N√ÉO deve comparecer ao plant√£o.' },
  { num:'REGRA 31', area:'RECUSA', title:'Ren√∫ncia Autorizada', text:'Pedidos de REN√öNCIA s√£o avaliados pela Defensoria, sempre que poss√≠vel em 5 dias √∫teis. Ap√≥s autoriza√ß√£o, o advogado comunica o usu√°rio e formaliza judicialmente.' },
  { num:'REGRA 32', area:'INSCRI√á√ÉO', title:'Frequ√™ncia das Inscri√ß√µes', text:'A Defensoria abrir√° inscri√ß√µes ao menos uma vez ao ano, por per√≠odo n√£o inferior a 15 dias, com edital publicado com anteced√™ncia m√≠nima de 10 dias.' },
  { num:'REGRA 33', area:'INSCRI√á√ÉO', title:'Vig√™ncia Anual', text:'A inscri√ß√£o tem vig√™ncia anual e deve ser renovada quando da publica√ß√£o de novo edital.' },
  { num:'REGRA 34', area:'INSCRI√á√ÉO', title:'Sem Dupla Inscri√ß√£o', text:'√â vedada a participa√ß√£o no conv√™nio como PF e como Sociedade Individual simultaneamente.' },
  { num:'REGRA 35', area:'INSCRI√á√ÉO', title:'E-mail Obrigat√≥rio', text:'O advogado deve manter endere√ßo de e-mail com extens√£o @adv.oabsp.org.br para todas as comunica√ß√µes do conv√™nio.' },
  { num:'REGRA 36', area:'INSCRI√á√ÉO', title:'Cursos para VD e IJ', text:'Para inscri√ß√£o em medidas protetivas aut√¥nomas de VD e em Inf√¢ncia e Juventude: comprova√ß√£o de conclus√£o de curso espec√≠fico ministrado pela EDEPE e Escola Superior da Advocacia OAB/SP.' },
  { num:'REGRA 37', area:'HONOR√ÅRIOS', title:'Senten√ßa Absolut√≥ria Criminal: 100%', text:'Senten√ßa absolut√≥ria sem recurso: 100% com tr√¢nsito em julgado. Com recurso: 70% ap√≥s senten√ßa + 30% ap√≥s tr√¢nsito em julgado do ac√≥rd√£o.' },
  { num:'REGRA 38', area:'HONOR√ÅRIOS', title:'Sursis Processual (art. 89)', text:'30% ap√≥s suspens√£o do processo + 70% ap√≥s cumprimento do per√≠odo de prova com tr√¢nsito em julgado da extin√ß√£o da punibilidade.' },
  { num:'REGRA 39', area:'HONOR√ÅRIOS', title:'Extin√ß√£o Sem M√©rito (art. 485 CPC)', text:'Incisos I e VII: sem honor√°rios. Incisos II e III: 70% para ambos (autor comprova intima√ß√£o). IV, V, VI, X: 70% exclusivamente ao advogado do r√©u.' },
  { num:'REGRA 40', area:'HONOR√ÅRIOS', title:'Atua√ß√£o Parcial: 60%', text:'Advogado nomeado para dar continuidade ao processo j√° em andamento, at√© a senten√ßa e/ou tr√¢nsito em julgado: 60% do valor da tabela.' },
  { num:'REGRA 41', area:'SAN√á√ïES', title:'4 Penalidades Administrativas', text:'(1) Advert√™ncia; (2) Suspens√£o m√°x. 18 meses; (3) Exclus√£o de √°rea 24 meses; (4) Descredenciamento.' },
  { num:'REGRA 42', area:'SAN√á√ïES', title:'Descredenciamento Obrigat√≥rio', text:'Cobran√ßa ao usu√°rio, capta√ß√£o de clientes, erro grave e terceira infra√ß√£o pass√≠vel de suspens√£o geram descredenciamento obrigat√≥rio mesmo na primeira viola√ß√£o.' },
  { num:'REGRA 43', area:'SAN√á√ïES', title:'Nova Inscri√ß√£o Ap√≥s Descredenciamento', text:'Somente ap√≥s 2 anos contados da ci√™ncia da decis√£o da Comiss√£o Mista. Para erro grave: nova inscri√ß√£o condicionada √† aprova√ß√£o pela Comiss√£o Recursal Parit√°ria.' },
  { num:'REGRA 44', area:'SAN√á√ïES', title:'Suspens√£o Cautelar', text:'Aplicada ao advogado que n√£o mant√©m dados cadastrais atualizados ou cuja manuten√ß√£o cause preju√≠zo aos usu√°rios. Revogada quando cessada a causa.' },
  { num:'REGRA 45', area:'SAN√á√ïES', title:'Prescri√ß√£o de Infra√ß√£o', text:'Punibilidade por infra√ß√£o prescreve em 5 anos do conhecimento do fato. Execu√ß√£o da pena prescreve em 5 anos da decis√£o. Interrup√ß√£o apenas uma vez.' },
  { num:'REGRA 46', area:'SAN√á√ïES', title:'C√¢mara Parit√°ria: Composi√ß√£o', text:'2 Defensores P√∫blicos + 2 advogados OAB/SP. C√¢mara Recursal: 4 DPs + 5 advogados + Defensor Assessor de Conv√™nios. Das decis√µes recursais N√ÉO cabe recurso.' },
  { num:'REGRA 47', area:'SAN√á√ïES', title:'Sustenta√ß√£o Oral: 5 Minutos', text:'O advogado sindicado pode fazer sustenta√ß√£o oral por 5 minutos improrrog√°veis, comunicando inten√ß√£o em at√© 3 dias √∫teis antes da sess√£o.' },
  { num:'REGRA 48', area:'GERAL', title:'Substabelecimento Restrito', text:'Permitido substabelecer apenas uma vez em cada feito, para √∫nico ato de audi√™ncia, a outro advogado conveniado, sem direito a honor√°rios para o substabelecido.' },
  { num:'REGRA 49', area:'GERAL', title:'Gratuidade Total', text:'A presta√ß√£o de assist√™ncia judici√°ria ao usu√°rio √© TOTALMENTE GRATUITA. Qualquer cobran√ßa sujeita a DESCREDENCIAMENTO e responsabilidade penal, civil e administrativa.' },
  { num:'REGRA 50', area:'GERAL', title:'Continuidade dos Processos', text:'O advogado deve acompanhar TODOS os feitos at√© o tr√¢nsito em julgado, independentemente de cancelamento de inscri√ß√£o, den√∫ncia ou rescis√£o do conv√™nio.' },
];

const rulesContainer = document.getElementById('rulesContainer');
rules.forEach(r => {
  const el = document.createElement('div');
  el.className = 'rule-card';
  el.innerHTML = `<div class="rule-num">${r.num}</div>
    <div class="rule-title">${r.title}</div>
    <div class="rule-text">${r.text}</div>
    <span class="rule-tag">${r.area}</span>`;
  rulesContainer.appendChild(el);
});

// ============================================================
//  QUIZ DATA (50 questions)
// ============================================================
const quizData = [
  { cat:'OBJETO', q:'Qual √© o objeto do Conv√™nio 001/2026?', opts:['Presta√ß√£o de assist√™ncia jur√≠dica trabalhista','Presta√ß√£o de assist√™ncia judici√°ria gratuita suplementar √† popula√ß√£o hipossuficiente','Conv√™nio de parceria administrativa entre DPE e OAB','Presta√ß√£o de servi√ßos advocat√≠cios remunerados'], correct:1, exp:'O objeto √© a presta√ß√£o de assist√™ncia judici√°ria gratuita SUPLEMENTAR pela advocacia dativa √† popula√ß√£o economicamente hipossuficiente do Estado de S√£o Paulo.' },
  { cat:'VIG√äNCIA', q:'Qual a vig√™ncia do Conv√™nio 001/2026?', opts:['12 meses a partir de 1¬∫ de janeiro de 2026','24 meses a partir da assinatura','15 meses a partir de 1¬∫ de maio de 2026','10 meses prorrog√°veis'], correct:2, exp:'15 meses a partir de 1¬∫ de maio de 2026, podendo ser prorrogado por iguais per√≠odos mediante termo aditivo.' },
  { cat:'VIG√äNCIA', q:'Qual o prazo de anteced√™ncia m√≠nima para den√∫ncia do conv√™nio?', opts:['30 dias','60 dias','90 dias','120 dias'], correct:2, exp:'O conv√™nio pode ser denunciado com anteced√™ncia m√≠nima de 90 dias, sem qualquer √¥nus √†s convenentes.' },
  { cat:'VALOR', q:'Qual o valor total estimado do Conv√™nio 001/2026?', opts:['R$ 100 milh√µes','R$ 150 milh√µes','R$ 200 milh√µes','R$ 250 milh√µes'], correct:3, exp:'O valor total estimado √© de R$ 250.000.000,00 (duzentos e cinquenta milh√µes de reais).' },
  { cat:'√ÅREAS', q:'Qual √°rea N√ÉO est√° abrangida pelo conv√™nio?', opts:['√Årea criminal','Fam√≠lia e Sucess√µes','√Årea trabalhista','Inf√¢ncia e Juventude'], correct:2, exp:'S√£o exclu√≠das as √°reas eleitoral, administrativa, TRABALHISTA e previdenci√°ria, mesmo nos casos de compet√™ncia delegada √† Justi√ßa Estadual.' },
  { cat:'√ÅREAS', q:'A atua√ß√£o em execu√ß√£o penal pelo conv√™nio √©:', opts:['Ilimitada para qualquer tipo de execu√ß√£o','Restrita ao DEECRIM','Permitida apenas em regime aberto, livramento condicional, sursis e penas restritivas','Apenas para crimes hediondos'], correct:2, exp:'A atua√ß√£o em execu√ß√£o penal limita-se √†s hip√≥teses excepcionais previstas na Res. 749/2016 do TJ-SP: regime aberto, livramento condicional, sursis e penas restritivas.' },
  { cat:'C√çVEL', q:'Qual o prazo m√°ximo para propositura de a√ß√£o c√≠vel ap√≥s receber os documentos?', opts:['15 dias','30 dias','45 dias','60 dias'], correct:1, exp:'O advogado tem 30 dias para o ajuizamento, contados a partir do recebimento da documenta√ß√£o necess√°ria.' },
  { cat:'C√çVEL', q:'Em separa√ß√£o e div√≥rcio CONSENSUAL, quantos advogados s√£o indicados?', opts:['Um para cada parte','Apenas um para ambas as partes','Dois obrigatoriamente','Depende da decis√£o do juiz'], correct:1, exp:'Nas a√ß√µes de separa√ß√£o e div√≥rcio consensuais, ser√° indicado apenas UM advogado para representar AMBAS as partes.' },
  { cat:'C√çVEL', q:'Qual o prazo m√°ximo para o advogado c√≠vel receber a documenta√ß√£o ap√≥s a nomea√ß√£o?', opts:['30 dias','3 meses','6 meses','1 ano'], correct:2, exp:'O advogado tem 6 meses para o recebimento da documenta√ß√£o necess√°ria, contados da nomea√ß√£o. Findo este prazo, o advogado deve recusar a nomea√ß√£o.' },
  { cat:'CRIMINAL', q:'Quando √© feita a indica√ß√£o de advogado em processo criminal?', opts:['Apenas ap√≥s a pron√∫ncia','Para a audi√™ncia de cust√≥dia (se houver) ou ap√≥s proposta de ANPP ou ap√≥s cita√ß√£o v√°lida do acusado','Somente ap√≥s o oferecimento da den√∫ncia','Apenas em casos de r√©u preso'], correct:1, exp:'A indica√ß√£o √© feita: para audi√™ncia de cust√≥dia se houver; ou ap√≥s proposta/inten√ß√£o de ANPP; ou ap√≥s cita√ß√£o v√°lida do acusado.' },
  { cat:'CRIMINAL', q:'O advogado nomeado desde a audi√™ncia de cust√≥dia √© respons√°vel por:', opts:['Apenas o ato da audi√™ncia de cust√≥dia','Todos os atos do processo, inclusive eventual ANPP','Apenas at√© a pron√∫ncia','Os atos at√© a senten√ßa de 1¬™ inst√¢ncia'], correct:1, exp:'O advogado nomeado desde a audi√™ncia de cust√≥dia ser√° respons√°vel por TODOS os atos do processo, inclusive a realiza√ß√£o de eventual ANPP.' },
  { cat:'CRIMINAL', q:'No plant√£o duplo de dias n√£o √∫teis consecutivos, como s√£o devidos os honor√°rios?', opts:['50% por dia comparecido','Honor√°rios somente devidos se o advogado participar dos DOIS dias','Pode-se pagar honor√°rios parciais se comparecer apenas em um dia','30% por aus√™ncia justificada'], correct:1, exp:'No plant√£o duplo, os honor√°rios s√≥ s√£o devidos se o advogado participar dos DOIS dias n√£o √∫teis consecutivos. √â vedado o pagamento de honor√°rios parciais.' },
  { cat:'J√öRI', q:'Qual o requisito para inscri√ß√£o para atua√ß√£o no Tribunal do J√∫ri?', opts:['Apenas 2 sess√µes plen√°rias','4 sess√µes plen√°rias OU 1 sess√£o + conclus√£o de curso espec√≠fico','10 anos de experi√™ncia criminal','Apenas aprova√ß√£o em curso espec√≠fico da OAB'], correct:1, exp:'Comprova√ß√£o de atua√ß√£o em 4 sess√µes plen√°rias do Tribunal do J√∫ri, ou de 1 sess√£o plen√°ria cumulada com a conclus√£o de curso espec√≠fico.' },
  { cat:'J√öRI', q:'Qual o percentual de honor√°rios em caso de realiza√ß√£o de SEGUNDO J√∫ri?', opts:['100%','70%','60%','30%'], correct:2, exp:'Em caso de realiza√ß√£o de um segundo J√∫ri, o advogado faz jus a 60% dos honor√°rios previstos na tabela, pagos ap√≥s o tr√¢nsito em julgado da decis√£o.' },
  { cat:'HONOR√ÅRIOS', q:'O valor base para pagamento das certid√µes √©:', opts:['O previsto na tabela √† √©poca da nomea√ß√£o','O arbitrado pelo Ju√≠zo','O previsto na tabela vigente na √∫ltima data processual constante na certid√£o','O maior valor entre tabela e arbitramento judicial'], correct:2, exp:'O valor pago tomar√° sempre por base o previsto na TABELA VIGENTE NA √öLTIMA DATA PROCESSUAL constante na certid√£o. Para plant√µes: tabela da √©poca da indica√ß√£o.' },
  { cat:'HONOR√ÅRIOS', q:'Em certid√£o de senten√ßa absolut√≥ria criminal sem recurso, qual o percentual?', opts:['70%','100%','60%','80%'], correct:1, exp:'Quando a senten√ßa for absolut√≥ria e n√£o houver recurso: 100% do valor previsto na tabela, quando certificado o tr√¢nsito em julgado.' },
  { cat:'HONOR√ÅRIOS', q:'Em caso de senten√ßa condenat√≥ria criminal, como s√£o pagos os honor√°rios?', opts:['100% no tr√¢nsito em julgado','70% ap√≥s senten√ßa + 30% ap√≥s tr√¢nsito em julgado do ac√≥rd√£o','60% ap√≥s senten√ßa + 40% ap√≥s ac√≥rd√£o','50% em cada fase'], correct:1, exp:'Senten√ßa condenat√≥ria: 70% do valor previsto na tabela ap√≥s a senten√ßa + 30% restantes para serem pagos ap√≥s o tr√¢nsito em julgado do ac√≥rd√£o.' },
  { cat:'HONOR√ÅRIOS', q:'Se o usu√°rio constitui advogado particular durante o processo, o conveniado recebe:', opts:['Nada ‚Äî perde o direito a honor√°rios','30% do valor da tabela, desde que tenha atuado','60% do valor da tabela','100% do valor da tabela'], correct:1, exp:'Quando o usu√°rio constitui advogado particular, o conveniado que tenha atuado no processo recebe 30% do valor da tabela.' },
  { cat:'HONOR√ÅRIOS', q:'Em acordo judicial com um advogado para cada parte, qual o percentual de honor√°rios?', opts:['100% cada advogado','70% para o advogado do autor; 30% para o r√©u','70% em caso de homologa√ß√£o de acordo','100% apenas se o acordo for cumprido'], correct:2, exp:'Quando houver a participa√ß√£o de um advogado para cada parte, independentemente de ser conveniado: 70% em caso de homologa√ß√£o de acordo.' },
  { cat:'HONOR√ÅRIOS', q:'O prazo prescricional para cobran√ßa de honor√°rios √©:', opts:['1 ano','2 anos','3 anos','5 anos'], correct:3, exp:'As certid√µes somente ser√£o adimplidas se protocolizadas dentro do prazo prescricional de 5 ANOS, contados do tr√¢nsito em julgado ou do fato gerador.' },
  { cat:'HONOR√ÅRIOS', q:'O Ju√≠zo arbitrou honor√°rios em R$ 5.000 mas a tabela prev√™ R$ 1.597. O que a Defensoria paga?', opts:['R$ 5.000 conforme arbitrado pelo Ju√≠zo','R$ 1.597 conforme a tabela do conv√™nio','O valor m√©dio entre ambos','Aguarda decis√£o da CAD'], correct:1, exp:'N√£o ser√£o pagos honor√°rios em desacordo com a tabela, AINDA QUE ARBITRADO valor distinto pelo Ju√≠zo ou autoridade administrativa.' },
  { cat:'CERTID√ïES', q:'At√© que dia as certid√µes devem ser enviadas pela OAB/SP √† Defensoria?', opts:['Dia 10 de cada m√™s','Dia 15 de cada m√™s','Dia 25 de cada m√™s','Dia 30 de cada m√™s'], correct:2, exp:'As certid√µes regularmente expedidas dever√£o ser encaminhadas pela CAD/OAB-SP √† Defensoria at√© o DIA 25 de cada m√™s, para pagamento no 1¬∫ dia √∫til do segundo m√™s subsequente.' },
  { cat:'CERTID√ïES', q:'Qual o prazo para protocolar uma certid√£o de honor√°rios?', opts:['6 meses da expedi√ß√£o','1 ano da data de expedi√ß√£o','2 anos da expedi√ß√£o','N√£o h√° prazo'], correct:1, exp:'A certid√£o de honor√°rios dever√° ser aceita ou protocolizada eletronicamente em at√© 1 ANO da data de sua expedi√ß√£o.' },
  { cat:'INSCRI√á√ÉO', q:'Com que frequ√™ncia m√≠nima a Defensoria abre inscri√ß√µes?', opts:['Duas vezes ao ano','Ao menos uma vez ao ano','A qualquer tempo, sem prazo','A cada 2 anos'], correct:1, exp:'A DEFENSORIA abrir√° inscri√ß√µes ao menos uma vez ao ano, na forma e nos prazos estabelecidos em edital.' },
  { cat:'INSCRI√á√ÉO', q:'Qual o per√≠odo m√≠nimo de abertura de inscri√ß√µes pelo Edital?', opts:['5 dias √∫teis','10 dias corridos','N√£o inferior a 15 dias','20 dias √∫teis'], correct:2, exp:'O Edital de inscri√ß√µes dever√° prever abertura e encerramento das inscri√ß√µes em dias √∫teis, por per√≠odo n√£o inferior a 15 (quinze) dias.' },
  { cat:'INSCRI√á√ÉO', q:'Qual o endere√ßo eletr√¥nico obrigat√≥rio para o advogado conveniado?', opts:['@gmail.com ou @hotmail.com','@oab.org.br','@adv.oabsp.org.br','@dpsp.def.br'], correct:2, exp:'O edital de inscri√ß√µes exigir√°: endere√ßo eletr√¥nico fornecido pela OAB-SP com extens√£o @adv.oabsp.org.br.' },
  { cat:'INSCRI√á√ÉO', q:'Pode o advogado se inscrever como pessoa f√≠sica E como Sociedade Individual ao mesmo tempo?', opts:['Sim, se atuarem em √°reas diferentes','Sim, com autoriza√ß√£o da OAB/SP','N√£o. √â vedada a participa√ß√£o simult√¢nea em ambas as qualifica√ß√µes','Sim, desde que em Comarcas diferentes'], correct:2, exp:'O advogado poder√° se inscrever como pessoa f√≠sica OU como sociedade individual, sendo VEDADA a participa√ß√£o no conv√™nio com ambas as qualifica√ß√µes, SIMULTANEAMENTE.' },
  { cat:'INSCRI√á√ÉO', q:'Para inscri√ß√£o no J√∫ri, o advogado deve comprovar:', opts:['10 anos de advocacia criminal','4 sess√µes plen√°rias OU 1 sess√£o + curso espec√≠fico','Apenas aprova√ß√£o em curso da EDEPE','Aprova√ß√£o pr√©via da Defensoria'], correct:1, exp:'A inscri√ß√£o para o Tribunal do J√∫ri fica condicionada √† comprova√ß√£o de j√° haver atuado em 4 sess√µes plen√°rias do Tribunal do J√∫ri, ou de 1 sess√£o cumulada com conclus√£o de curso espec√≠fico.' },
  { cat:'DEVERES', q:'O advogado conveniado tem dever de acompanhar o processo:', opts:['At√© o tr√¢nsito em julgado, mesmo ap√≥s cancelamento da inscri√ß√£o','Apenas durante a vig√™ncia de sua inscri√ß√£o','At√© a senten√ßa de 1¬™ inst√¢ncia','Por no m√°ximo 2 anos ap√≥s a indica√ß√£o'], correct:0, exp:'O advogado deve acompanhar TODOS os feitos sob seu patroc√≠nio, independentemente de ulterior cancelamento de inscri√ß√£o, den√∫ncia ou rescis√£o do presente ajuste.' },
  { cat:'DEVERES', q:'O advogado conveniado pode cobrar algum valor do usu√°rio?', opts:['Sim, apenas custas processuais','Sim, apenas despesas eventuais','Sim, honor√°rios de √™xito','N√£o. A presta√ß√£o √© TOTALMENTE GRATUITA sob pena de descredenciamento'], correct:3, exp:'A presta√ß√£o de assist√™ncia judici√°ria ao usu√°rio √© TOTALMENTE GRATUITA. Vedada qualquer cobran√ßa a t√≠tulo de honor√°rios, taxas, emolumentos ou despesas de qualquer natureza, sob pena de DESCREDENCIAMENTO.' },
  { cat:'DEVERES', q:'O substabelecimento pelo advogado conveniado √© permitido?', opts:['Somente com autoriza√ß√£o judicial','Uma √∫nica vez em cada feito, para √∫nico ato de audi√™ncia, a outro advogado conveniado (sem honor√°rios ao substabelecido)','Ilimitado, a qualquer tempo','Apenas para r√©us presos'], correct:1, exp:'Substabelecimento permitido UMA √öNICA VEZ em cada feito, para um √∫nico ato de audi√™ncia, a outro advogado conveniado, que n√£o far√° jus ao recebimento de quaisquer valores.' },
  { cat:'RECUSA', q:'O que √© a RECUSA no contexto do conv√™nio?', opts:['√â o mesmo que ren√∫ncia','Ato do advogado que rejeita a indica√ß√£o antes da ado√ß√£o da medida judicial e previamente ao aceite no MI','Pedido de redistribui√ß√£o do processo','Absten√ß√£o da audi√™ncia'], correct:1, exp:'RECUSA √© o ato do advogado que rejeita a indica√ß√£o antes da ado√ß√£o da medida judicial cab√≠vel e previamente √† manifesta√ß√£o de aceite no sistema MI.' },
  { cat:'RECUSA', q:'Com quantos dias de anteced√™ncia m√≠nima deve ser feita a recusa de plant√£o?', opts:['1 dia','2 dias','3 dias','5 dias √∫teis'], correct:2, exp:'A recusa do plant√£o deve ser feita exclusivamente via M√≥dulo de Indica√ß√£o - MI, com, no m√≠nimo, 3 (tr√™s) dias de anteced√™ncia, sob pena de procedimento fiscalizat√≥rio.' },
  { cat:'RECUSA', q:'Autorizada a REN√öNCIA, o advogado deve:', opts:['Apenas comunicar o sistema da Defensoria','Comunicar o usu√°rio e juntar comprovante √† peti√ß√£o judicial de ren√∫ncia nos autos','Aguardar nova indica√ß√£o','Protocolar certid√£o imediatamente'], correct:1, exp:'Autorizada a ren√∫ncia pela DEFENSORIA, o advogado deve comunicar a decis√£o ao usu√°rio e juntar o documento comprobat√≥rio √† peti√ß√£o que formalizar√° o pedido de ren√∫ncia judicial nos autos.' },
  { cat:'SAN√á√ïES', q:'Quais s√£o as 4 penalidades administrativas do conv√™nio?', opts:['Multa, suspens√£o, cassa√ß√£o e pris√£o','Advert√™ncia, suspens√£o (m√°x. 18 meses), exclus√£o de √°rea e descredenciamento','Repreens√£o, afastamento, cassa√ß√£o e exclus√£o','Advert√™ncia, multa, suspens√£o e demiss√£o'], correct:1, exp:'As penalidades s√£o: (I) Advert√™ncia; (II) Suspens√£o pelo prazo m√°ximo de 18 meses; (III) Exclus√£o de √°rea de atua√ß√£o; (IV) Descredenciamento.' },
  { cat:'SAN√á√ïES', q:'Quando √© aplicada a SUSPENS√ÉO (n√£o advert√™ncia) ao advogado?', opts:['Pela primeira falta leve cometida','Quando a conduta implica preju√≠zo ao usu√°rio ou em caso de reitera√ß√£o das condutas geradoras de advert√™ncia','Apenas por descumprimento de prazo','Nunca, pois s√≥ existe advert√™ncia ou descredenciamento'], correct:1, exp:'A suspens√£o √© aplicada quando a conduta implica preju√≠zo ao usu√°rio, n√£o comparecimento a atos processuais com preju√≠zo, ou por reitera√ß√£o/cumula√ß√£o de condutas geradoras de advert√™ncia.' },
  { cat:'SAN√á√ïES', q:'Qual o prazo de penalidade de exclus√£o de √°rea de atua√ß√£o?', opts:['6 meses','12 meses','24 meses','18 meses'], correct:2, exp:'A exclus√£o de √°rea de atua√ß√£o, cumulativa √† advert√™ncia ou suspens√£o, √© aplicada pelo prazo de 24 (vinte e quatro) meses, para reitera√ß√µes de condutas at√©cnicas numa mesma √°rea.' },
  { cat:'SAN√á√ïES', q:'Das decis√µes da C√¢mara RECURSAL do conv√™nio, cabe recurso?', opts:['Sim, ao Defensor P√∫blico Geral','Sim, ao Tribunal de √âtica da OAB','N√£o cabe recurso','Sim, mandado de seguran√ßa ao TJ-SP'], correct:2, exp:'Das decis√µes da C√¢mara Recursal N√ÉO CABE RECURSO (art. 32 do Anexo III).' },
  { cat:'SAN√á√ïES', q:'Qual o prazo prescricional para punir infra√ß√£o ao conv√™nio?', opts:['1 ano','2 anos','3 anos','5 anos'], correct:3, exp:'A punibilidade por infra√ß√£o aos termos do Conv√™nio prescreve em 5 (cinco) anos da data do conhecimento do fato pela Coordena√ß√£o Regional ou pela Presid√™ncia da Subse√ß√£o da OAB/SP.' },
  { cat:'SAN√á√ïES', q:'O advogado condenado a suspens√£o recebe honor√°rios dos processos da causa?', opts:['Sim, normalmente','N√£o ‚Äî sem honor√°rios; se j√° recebeu, deve devolver','Recebe 50% do valor','Recebe honor√°rios apenas de outros processos'], correct:1, exp:'Aplicada a penalidade (exceto advert√™ncia), o advogado N√ÉO far√° jus √† percep√ß√£o de quaisquer honor√°rios nos processos relacionados √† causa da san√ß√£o. Se j√° recebeu, ser√° intimado para restitui√ß√£o.' },
  { cat:'SAN√á√ïES', q:'Ap√≥s descredenciamento, quando pode o advogado pedir nova inscri√ß√£o?', opts:['Imediatamente ap√≥s cumprir a pena','Ap√≥s 1 ano','Ap√≥s 2 anos da ci√™ncia da decis√£o, desde que cessados os motivos','Ap√≥s 5 anos'], correct:2, exp:'O advogado descredenciado somente poder√° pleitear nova inscri√ß√£o ap√≥s 2 (dois) anos contados da ci√™ncia da decis√£o da Comiss√£o Mista, desde que cessados os motivos que ensejaram a aplica√ß√£o.' },
  { cat:'SAN√á√ïES', q:'A C√¢mara Parit√°ria de Julgamento √© composta por:', opts:['4 Defensores P√∫blicos + 4 advogados','2 Defensores P√∫blicos + 2 advogados','1 juiz + 2 DPs + 2 advogados','3 DPs + 3 advogados'], correct:1, exp:'As C√¢maras Parit√°rias de Julgamento s√£o compostas por 2 Defensores P√∫blicos (designados por ato da DPG-E) + 2 advogados (indicados pela OAB/SP).' },
  { cat:'FISCAL', q:'O advogado sindicado pode fazer sustenta√ß√£o oral por quanto tempo?', opts:['2 minutos','5 minutos improrrog√°veis','10 minutos','15 minutos'], correct:1, exp:'O advogado sindicado poder√° fazer uso de sustenta√ß√£o oral pelo tempo improrrog√°vel de 5 (cinco) minutos, comunicando a inten√ß√£o em at√© 3 dias √∫teis antes.' },
  { cat:'FISCAL', q:'As notifica√ß√µes eletr√¥nicas enviadas ao e-mail cadastrado s√£o v√°lidas:', opts:['Apenas com confirma√ß√£o de leitura','Independentemente de confirma√ß√£o de recebimento','Somente para atos n√£o urgentes','Com confirma√ß√£o e AR postal'], correct:1, exp:'Considerar-se-√£o v√°lidas para todos os efeitos as notifica√ß√µes eletr√¥nicas encaminhadas ao e-mail de cadastro do advogado, INDEPENDENTEMENTE de confirma√ß√£o de recebimento.' },
  { cat:'FISCAL', q:'Os procedimentos fiscalizat√≥rios t√™m que car√°ter?', opts:['P√∫blico e transparente','Sigiloso, em regra','Semip√∫blico','P√∫blico se a falta for grave'], correct:1, exp:'Os procedimentos de que tratam esse anexo possuem, em regra, CAR√ÅTER SIGILOSO. O acesso ao conte√∫do deve ser solicitado ao SIC.' },
  { cat:'MEDIDAS', q:'A vincula√ß√£o do advogado nomeado para medida protetiva de v√≠tima de VD √© de:', opts:['6 meses','12 meses contados da primeira decis√£o','24 meses','At√© o encerramento do processo principal'], correct:1, exp:'O advogado ficar√° vinculado √†s demandas correlatas da mesma benefici√°ria pelo per√≠odo de 12 (doze) meses, contado da primeira decis√£o em medida protetiva.' },
  { cat:'MEDIDAS', q:'Na Inf√¢ncia e Juventude, N√ÉO haver√° indica√ß√£o de advogado em:', opts:['A√ß√µes de apura√ß√£o de ato infracional','Execu√ß√£o de medida socioeducativa','Oitiva informal perante o MP e remiss√£o simples sem medida socioeducativa','Medidas cautelares urgentes'], correct:2, exp:'N√£o haver√° indica√ß√£o de advogado para: (I) oitiva informal perante o Minist√©rio P√∫blico; (II) remiss√£o simples desacompanhada de medida socioeducativa ou protetiva.' },
  { cat:'MEDIDAS', q:'O advogado que atuou na apura√ß√£o do ato infracional deve atuar na execu√ß√£o da medida socioeducativa?', opts:['Sim, e faz jus a nova certid√£o','Sim, mas sem direito a nova certid√£o de honor√°rios','N√£o, √© indicado novo advogado','Apenas se o usu√°rio solicitar'], correct:1, exp:'O advogado que atuou na fase de apura√ß√£o de ato infracional PERMANECER√Å respons√°vel pela execu√ß√£o da medida socioeducativa aplicada, SEM DIREITO √† expedi√ß√£o de nova certid√£o de honor√°rios.' },
  { cat:'ANPP', q:'O ANPP abrange desde a proposta de acordo at√©:', opts:['A senten√ßa condenat√≥ria','O ato de homologa√ß√£o e extin√ß√£o da punibilidade, se realizados no mesmo ato','Apenas a proposta de acordo','A audi√™ncia de instru√ß√£o'], correct:1, exp:'O advogado ser√° indicado para atuar no ANPP, que abranger√° desde a proposta de acordo at√© o ato de homologa√ß√£o e extin√ß√£o da punibilidade, se realizada no mesmo ato.' },
  { cat:'LGPD', q:'O advogado conveniado deve cumprir as leis de prote√ß√£o de dados:', opts:['Apenas quando solicitado','A todo momento, sob pena de multas','Apenas para processos de fam√≠lia','Somente nos dados do SEI'], correct:1, exp:'O advogado deve cumprir, a todo momento, as leis de prote√ß√£o de dados, jamais colocando, por seus atos ou omiss√£o, a DEFENSORIA ou a OAB/SP em situa√ß√£o de viola√ß√£o das leis de prote√ß√£o de dados.' },
];

// ============================================================
//  QUIZ ENGINE
// ============================================================
let qIdx = 0, qScore = 0, timer = null, timerVal = 45;
let answerLog = [];
const shuffled = [...quizData].sort(() => Math.random() - 0.5);

let nomeQuiz = '';

function startQuiz() {
  const inputNome = document.getElementById('input-nome-quiz');
  nomeQuiz = inputNome ? inputNome.value.trim() : '';
  if (!nomeQuiz) {
    inputNome.style.border = '2px solid #e74c3c';
    inputNome.placeholder = 'Por favor, digite seu nome para continuar...';
    inputNome.focus();
    return;
  }
  qIdx = 0; qScore = 0; timerVal = 45; answerLog = [];
  document.getElementById('quiz-start-screen').style.display = 'none';
  document.getElementById('quiz-container').style.display = 'block';
  document.getElementById('cert-container').classList.remove('show');
  renderQuestion();
}

function renderQuestion() {
  if (qIdx >= 50) { showCert(); return; }
  const q = shuffled[qIdx];
  document.getElementById('qCat').textContent = q.cat;
  document.getElementById('qQuestion').textContent = q.q;
  document.getElementById('qNum').textContent = (qIdx+1) + '/50';
  document.getElementById('qProgressFill').style.width = ((qIdx+1)/50*100) + '%';
  document.getElementById('qScore').textContent = qScore;
  document.getElementById('qExplanation').classList.remove('show');
  document.getElementById('qNext').classList.remove('show');

  const opts = document.getElementById('qOptions');
  opts.innerHTML = '';
  q.opts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'quiz-opt'; btn.textContent = opt;
    btn.onclick = () => answerQuestion(i, q.correct, q.exp);
    opts.appendChild(btn);
  });
  startTimer();
}

function startTimer() {
  clearInterval(timer);
  timerVal = 45;
  updateTimer();
  timer = setInterval(() => {
    timerVal--;
    updateTimer();
    if (timerVal <= 0) {
      clearInterval(timer);
      timeOut();
    }
  }, 1000);
}

function updateTimer() {
  const el = document.getElementById('qTimer');
  el.textContent = timerVal;
  el.classList.toggle('urgent', timerVal <= 10);
}

function timeOut() {
  const q = shuffled[qIdx];
  const btns = document.querySelectorAll('.quiz-opt');
  btns[q.correct].classList.add('correct');
  btns.forEach(b => b.disabled = true);
  answerLog.push({ cat: shuffled[qIdx].cat, correct: false });
  document.getElementById('qExplanation').innerHTML = `<strong>‚è± Tempo esgotado!</strong> ${q.exp}`;
  document.getElementById('qExplanation').classList.add('show');
  document.getElementById('qNext').classList.add('show');
}

function answerQuestion(chosen, correct, exp) {
  clearInterval(timer);
  const btns = document.querySelectorAll('.quiz-opt');
  btns.forEach(b => b.disabled = true);
  playSound(chosen === correct ? 'correct' : 'wrong');
  btns[chosen].classList.add(chosen === correct ? 'correct' : 'wrong');
  if (chosen !== correct) btns[correct].classList.add('correct');
  if (chosen === correct) qScore++;
  answerLog.push({ cat: shuffled[qIdx].cat, correct: chosen === correct });
  document.getElementById('qScore').textContent = qScore;
  document.getElementById('qExplanation').innerHTML = `<strong>${chosen === correct ? '‚úÖ Correto!' : '‚ùå Errado!'}</strong> ${exp}`;
  document.getElementById('qExplanation').classList.add('show');
  document.getElementById('qNext').classList.add('show');
}

function nextQuestion() {
  qIdx++;
  renderQuestion();
}

function showCert() {
  document.getElementById('quiz-container').style.display = 'none';
  const cert = document.getElementById('cert-container');
  cert.classList.add('show');

  const pct = (qScore/50*100).toFixed(0);
  let level = '', stars = '';
  if (pct >= 90) { level = 'üèÜ üëë C√ÅSSIA KELLY ‚Äî LEND√ÅRIA & IMBAT√çVEL'; stars = '‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê'; }
  else if (pct >= 80) { level = 'ü•á ESPECIALISTA AVAN√áADA'; stars = '‚≠ê‚≠ê‚≠ê‚≠ê'; }
  else if (pct >= 70) { level = 'ü•à ESPECIALISTA INTERMEDI√ÅRIA'; stars = '‚≠ê‚≠ê‚≠ê'; }
  else if (pct >= 60) { level = 'ü•â ESPECIALISTA EM FORMA√á√ÉO'; stars = '‚≠ê‚≠ê'; }
  else { level = 'üìö Continue estudando ‚Äî voc√™ consegue!'; stars = '‚≠ê'; }

  document.getElementById('cert-nome-display').textContent = nomeQuiz ? nomeQuiz.toUpperCase() : 'PARTICIPANTE';
  document.getElementById('certScore').textContent = qScore + '/50 (' + pct + '%)';
  document.getElementById('certStars').textContent = stars;
  document.getElementById('certLevel').textContent = level;
  document.getElementById('certDate').textContent = 'Emitido em: ' + new Date().toLocaleDateString('pt-BR', {day:'2-digit',month:'long',year:'numeric'});
  
  // Category breakdown
  buildCatBreakdown();
  
  // Save to history
  saveHistory(nomeQuiz || 'Participante', qScore, pct, stars);
  renderHistory();
}

function buildCatBreakdown() {
  const cats = {};
  shuffled.forEach((q, i) => {
    if (!cats[q.cat]) cats[q.cat] = { correct:0, total:0 };
    cats[q.cat].total++;
    // We track per-question results in answerLog
  });
  // Use answerLog
  const rows = document.getElementById('catBreakdownRows');
  rows.innerHTML = '';
  const catSummary = {};
  answerLog.forEach(entry => {
    if (!catSummary[entry.cat]) catSummary[entry.cat] = { c:0, t:0 };
    catSummary[entry.cat].t++;
    if (entry.correct) catSummary[entry.cat].c++;
  });
  const sortedCats = Object.keys(catSummary).sort((a,b) => {
    const pA = catSummary[a].c / catSummary[a].t;
    const pB = catSummary[b].c / catSummary[b].t;
    return pB - pA;
  });
  sortedCats.forEach(cat => {
    const d = catSummary[cat];
    const p = Math.round(d.c / d.t * 100);
    const colorClass = p >= 70 ? '' : p >= 50 ? 'mid' : 'low';
    rows.innerHTML += `<div class="cat-row">
      <span class="cat-row-label">${cat}</span>
      <div class="cat-row-bar"><div class="cat-row-fill ${colorClass}" style="width:${p}%"></div></div>
      <span class="cat-row-pct">${p}%</span>
    </div>`;
  });
  document.getElementById('catBreakdown').style.display = 'block';
}

function saveHistory(name, score, pct, stars) {
  const history = JSON.parse(localStorage.getItem('dpe_quiz_history') || '[]');
  history.unshift({
    name, score, pct,
    stars: stars.replace(/[^‚≠ê]/g, '').length,
    date: new Date().toLocaleDateString('pt-BR')
  });
  if (history.length > 10) history.pop();
  localStorage.setItem('dpe_quiz_history', JSON.stringify(history));
}

function renderHistory() {
  const history = JSON.parse(localStorage.getItem('dpe_quiz_history') || '[]');
  const list = document.getElementById('historyList');
  if (!list) return;
  if (history.length === 0) {
    list.innerHTML = '<div class="history-empty">Nenhuma tentativa ainda. Complete o quiz!</div>';
    return;
  }
  list.innerHTML = history.map((h, i) => `
    <div class="history-item">
      <span class="h-name">${h.name}</span>
      <span class="h-score">${h.score}/50 (${h.pct}%)</span>
      <span class="h-stars">${'‚≠ê'.repeat(h.stars)}</span>
      <span class="h-date">${h.date}</span>
    </div>
  `).join('');
}

function printCert() { window.print(); }

// Add print styles dynamically
const printStyle = document.createElement('style');
printStyle.textContent = `
@media print {
  #particles, header, nav, footer, .cert-actions, .cert-cat-breakdown, .history-section { display:none!important; }
  body { background:white!important; color:black!important; }
  main { padding:0!important; }
  .panel { display:block!important; }
  .panel:not(#panel-quiz) { display:none!important; }
  .cert-container { display:block!important; }
  .cert-box { border:2px solid #C9A84C!important; background:white!important; box-shadow:none!important; }
  .cert-name, .cert-title, .cert-subtitle { color:#8B6914!important; }
  .cert-text, .cert-date, .cert-issued { color:#333!important; }
}`;
document.head.appendChild(printStyle);
function resetQuiz() {
  document.getElementById('cert-container').classList.remove('show');
  document.getElementById('quiz-start-screen').style.display = 'block';
  document.getElementById('quiz-container').style.display = 'none';
}

// ============================================================
//  CHALLENGES
// ============================================================
const challenges = [
  { icon:'üìÑ', title:'Leitura Completa', desc:'Leia todas as 24 folhas do Conv√™nio 001/2026 usando o audiobook integrado.', progress:0, locked:false, badge:'INICIANTE', total:24 },
  { icon:'üÉè', title:'Flashcard Master', desc:'Vire todos os 50 flashcards pelo menos uma vez para dominar os conceitos essenciais.', progress:0, locked:false, badge:'PRATICANTE', total:50 },
  { icon:'‚ö°', title:'Regras Gravadas', desc:'Revise as 50 regras mais importantes do conv√™nio e teste sua memoriza√ß√£o.', progress:0, locked:false, badge:'ESTUDANTE', total:50 },
  { icon:'üí∞', title:'Tabela Decorada', desc:'Memorize os 10 honor√°rios mais comuns da tabela. Quanto √© o rito ordin√°rio criminal?', progress:0, locked:false, badge:'FINANCEIRO', total:10 },
  { icon:'üéØ', title:'Quiz Aprova√ß√£o', desc:'Complete o quiz de 50 perguntas com aproveitamento ‚â• 70%. Prove que voc√™ domina o conv√™nio!', progress:0, locked:false, badge:'TESTADO', total:50 },
  { icon:'üèÜ', title:'Especialista Total', desc:'Atinja nota ‚â• 90% no quiz. Torne-se LEND√ÅRIA no Conv√™nio 001/2026!', progress:0, locked:true, badge:'üëë LENDA', total:50 },
  { icon:'‚öñÔ∏è', title:'Mestre em Prazos', desc:'Responda corretamente todos os desafios de prazos do conv√™nio sem errar nenhum.', progress:0, locked:true, badge:'PRAZOS', total:20 },
  { icon:'üîí', title:'LGPD Expert', desc:'Dom√≠nio total das obriga√ß√µes de prote√ß√£o de dados pessoais previstas no conv√™nio.', progress:0, locked:true, badge:'LGPD', total:10 },
  { icon:'üéì', title:'Certificada DPE-OAB', desc:'Conclua todos os m√≥dulos e obtenha o certificado de especializa√ß√£o em Conv√™nio DPE-OAB 001/2026.', progress:0, locked:true, badge:'CERTIFICADA', total:8 },
];

const challContainer = document.getElementById('challengesContainer');
challenges.forEach(c => {
  const el = document.createElement('div');
  el.className = `challenge-card ${c.locked?'ch-locked':''}`;
  el.innerHTML = `<span class="ch-badge">${c.badge}</span>
    <div class="ch-icon">${c.icon}</div>
    <div class="ch-title">${c.title}</div>
    <div class="ch-desc">${c.desc}</div>
    <div class="ch-progress"><div class="ch-fill" style="width:${c.progress/c.total*100}%"></div></div>
    <div class="ch-stats"><span>${c.progress}/${c.total} conclu√≠do</span><span>${c.locked?'üîí Bloqueado':'‚úÖ Dispon√≠vel'}</span></div>`;
  challContainer.appendChild(el);
});

// Init history display
renderHistory();


// ============================================================
//  TOAST NOTIFICATION
// ============================================================
function showToast(msg) {
  let t = document.querySelector('.toast');
  if (!t) { t = document.createElement('div'); t.className = 'toast'; document.body.appendChild(t); }
  t.innerHTML = msg;
  t.classList.add('show');
  clearTimeout(t._timer);
  t._timer = setTimeout(() => t.classList.remove('show'), 3500);
}

// ============================================================
//  CONQUISTAS (20 badges)
// ============================================================
const badgesDef = [
  { id:'first_flash',   icon:'üÉè', name:'Primeiro Flip',        desc:'Virou seu primeiro flashcard',                   check: () => flippedCount >= 1 },
  { id:'ten_flash',     icon:'üîü', name:'Decuplista',           desc:'Virou 10 flashcards',                            check: () => flippedCount >= 10 },
  { id:'all_flash',     icon:'üé¥', name:'Mestre dos Cards',     desc:'Virou todos os 50 flashcards',                   check: () => flippedCount >= 50 },
  { id:'first_fav',     icon:'‚ù§Ô∏è', name:'Primeiro Favorito',    desc:'Marcou um flashcard como favorito',              check: () => favorites.size >= 1 },
  { id:'five_fav',      icon:'üíù', name:'Colecionadora',        desc:'Marcou 5 flashcards como favoritos',             check: () => favorites.size >= 5 },
  { id:'first_star',    icon:'‚≠ê', name:'Primeira Estrela',     desc:'Avaliou um flashcard com 3 estrelas',            check: () => Object.values(masterScores).filter(v=>v===3).length >= 1 },
  { id:'ten_stars',     icon:'üåü', name:'C√©u Estrelado',        desc:'10 flashcards com dom√≠nio m√°ximo (‚≠ê‚≠ê‚≠ê)',       check: () => Object.values(masterScores).filter(v=>v===3).length >= 10 },
  { id:'all_stars',     icon:'‚ú®', name:'Gal√°xia de Ouro',      desc:'Todos os 50 flashcards com 3 estrelas',          check: () => Object.values(masterScores).filter(v=>v===3).length >= 50 },
  { id:'read5',         icon:'üìñ', name:'Leitora Iniciante',    desc:'Leu 5 p√°ginas do conv√™nio',                      check: () => readPages.size >= 5 },
  { id:'read12',        icon:'üìö', name:'Meia Leitora',         desc:'Leu metade do conv√™nio (12 p√°ginas)',            check: () => readPages.size >= 12 },
  { id:'read24',        icon:'üèõÔ∏è', name:'Doutora do Conv√™nio',  desc:'Leu todas as 24 p√°ginas',                        check: () => readPages.size >= 24 },
  { id:'quiz_done',     icon:'üéØ', name:'Primeira Prova',       desc:'Completou o quiz pela primeira vez',             check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).length >= 1 },
  { id:'quiz_60',       icon:'ü•â', name:'Aprovada',             desc:'Atingiu ‚â•60% no quiz',                           check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).some(h=>parseInt(h.pct)>=60) },
  { id:'quiz_70',       icon:'ü•à', name:'Bem Acima da M√©dia',   desc:'Atingiu ‚â•70% no quiz',                           check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).some(h=>parseInt(h.pct)>=70) },
  { id:'quiz_80',       icon:'ü•á', name:'Especialista Avan√ßada',desc:'Atingiu ‚â•80% no quiz',                           check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).some(h=>parseInt(h.pct)>=80) },
  { id:'quiz_90',       icon:'üèÜ', name:'üëë C√ÅSSIA KELLY ‚Äî LEND√ÅRIA',        desc:'Atingiu ‚â•90% ‚Äî LEND√ÅRIA & IMBAT√çVEL!',          check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).some(h=>parseInt(h.pct)>=90) },
  { id:'quiz_100',      icon:'üíé', name:'Perfei√ß√£o Absoluta',   desc:'Gabaritou o quiz ‚Äî 50/50!',                      check: () => (JSON.parse(localStorage.getItem('dpe_quiz_history')||'[]')).some(h=>parseInt(h.pct)===100) },  // fixed: was h.pct>=100 but pct is string
  { id:'ia_used',       icon:'ü§ñ', name:'Primeira Consulta IA', desc:'Fez sua primeira pergunta ao Assistente IA',     check: () => parseInt(localStorage.getItem('dpe_ia_count')||'0') >= 1 },
  { id:'ia_power',      icon:'üß†', name:'Pesquisadora',         desc:'Fez 10 perguntas ao Assistente IA',              check: () => parseInt(localStorage.getItem('dpe_ia_count')||'0') >= 10 },
  { id:'mapa_used',     icon:'üó∫Ô∏è', name:'Cart√≥grafa Jur√≠dica',  desc:'Explorou o mapa mental do conv√™nio',             check: () => parseInt(localStorage.getItem('dpe_mapa_clicks')||'0') >= 3 },
];

let unlockedBadges = new Set(JSON.parse(localStorage.getItem('dpe_badges') || '[]'));

function checkBadges(silent=false) {
  badgesDef.forEach(b => {
    if (!unlockedBadges.has(b.id) && b.check()) {
      unlockedBadges.add(b.id);
      localStorage.setItem('dpe_badges', JSON.stringify([...unlockedBadges]));
      if (!silent) {
        showToast('üèÖ Conquista desbloqueada: <strong>' + b.name + '</strong> ' + b.icon);
        setTimeout(() => renderConquistas(), 300);
      }
    }
  });
}

function renderConquistas() {
  const grid = document.getElementById('conquistasGrid');
  const stats = document.getElementById('conquistasStats');
  if (!grid) return;
  
  const total = badgesDef.length;
  const unlocked = badgesDef.filter(b => unlockedBadges.has(b.id)).length;
  const pct = Math.round(unlocked/total*100);
  
  stats.innerHTML = `
    <div class="cq-stat"><strong>${unlocked}</strong><span>Desbloqueadas</span></div>
    <div class="cq-stat"><strong>${total - unlocked}</strong><span>Bloqueadas</span></div>
    <div class="cq-stat"><strong>${pct}%</strong><span>Progresso</span></div>
    <div class="cq-stat" style="flex:2; background:var(--surface2);">
      <div style="height:8px; background:var(--surface3); border-radius:4px; overflow:hidden; margin-bottom:6px;">
        <div style="height:100%; width:${pct}%; background:linear-gradient(90deg,var(--gold-dark),var(--gold)); border-radius:4px; transition:width .8s;"></div>
      </div>
      <span style="font-size:.75rem;">${unlocked} de ${total} conquistas</span>
    </div>
  `;
  
  grid.innerHTML = '';
  badgesDef.forEach(b => {
    const isUnlocked = unlockedBadges.has(b.id);
    const card = document.createElement('div');
    card.className = 'conquista-card ' + (isUnlocked ? 'unlocked' : 'locked');
    if (isUnlocked) card.classList.add('cq-unlock-anim');
    card.innerHTML = `
      <span class="cq-badge-icon">${isUnlocked ? b.icon : 'üîí'}</span>
      <div class="cq-badge-name">${b.name}</div>
      <div class="cq-badge-desc">${b.desc}</div>
      <span class="cq-badge-status">${isUnlocked ? '‚úÖ Desbloqueada' : 'Bloqueada'}</span>
    `;
    grid.appendChild(card);
  });
}

// Check badges on key events (patch existing functions)
const _origRateStar = rateStar;
function rateStar(e, idx, stars) {
  _origRateStar(e, idx, stars);
  checkBadges();
}

// ============================================================
//  ASSISTENTE IA (Claude API)
// ============================================================
const IA_CONTEXT = `Voc√™ √© um assistente especialista no Conv√™nio DPE-OAB/SP n¬∫ 001/2026.
Responda de forma clara, direta e em linguagem simples. Use exemplos pr√°ticos quando √∫til.
Use negrito para destacar termos-chave e prazos importantes.
Conhe√ßa este conte√∫do fundamental:
- Vig√™ncia: 15 meses a partir de 1¬∫/05/2026 | Valor: R$ 250 milh√µes
- √Åreas cobertas: C√≠vel, Fam√≠lia/Sucess√µes, Criminal, IJ, Atividades Especiais
- √Åreas EXCLU√çDAS: eleitoral, administrativa, trabalhista, previdenci√°ria
- Certid√µes: at√© dia 25 de cada m√™s | Pagamento: 1¬∫ dia √∫til do 2¬∫ m√™s subsequente
- Prazo ajuizamento c√≠vel: 30 dias ap√≥s receber documenta√ß√£o (6 meses para coletar)
- Honor√°rios criminais: 100% absolut√≥ria s/recurso | 70%+30% c/recurso | 30% suspens√£o
- Honor√°rios c√≠veis: 100% proced√™ncia total s/recurso | 70%+30% c/recurso
- J√∫ri: 4 sess√µes plen√°rias OU 1 sess√£o + curso espec√≠fico
- Penalidades: advert√™ncia, suspens√£o (m√°x 18 meses), exclus√£o de √°rea (24 meses), descredenciamento
- Descredenciamento obrigat√≥rio: cobrar usu√°rio, captar clientes, erro grave, 3¬™ suspens√£o
- Prescri√ß√£o: 5 anos para infra√ß√µes e para certid√µes
- E-mail obrigat√≥rio: @adv.oabsp.org.br
- Substabelecimento: 1 vez por feito, 1 ato de audi√™ncia, sem honor√°rios ao substabelecido
- Aus√™ncia tempor√°ria: 60 dias/ano (2 per√≠odos de 30 dias)
Responda sempre em portugu√™s brasileiro.`;

let iaHistory = [];

async function sendIA() {
  const input = document.getElementById('iaInput');
  const msg = input.value.trim();
  if (!msg) return;
  input.value = '';
  
  const chat = document.getElementById('iaChat');
  
  // User message
  chat.innerHTML += `<div class="ia-msg ia-msg-user">
    <div class="ia-avatar">üë§</div>
    <div class="ia-bubble">${msg}</div>
  </div>`;
  
  // Typing indicator
  const typingId = 'typing-' + Date.now();
  chat.innerHTML += `<div class="ia-msg ia-msg-bot" id="${typingId}">
    <div class="ia-avatar">‚öñÔ∏è</div>
    <div class="ia-bubble"><div class="ia-typing"><span></span><span></span><span></span></div></div>
  </div>`;
  chat.scrollTop = chat.scrollHeight;
  
  document.getElementById('iaSendBtn').disabled = true;
  iaHistory.push({ role: 'user', content: msg });
  
  // Track IA usage for badge
  const iaCount = parseInt(localStorage.getItem('dpe_ia_count') || '0') + 1;
  localStorage.setItem('dpe_ia_count', iaCount);
  
  try {
    const resp = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        system: IA_CONTEXT,
        messages: iaHistory
      })
    });
    const data = await resp.json();
    const reply = data.content?.[0]?.text || 'Desculpe, n√£o consegui processar sua pergunta.';
    
    iaHistory.push({ role: 'assistant', content: reply });
    
    // Format reply: bold, line breaks
    const formatted = reply
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/
/g, '<br>');
    
    document.getElementById(typingId).outerHTML = `<div class="ia-msg ia-msg-bot">
      <div class="ia-avatar">‚öñÔ∏è</div>
      <div class="ia-bubble">${formatted}</div>
    </div>`;
  } catch(e) {
    document.getElementById(typingId).outerHTML = `<div class="ia-msg ia-msg-bot">
      <div class="ia-avatar">‚öñÔ∏è</div>
      <div class="ia-bubble" style="color:var(--red);">‚ùå Erro ao conectar com a IA. Verifique sua conex√£o.</div>
    </div>`;
  }
  
  document.getElementById('iaSendBtn').disabled = false;
  chat.scrollTop = chat.scrollHeight;
  checkBadges();
}

function sendSuggestion(btn) {
  document.getElementById('iaInput').value = btn.textContent;
  sendIA();
}

// ============================================================
//  MAPA MENTAL (Canvas-based interactive mind map)
// ============================================================
const mapaNodes = [
  { id:0, label:'CONV√äNIO
001/2026', x:.5, y:.46, r:52, color:'#C9A84C', textColor:'#060810', main:true,
    info:'<strong>Conv√™nio DPE-OAB/SP 001/2026</strong><br>Assist√™ncia judici√°ria gratuita suplementar<br>Vig√™ncia: 15 meses a partir de 01/05/2026<br>Valor: R$ 250.000.000' },
  { id:1, label:'√ÅREAS
COBERTAS', x:.22, y:.18, r:38, color:'#1C6B3A', textColor:'#fff',
    info:'<strong>√Åreas cobertas:</strong><br>‚Ä¢ C√≠vel<br>‚Ä¢ Fam√≠lia e Sucess√µes<br>‚Ä¢ Criminal<br>‚Ä¢ Inf√¢ncia e Juventude<br>‚Ä¢ Atividades Especiais (plant√µes, precat√≥rias)' },
  { id:2, label:'EXCLUS√ïES', x:.5, y:.1, r:36, color:'#8B1A1A', textColor:'#fff',
    info:'<strong>√Åreas EXCLU√çDAS:</strong><br>‚Ä¢ Eleitoral<br>‚Ä¢ Administrativa<br>‚Ä¢ Trabalhista<br>‚Ä¢ Previdenci√°ria<br>(mesmo em compet√™ncia delegada √† Justi√ßa Estadual)' },
  { id:3, label:'HONOR√ÅRIOS', x:.78, y:.18, r:40, color:'#1A4E8B', textColor:'#fff',
    info:'<strong>Sistema de honor√°rios:</strong><br>‚Ä¢ 100% ‚Äî vit√≥ria total s/recurso<br>‚Ä¢ 70%+30% ‚Äî vit√≥ria c/recurso<br>‚Ä¢ 60% ‚Äî parcial/sucumb√™ncia<br>‚Ä¢ 30% ‚Äî suspens√£o, atua√ß√£o parcial<br>Reajuste anual: IPC/FIPE' },
  { id:4, label:'PRAZOS', x:.88, y:.46, r:36, color:'#6B3A1A', textColor:'#fff',
    info:'<strong>Prazos cr√≠ticos:</strong><br>‚Ä¢ Certid√µes: at√© dia 25/m√™s<br>‚Ä¢ Ajuizamento c√≠vel: 30 dias ap√≥s docs<br>‚Ä¢ Coleta de docs: 6 meses<br>‚Ä¢ Protocolo certid√£o: 1 ano<br>‚Ä¢ Prescri√ß√£o: 5 anos' },
  { id:5, label:'SAN√á√ïES', x:.78, y:.74, r:38, color:'#7A2D8B', textColor:'#fff',
    info:'<strong>Penalidades:</strong><br>‚Ä¢ Advert√™ncia (1¬™ falta leve)<br>‚Ä¢ Suspens√£o m√°x. 18 meses<br>‚Ä¢ Exclus√£o de √°rea: 24 meses<br>‚Ä¢ Descredenciamento<br>Nova inscri√ß√£o: 2 anos ap√≥s descred.' },
  { id:6, label:'INSCRI√á√ÉO', x:.5, y:.82, r:36, color:'#1A6B6B', textColor:'#fff',
    info:'<strong>Inscri√ß√µes:</strong><br>‚Ä¢ M√≠nimo 1x/ano | 15 dias de prazo<br>‚Ä¢ E-mail: @adv.oabsp.org.br<br>‚Ä¢ N√£o pode PF + Soc. Individual junto<br>‚Ä¢ J√∫ri: 4 sess√µes ou 1 + curso<br>‚Ä¢ VD e IJ: curso espec√≠fico' },
  { id:7, label:'DEVERES
ADV.', x:.22, y:.74, r:36, color:'#3A1A6B', textColor:'#fff',
    info:'<strong>Deveres do advogado:</strong><br>‚Ä¢ Atuar at√© tr√¢nsito em julgado<br>‚Ä¢ Assist√™ncia TOTALMENTE GRATUITA<br>‚Ä¢ Substab.: 1x por feito, 1 ato<br>‚Ä¢ Aus√™ncia: 60 dias/ano<br>‚Ä¢ Manter @adv.oabsp.org.br' },
  { id:8, label:'CRIMINAL', x:.12, y:.46, r:36, color:'#3A6B1A', textColor:'#fff',
    info:'<strong>√Årea Criminal:</strong><br>‚Ä¢ Indica√ß√£o: cust√≥dia, ANPP ou cita√ß√£o<br>‚Ä¢ Nomeado na cust√≥dia = resp. por tudo<br>‚Ä¢ R√©u preso: adotar TODAS medidas de liberdade<br>‚Ä¢ Execu√ß√£o penal: apenas hip√≥teses excepcionais' },
];

const mapaEdges = [
  [0,1],[0,2],[0,3],[0,4],[0,5],[0,6],[0,7],[0,8]
];

let mapaScale = 1, mapaOffX = 0, mapaOffY = 0;
let mapaDrag = false, mapaDragX = 0, mapaDragY = 0;
let mapaCanvas, mapaCtx, mapaW, mapaH;
let hoveredNode = null;

function initMapa() {
  mapaCanvas = document.getElementById('mapaCanvas');
  if (!mapaCanvas) return;
  mapaCtx = mapaCanvas.getContext('2d');
  
  function resize() {
    const container = mapaCanvas.parentElement;
    mapaW = container.clientWidth;
    mapaH = Math.max(480, window.innerWidth < 480 ? 360 : 540);
    mapaCanvas.width = mapaW;
    mapaCanvas.height = mapaH;
    mapaCanvas.style.height = mapaH + 'px';
    drawMapa();
  }
  
  resize();
  window.addEventListener('resize', resize);
  
  // Mouse events
  mapaCanvas.addEventListener('mousedown', e => {
    mapaDrag = true;
    mapaDragX = e.clientX - mapaOffX;
    mapaDragY = e.clientY - mapaOffY;
  });
  mapaCanvas.addEventListener('mousemove', e => {
    if (mapaDrag) {
      mapaOffX = e.clientX - mapaDragX;
      mapaOffY = e.clientY - mapaDragY;
      drawMapa(); return;
    }
    const rect = mapaCanvas.getBoundingClientRect();
    const mx = (e.clientX - rect.left - mapaOffX) / mapaScale;
    const my = (e.clientY - rect.top - mapaOffY) / mapaScale;
    const prev = hoveredNode;
    hoveredNode = getNodeAt(mx, my);
    if (hoveredNode !== prev) {
      mapaCanvas.style.cursor = hoveredNode !== null ? 'pointer' : 'grab';
      drawMapa();
    }
    if (hoveredNode !== null) showMapaTip(e, mapaNodes[hoveredNode]);
    else hideMapaTip();
  });
  mapaCanvas.addEventListener('mouseup', e => {
    if (!mapaDrag || (Math.abs(e.clientX - mapaDragX - mapaOffX) < 3)) {
      const rect = mapaCanvas.getBoundingClientRect();
      const mx = (e.clientX - rect.left - mapaOffX) / mapaScale;
      const my = (e.clientY - rect.top - mapaOffY) / mapaScale;
      const n = getNodeAt(mx, my);
      if (n !== null) onNodeClick(n);
    }
    mapaDrag = false;
  });
  mapaCanvas.addEventListener('wheel', e => {
    e.preventDefault();
    mapaScale = Math.max(.5, Math.min(2.5, mapaScale - e.deltaY * .001));
    drawMapa();
  }, {passive:false});
  
  // Touch events
  let lastTouchDist = 0;
  mapaCanvas.addEventListener('touchstart', e => {
    if (e.touches.length === 1) {
      mapaDrag = true;
      mapaDragX = e.touches[0].clientX - mapaOffX;
      mapaDragY = e.touches[0].clientY - mapaOffY;
    } else if (e.touches.length === 2) {
      lastTouchDist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY);
    }
  }, {passive:true});
  mapaCanvas.addEventListener('touchmove', e => {
    e.preventDefault();
    if (e.touches.length === 1 && mapaDrag) {
      mapaOffX = e.touches[0].clientX - mapaDragX;
      mapaOffY = e.touches[0].clientY - mapaDragY;
      drawMapa();
    } else if (e.touches.length === 2) {
      const dist = Math.hypot(e.touches[0].clientX - e.touches[1].clientX, e.touches[0].clientY - e.touches[1].clientY);
      mapaScale = Math.max(.5, Math.min(2.5, mapaScale * (dist / lastTouchDist)));
      lastTouchDist = dist;
      drawMapa();
    }
  }, {passive:false});
  mapaCanvas.addEventListener('touchend', e => {
    if (mapaDrag && e.changedTouches.length) {
      const rect = mapaCanvas.getBoundingClientRect();
      const t = e.changedTouches[0];
      const mx = (t.clientX - rect.left - mapaOffX) / mapaScale;
      const my = (t.clientY - rect.top - mapaOffY) / mapaScale;
      const n = getNodeAt(mx, my);
      if (n !== null) onNodeClick(n);
    }
    mapaDrag = false;
  });
}

function getNodeAt(mx, my) {
  for (let i = mapaNodes.length - 1; i >= 0; i--) {
    const n = mapaNodes[i];
    const nx = n.x * mapaW, ny = n.y * mapaH;
    if (Math.hypot(mx - nx, my - ny) <= n.r) return i;
  }
  return null;
}

function onNodeClick(idx) {
  const n = mapaNodes[idx];
  showMapaTip(null, n, true);
  // Track for badge
  const c = parseInt(localStorage.getItem('dpe_mapa_clicks') || '0') + 1;
  localStorage.setItem('dpe_mapa_clicks', c);
  checkBadges();
}

function showMapaTip(e, node, pinned=false) {
  const tip = document.getElementById('mapa-tooltip');
  document.getElementById('mapa-tip-title').textContent = node.label.replace('\n', ' ');
  document.getElementById('mapa-tip-body').innerHTML = node.info;
  tip.style.display = 'block';
  if (e) {
    const rect = mapaCanvas.getBoundingClientRect();
    let x = e.clientX - rect.left + 12;
    let y = e.clientY - rect.top - 20;
    if (x + 300 > mapaW) x = mapaW - 300;
    if (y + 200 > mapaH) y = mapaH - 200;
    if (y < 0) y = 0;
    tip.style.left = x + 'px';
    tip.style.top = y + 'px';
  } else {
    tip.style.left = '50%';
    tip.style.top = '10px';
    tip.style.transform = 'translateX(-50%)';
  }
}

function hideMapaTip() {
  document.getElementById('mapa-tooltip').style.display = 'none';
}

function drawMapa() {
  if (!mapaCtx) return;
  mapaCtx.clearRect(0, 0, mapaW, mapaH);
  mapaCtx.save();
  mapaCtx.translate(mapaOffX, mapaOffY);
  mapaCtx.scale(mapaScale, mapaScale);
  
  // Draw edges
  mapaEdges.forEach(([a, b]) => {
    const na = mapaNodes[a], nb = mapaNodes[b];
    const ax = na.x * mapaW, ay = na.y * mapaH;
    const bx = nb.x * mapaW, by = nb.y * mapaH;
    mapaCtx.beginPath();
    mapaCtx.moveTo(ax, ay);
    mapaCtx.lineTo(bx, by);
    mapaCtx.strokeStyle = 'rgba(201,168,76,0.25)';
    mapaCtx.lineWidth = 2;
    mapaCtx.stroke();
  });
  
  // Draw nodes
  mapaNodes.forEach((n, i) => {
    const nx = n.x * mapaW, ny = n.y * mapaH;
    const isHov = hoveredNode === i;
    const r = isHov ? n.r + 4 : n.r;
    
    // Glow
    if (isHov || n.main) {
      const glow = mapaCtx.createRadialGradient(nx, ny, r*.3, nx, ny, r*1.6);
      glow.addColorStop(0, n.color + '44');
      glow.addColorStop(1, 'transparent');
      mapaCtx.beginPath();
      mapaCtx.arc(nx, ny, r * 1.6, 0, Math.PI*2);
      mapaCtx.fillStyle = glow;
      mapaCtx.fill();
    }
    
    // Circle
    const grad = mapaCtx.createRadialGradient(nx-r*.3, ny-r*.3, 0, nx, ny, r);
    grad.addColorStop(0, n.color + 'DD');
    grad.addColorStop(1, n.color);
    mapaCtx.beginPath();
    mapaCtx.arc(nx, ny, r, 0, Math.PI*2);
    mapaCtx.fillStyle = grad;
    mapaCtx.fill();
    
    // Border
    mapaCtx.beginPath();
    mapaCtx.arc(nx, ny, r, 0, Math.PI*2);
    mapaCtx.strokeStyle = isHov ? '#F0C860' : 'rgba(255,255,255,0.2)';
    mapaCtx.lineWidth = isHov ? 3 : 1.5;
    mapaCtx.stroke();
    
    // Label
    const lines = n.label.split('\n');
    mapaCtx.fillStyle = n.textColor;
    mapaCtx.textAlign = 'center';
    mapaCtx.textBaseline = 'middle';
    const fs = n.main ? 13 : 10;
    mapaCtx.font = 'bold ' + fs + 'px DM Sans, sans-serif';
    const lineH = fs + 3;
    lines.forEach((line, li) => {
      const yOff = (li - (lines.length-1)/2) * lineH;
      mapaCtx.fillText(line, nx, ny + yOff);
    });
  });
  
  mapaCtx.restore();
}

// Init on load
renderConquistas();
setTimeout(() => checkBadges(true), 500);


// ============================================================
//  THEME SYSTEM
// ============================================================
const themes = ['', 'theme-silver', 'theme-bronze', 'theme-light'];
const themeLabels = ['üåë Obsidian Gold', 'üåï Prata Elite', 'üü§ Bronze Imperial', '‚òÄÔ∏è Modo Claro'];
let currentTheme = 0;

function cycleTheme() {
  document.body.classList.remove(themes[currentTheme]);
  currentTheme = (currentTheme + 1) % themes.length;
  if (themes[currentTheme]) document.body.classList.add(themes[currentTheme]);
  localStorage.setItem('dpe_theme', currentTheme);
  showToast('üé® Tema: ' + themeLabels[currentTheme]);
}

// Restore theme on load
(function() {
  const saved = parseInt(localStorage.getItem('dpe_theme') || '0');
  if (saved && themes[saved]) {
    currentTheme = saved;
    document.body.classList.add(themes[saved]);
  }
})();


// ============================================================
//  MODO BATALHA
// ============================================================
//  MODO BATALHA
// ============================================================
const batalhaData = [...quizData].sort(() => Math.random() - 0.5);
let bIdx = 0, bScore = 0, bLives = 3, bTimer = null, bCombo = 0, bMaxCombo = 0;
let bRunning = false;

function updateBatalhaStats() {
  const rec = parseInt(localStorage.getItem('dpe_batalha_record') || '0');
  const played = parseInt(localStorage.getItem('dpe_batalha_played') || '0');
  const el1 = document.getElementById('bt-record');
  const el2 = document.getElementById('bt-played');
  if (el1) el1.textContent = rec;
  if (el2) el2.textContent = played;
}

function startBatalha() {
  bIdx = 0; bScore = 0; bLives = 3; bCombo = 0; bMaxCombo = 0; bRunning = true;
  batalhaData.sort(() => Math.random() - 0.5);
  document.getElementById('batalha-start-screen').style.display = 'none';
  document.getElementById('batalha-over').style.display = 'none';
  document.getElementById('batalha-game').style.display = 'block';
  renderBatalhaQuestion();
}

function renderBatalhaQuestion() {
  if (!bRunning) return;
  if (bIdx >= batalhaData.length) { endBatalha(true); return; }
  const q = batalhaData[bIdx];
  document.getElementById('bCat').textContent = q.cat;
  document.getElementById('bQuestion').textContent = q.q;
  updateBLives();
  
  const opts = document.getElementById('bOptions');
  opts.innerHTML = '';
  q.opts.forEach((opt, i) => {
    const btn = document.createElement('button');
    btn.className = 'b-opt';
    btn.textContent = opt;
    btn.onclick = () => answerBatalha(i, q.correct);
    opts.appendChild(btn);
  });
  startBTimer();
}

function startBTimer() {
  clearInterval(bTimer);
  let t = 20;
  document.getElementById('bTimerFill').style.width = '100%';
  document.getElementById('bTimerNum').textContent = t;
  document.getElementById('bTimerNum').classList.remove('urgent');
  bTimer = setInterval(() => {
    t--;
    const pct = (t / 20 * 100);
    document.getElementById('bTimerFill').style.width = pct + '%';
    document.getElementById('bTimerNum').textContent = t;
    if (t <= 5) document.getElementById('bTimerNum').classList.add('urgent');
    if (t <= 0) {
      clearInterval(bTimer);
      bCombo = 0;
      bLives--;
      updateBLives();
      playSound('wrong');
      if (bLives <= 0) { endBatalha(false); return; }
      bIdx++;
      setTimeout(renderBatalhaQuestion, 800);
    }
  }, 1000);
}

function answerBatalha(chosen, correct) {
  clearInterval(bTimer);
  const btns = document.querySelectorAll('.b-opt');
  btns.forEach(b => b.disabled = true);
  btns[chosen].classList.add(chosen === correct ? 'correct' : 'wrong');
  if (chosen !== correct) btns[correct].classList.add('correct');
  
  if (chosen === correct) {
    bCombo++;
    bMaxCombo = Math.max(bMaxCombo, bCombo);
    const pts = 10 + (bCombo > 1 ? bCombo * 3 : 0);
    bScore += pts;
    playSound('correct');
    document.getElementById('bScore').textContent = bScore;
    showToast(bCombo > 2 ? 'üî• COMBO x' + bCombo + '! +' + pts + ' pts' : '‚úÖ +' + pts + ' pts');
  } else {
    bCombo = 0;
    bLives--;
    updateBLives();
    playSound('wrong');
    if (bLives <= 0) { setTimeout(() => endBatalha(false), 700); return; }
  }
  bIdx++;
  setTimeout(renderBatalhaQuestion, 700);
}

function updateBLives() {
  const icons = ['‚ù§Ô∏è','‚ù§Ô∏è','‚ù§Ô∏è'];
  for (let i = 0; i < 3; i++) {
    if (i >= bLives) icons[i] = 'üñ§';
  }
  document.getElementById('bLives').textContent = icons.join(' ');
}

function endBatalha(completed) {
  bRunning = false;
  clearInterval(bTimer);
  const record = parseInt(localStorage.getItem('dpe_batalha_record') || '0');
  const isRecord = bScore > record;
  if (isRecord) localStorage.setItem('dpe_batalha_record', bScore);
  const played = parseInt(localStorage.getItem('dpe_batalha_played') || '0') + 1;
  localStorage.setItem('dpe_batalha_played', played);
  
  document.getElementById('batalha-game').style.display = 'none';
  document.getElementById('batalha-over').style.display = 'block';
  document.getElementById('bOverIcon').textContent = completed ? 'üèÜ' : bScore > record ? '‚≠ê' : 'üíÄ';
  document.getElementById('bOverTitle').textContent = completed ? 'Completou Tudo!' : bScore > record ? 'Novo Recorde!' : 'Fim de Jogo!';
  document.getElementById('bOverScore').textContent = bScore + ' pontos';
  document.getElementById('bOverRecord').textContent = isRecord ? 'üèÜ NOVO RECORDE PESSOAL!' : 'Recorde: ' + record + ' pts';
  document.getElementById('bOverCombo').textContent = bMaxCombo > 2 ? 'üî• Maior combo: x' + bMaxCombo : '';
  
  // Save to batalha history for analise
  const bHist = JSON.parse(localStorage.getItem('dpe_batalha_history') || '[]');
  bHist.unshift({ score: bScore, combo: bMaxCombo, correct: Math.floor(bScore/10), date: new Date().toLocaleDateString('pt-BR') });
  if (bHist.length > 20) bHist.pop();
  localStorage.setItem('dpe_batalha_history', JSON.stringify(bHist));
  
  if (isRecord) showToast('üèÜ NOVO RECORDE: ' + bScore + ' pontos!');
  checkBadges();
}

// ============================================================
//  PLANO DE ESTUDO 30 DIAS
// ============================================================
const planoDays = [
  { week:1, day:1, title:'Vis√£o Geral do Conv√™nio', desc:'Leia as p√°ginas 1-3: objeto, vig√™ncia, partes convenentes e √°reas abrangidas.', tab:'doc' },
  { week:1, day:2, title:'√Åreas Exclu√≠das e Exce√ß√µes', desc:'P√°gina 2: entenda o que N√ÉO est√° coberto e as veda√ß√µes espec√≠ficas.', tab:'doc' },
  { week:1, day:3, title:'Obriga√ß√µes da OAB/SP', desc:'P√°ginas 2-3: obriga√ß√µes, atendimento inicial e prote√ß√£o de dados (LGPD).', tab:'doc' },
  { week:1, day:4, title:'Obriga√ß√µes da Defensoria', desc:'P√°gina 4: o que a Defensoria deve fazer, prazos de pagamento e certid√µes.', tab:'doc' },
  { week:1, day:5, title:'Deveres dos Advogados I', desc:'P√°ginas 5-6: obriga√ß√µes do advogado conveniado, itens I a XIV.', tab:'doc' },
  { week:1, day:6, title:'Deveres dos Advogados II', desc:'P√°gina 6: deveres XV a XXX, gratuidade e atendimento ao usu√°rio.', tab:'doc' },
  { week:1, day:7, title:'Revis√£o Semana 1 ‚Äî Flashcards', desc:'Filtre os cards de GERAL e revise com foco em objeto, partes e deveres.', tab:'flash' },
  { week:2, day:8, title:'Inscri√ß√µes e Requisitos', desc:'P√°ginas 7-8: edital, periodicidade, requisitos e documenta√ß√£o exigida.', tab:'doc' },
  { week:2, day:9, title:'J√∫ri, VD e Inf√¢ncia', desc:'P√°gina 8: requisitos especiais para Tribunal do J√∫ri, viol√™ncia dom√©stica e IJ.', tab:'doc' },
  { week:2, day:10, title:'Indica√ß√µes na √Årea C√≠vel', desc:'P√°ginas 9-10: prazos de 6 meses e 30 dias, separa√ß√£o e cumula√ß√£o de pedidos.', tab:'doc' },
  { week:2, day:11, title:'Indica√ß√µes na √Årea Criminal', desc:'P√°gina 10: quando ocorre a indica√ß√£o, audi√™ncia de cust√≥dia e ANPP.', tab:'doc' },
  { week:2, day:12, title:'Tribunal do J√∫ri e VD', desc:'P√°ginas 11: regras do J√∫ri, medidas protetivas e vincula√ß√£o de 12 meses.', tab:'doc' },
  { week:2, day:13, title:'Inf√¢ncia e Recusa/Ren√∫ncia', desc:'P√°ginas 12-13: IJ, aceite, recusa e ren√∫ncia ‚Äî diferen√ßas e prazos.', tab:'doc' },
  { week:2, day:14, title:'Revis√£o Semana 2 ‚Äî Flashcards', desc:'Filtre C√çVEL e CRIMINAL. Foque nos prazos de 30 dias, 6 meses e 12 meses.', tab:'flash' },
  { week:3, day:15, title:'Plant√µes e Atividades Especiais', desc:'P√°gina 14: plant√µes duplos, cartas precat√≥rias e JEC. Regra dos 2 dias.', tab:'doc' },
  { week:3, day:16, title:'Pagamentos e Certid√µes I', desc:'P√°gina 15: tabela de honor√°rios, prazo de protocolo e reajuste IPC/FIPE.', tab:'doc' },
  { week:3, day:17, title:'Honor√°rios Criminais Detalhados', desc:'P√°ginas 16-17: percentuais por tipo de senten√ßa, J√∫ri e execu√ß√£o penal.', tab:'doc' },
  { week:3, day:18, title:'Honor√°rios C√≠veis Detalhados', desc:'P√°ginas 17-18: proced√™ncia, improced√™ncia, acordo e certid√µes parciais.', tab:'doc' },
  { week:3, day:19, title:'Tabela de Honor√°rios', desc:'Aba Honor√°rios: memorize os valores das 10 principais a√ß√µes.', tab:'honorarios' },
  { week:3, day:20, title:'Revis√£o Semana 3 ‚Äî Honor√°rios', desc:'Filtre HONOR√ÅRIOS nos flashcards. Foque em percentuais e prescri√ß√£o de 5 anos.', tab:'flash' },
  { week:3, day:21, title:'Simulado Parcial ‚Äî 25 Quest√µes', desc:'Fa√ßa metade do quiz. Anote as categorias onde errou mais.', tab:'quiz' },
  { week:4, day:22, title:'Fiscaliza√ß√£o e C√¢maras', desc:'P√°ginas 20-21: instaura√ß√£o, c√¢maras parit√°rias e recursal, prazos.', tab:'doc' },
  { week:4, day:23, title:'San√ß√µes e Penalidades', desc:'P√°ginas 21-22: tipos de san√ß√£o, descredenciamento obrigat√≥rio, suspens√£o cautelar.', tab:'doc' },
  { week:4, day:24, title:'Prescri√ß√£o e Disposi√ß√µes Finais', desc:'P√°ginas 22-23: prescri√ß√£o de infra√ß√£o (5 anos), execu√ß√£o da pena, sigilo.', tab:'doc' },
  { week:4, day:25, title:'50 Regras Cr√≠ticas', desc:'Aba 50 Regras: leia todas as regras e identifique as que n√£o domina ainda.', tab:'rules' },
  { week:4, day:26, title:'Revis√£o com IA ‚Äî Pontos Fracos', desc:'Use o Assistente IA para aprofundar nos temas onde errou mais.', tab:'ia' },
  { week:4, day:27, title:'Modo Batalha ‚Äî 3 Partidas', desc:'Jogue 3 partidas no Modo Batalha. Meta: superar 150 pontos em ao menos 1.', tab:'batalha' },
  { week:4, day:28, title:'Revis√£o Total ‚Äî Todos Flashcards', desc:'Vire todos os 50 flashcards. Marque favoritos nos que ainda tem d√∫vida.', tab:'flash' },
  { week:4, day:29, title:'Quiz Completo ‚Äî 50 Quest√µes', desc:'Fa√ßa o quiz completo. Meta: 70%+. Analise o breakdown por categoria.', tab:'quiz' },
  { week:4, day:30, title:'An√°lise Final e Certificado', desc:'Veja sua an√°lise de desempenho, conquistas desbloqueadas e imprima seu certificado!', tab:'conquistas' },
];

function renderPlano() {
  const grid = document.getElementById('planoGrid');
  const done = JSON.parse(localStorage.getItem('dpe_plano_done') || '[]');
  const total = planoDays.length;
  const completed = done.length;
  
  document.getElementById('planoPropFill').style.width = (completed/total*100) + '%';
  document.getElementById('planoProgText').textContent = completed + ' / ' + total + ' dias conclu√≠dos';
  document.getElementById('planoPercent').textContent = Math.round(completed/total*100) + '%';
  
  grid.innerHTML = '';
  let lastWeek = 0;
  planoDays.forEach((d, i) => {
    if (d.week !== lastWeek) {
      lastWeek = d.week;
      const wh = document.createElement('div');
      wh.className = 'plano-week-header';
      wh.textContent = 'üìÖ Semana ' + d.week;
      grid.appendChild(wh);
    }
    const isDone = done.includes(i);
    const card = document.createElement('div');
    card.className = 'plano-card' + (isDone ? ' done' : '');
    card.innerHTML = `
      <div class="plano-day">Dia ${d.day}</div>
      <div class="plano-title">${d.title}</div>
      <div class="plano-desc">${d.desc}</div>
      <div class="plano-check">${isDone ? '‚úÖ' : '‚≠ï'}</div>
    `;
    card.onclick = () => {
      const idx = done.indexOf(i);
      if (idx === -1) { done.push(i); showToast('‚úÖ Dia ' + d.day + ' marcado como conclu√≠do!'); }
      else { done.splice(idx, 1); }
      localStorage.setItem('dpe_plano_done', JSON.stringify(done));
      renderPlano();
      checkBadges();
    };
    // Button to go to the tab
    if (d.tab) {
      const btn = document.createElement('button');
      btn.textContent = '‚ñ∂ Ir para ' + d.tab;
      btn.style.cssText = 'margin-top:10px;background:none;border:1px solid var(--border);color:var(--gold);padding:5px 12px;border-radius:6px;cursor:pointer;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:.5px;';
      btn.onclick = (e) => { e.stopPropagation(); document.querySelector('[onclick="openTab('' + d.tab + '')"]')?.click(); };
      card.appendChild(btn);
    }
    grid.appendChild(card);
  });
}

// ============================================================
//  AN√ÅLISE DE DESEMPENHO (IA-powered)
// ============================================================
function renderAnalise() {
  const history = JSON.parse(localStorage.getItem('dpe_quiz_history') || '[]');
  const bHistory = JSON.parse(localStorage.getItem('dpe_batalha_history') || '[]');
  const planoDone = JSON.parse(localStorage.getItem('dpe_plano_done') || '[]');
  
  const cards = document.getElementById('analiseCards');
  const bestQuiz = history.length ? Math.max(...history.map(h => parseInt(h.pct))) : 0;
  const quizAttempts = history.length;
  const bRecord = parseInt(localStorage.getItem('dpe_batalha_record') || '0');
  const iaCount = parseInt(localStorage.getItem('dpe_ia_count') || '0');
  
  cards.innerHTML = `
    <div class="analise-card"><div class="ac-icon">üéØ</div><div class="ac-val">${bestQuiz}%</div><div class="ac-label">Melhor Quiz</div></div>
    <div class="analise-card"><div class="ac-icon">üìù</div><div class="ac-val">${quizAttempts}</div><div class="ac-label">Tentativas</div></div>
    <div class="analise-card"><div class="ac-icon">‚öîÔ∏è</div><div class="ac-val">${bRecord}</div><div class="ac-label">Recorde Batalha</div></div>
    <div class="analise-card"><div class="ac-icon">üìÖ</div><div class="ac-val">${planoDone.length}/30</div><div class="ac-label">Plano 30 Dias</div></div>
    <div class="analise-card"><div class="ac-icon">üÉè</div><div class="ac-val">${flippedCount}</div><div class="ac-label">Cards Virados</div></div>
    <div class="analise-card"><div class="ac-icon">ü§ñ</div><div class="ac-val">${iaCount}</div><div class="ac-label">Consultas IA</div></div>
  `;
  
  // Category analysis from quiz history + answerLog
  if (answerLog.length > 0) {
    const catMap = {};
    answerLog.forEach(e => {
      if (!catMap[e.cat]) catMap[e.cat] = { c:0, t:0 };
      catMap[e.cat].t++;
      if (e.correct) catMap[e.cat].c++;
    });
    const sorted = Object.entries(catMap).sort((a,b) => (a[1].c/a[1].t) - (b[1].c/b[1].t));
    const weakDiv = document.getElementById('analiseWeakList');
    weakDiv.innerHTML = sorted.map(([cat, d]) => {
      const p = Math.round(d.c/d.t*100);
      const cls = p >= 70 ? 'ok' : p >= 50 ? 'mid' : '';
      return `<div class="weak-item">
        <span class="wi-cat">${cat}</span>
        <div class="wi-bar"><div class="wi-fill ${cls}" style="width:${p}%"></div></div>
        <span class="wi-pct" style="color:${p>=70?'var(--gold)':p>=50?'#F39C12':'#E74C3C'}">${p}%</span>
      </div>`;
    }).join('');
    document.getElementById('analiseWeak').style.display = 'block';
  }
}

async function runAnaliseIA() {
  const history = JSON.parse(localStorage.getItem('dpe_quiz_history') || '[]');
  const planoDone = JSON.parse(localStorage.getItem('dpe_plano_done') || '[]');
  const bRecord = parseInt(localStorage.getItem('dpe_batalha_record') || '0');
  const streakData = JSON.parse(localStorage.getItem('dpe_streak') || '{"streak":0,"studiedDays":[]}');
  
  const box = document.getElementById('analiseIaContent');
  box.innerHTML = '<div class="ia-typing" style="padding:20px 0;justify-content:center;"><span></span><span></span><span></span></div>';
  
  // Build performance summary
  const catSummary = {};
  answerLog.forEach(e => {
    if (!catSummary[e.cat]) catSummary[e.cat] = { c:0, t:0 };
    catSummary[e.cat].t++;
    if (e.correct) catSummary[e.cat].c++;
  });
  const catText = Object.entries(catSummary).map(([cat, d]) => `${cat}: ${Math.round(d.c/d.t*100)}%`).join(', ');
  const bestQuiz = history.length ? Math.max(...history.map(h => parseInt(h.pct))) : 0;
  
  const prompt = `Voc√™ √© um tutor especialista no Conv√™nio DPE-OAB/SP 001/2026.

Analise o desempenho desta estudante e crie um plano de estudo personalizado:

DADOS:
- Melhor resultado no quiz: ${bestQuiz}%
- Tentativas no quiz: ${history.length}
- Desempenho por categoria: ${catText || 'ainda sem dados'}
- Recorde no Modo Batalha: ${bRecord} pontos
- Dias do plano 30 dias conclu√≠dos: ${planoDone.length}/30
- Streak atual: ${streakData.streak || 0} dias

TAREFA:
1. Identifique os 3 pontos mais fracos
2. Recomende 3 a√ß√µes pr√°ticas e espec√≠ficas para melhorar
3. D√™ uma mensagem motivacional personalizada
4. Estime quando ela pode atingir 90%+ no quiz

Seja direto, pr√°tico e encorajador. Use emojis. Responda em portugu√™s.`;

  try {
    const resp = await fetch('https://api.anthropic.com/v1/messages', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({
        model: 'claude-sonnet-4-20250514',
        max_tokens: 1000,
        messages: [{ role: 'user', content: prompt }]
      })
    });
    const data = await resp.json();
    const reply = (data.content?.[0]?.text || 'Erro ao gerar an√°lise.')
      .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
      .replace(/
/g, '<br>');
    box.innerHTML = '<div class="analise-ia-response">' + reply + '</div><button class="btn-outline" onclick="runAnaliseIA()" style="margin-top:16px;">üîÑ Regenerar An√°lise</button>';
  } catch(e) {
    box.innerHTML = '<p style="color:var(--red);">‚ùå Erro ao conectar com a IA.</p><button class="btn-gold" onclick="runAnaliseIA()">Tentar novamente</button>';
  }
  
  const c = parseInt(localStorage.getItem('dpe_ia_count')||'0') + 1;
  localStorage.setItem('dpe_ia_count', c);
  checkBadges();
}

// ============================================================
//  STREAK DI√ÅRIO
// ============================================================
const STREAK_KEY = 'dpe_streak';

function getStreakData() {
  return JSON.parse(localStorage.getItem(STREAK_KEY) || '{"streak":0,"lastDate":null,"studiedDays":[],"longestStreak":0}');
}

function markStudyToday() {
  const data = getStreakData();
  const today = new Date().toISOString().slice(0, 10);
  
  if (data.studiedDays.includes(today)) {
    showToast('‚úÖ Voc√™ j√° marcou o estudo de hoje!');
    return;
  }
  
  const yesterday = new Date(Date.now() - 86400000).toISOString().slice(0, 10);
  if (data.lastDate === yesterday) {
    data.streak++;
  } else if (data.lastDate !== today) {
    data.streak = 1;
  }
  
  data.longestStreak = Math.max(data.longestStreak || 0, data.streak);
  data.lastDate = today;
  data.studiedDays.push(today);
  if (data.studiedDays.length > 90) data.studiedDays = data.studiedDays.slice(-90);
  
  localStorage.setItem(STREAK_KEY, JSON.stringify(data));
  
  const msgs = ['üî• Incr√≠vel! Mais um dia de estudo!', '‚ö° Voc√™ est√° impar√°vel!', 'üèÜ Consist√™ncia √© a chave do sucesso!', 'üåü Mais um passo rumo √† especializa√ß√£o!'];
  showToast(msgs[Math.floor(Math.random() * msgs.length)] + ' Streak: ' + data.streak + ' dias!');
  
  updateStreakHeader();
  renderStreak();
  checkBadges();
}

function updateStreakHeader() {
  const data = getStreakData();
  const btn = document.getElementById('streakHeaderBtn');
  if (btn) btn.textContent = 'üî• ' + data.streak;
}

function renderStreak() {
  const data = getStreakData();
  const el = document.getElementById('streakNumber');
  const msg = document.getElementById('streakMsg');
  const fire = document.getElementById('streakFireIcon');
  
  if (el) el.textContent = data.streak;
  
  if (data.streak === 0) {
    if (msg) msg.textContent = 'Comece hoje seu streak!';
    if (fire) fire.textContent = 'üî•';
  } else if (data.streak < 3) {
    if (msg) msg.textContent = '√ìtimo come√ßo! Continue assim!';
    if (fire) fire.textContent = 'üî•';
  } else if (data.streak < 7) {
    if (msg) msg.textContent = data.streak + ' dias! Voc√™ est√° pegando fogo!';
    if (fire) fire.textContent = 'üî•';
  } else if (data.streak < 15) {
    if (msg) msg.textContent = 'Semana completa! Voc√™ √© impar√°vel! üöÄ';
    if (fire) fire.textContent = 'üî•üî•';
  } else if (data.streak < 30) {
    if (msg) msg.textContent = 'Especialista em forma√ß√£o ‚Äî ' + data.streak + ' dias seguidos! üèÜ';
    if (fire) fire.textContent = 'üî•üî•üî•';
  } else {
    if (msg) msg.textContent = 'üåü LENDA! ' + data.streak + ' dias consecutivos de estudo!';
    if (fire) fire.textContent = 'üëë';
  }
  
  // Check if already studied today
  const today = new Date().toISOString().slice(0, 10);
  const alreadyDone = data.studiedDays.includes(today);
  const btn = document.getElementById('streakCheckBtn');
  if (btn) {
    btn.textContent = alreadyDone ? '‚úÖ Estudo de Hoje Marcado!' : '‚úÖ Marcar Estudo de Hoje';
    btn.disabled = alreadyDone;
    btn.style.opacity = alreadyDone ? '.6' : '1';
  }
  
  // Calendar ‚Äî last 35 days
  const cal = document.getElementById('streakCalendar');
  if (cal) {
    const days35 = [];
    for (let i = 34; i >= 0; i--) {
      const d = new Date(Date.now() - i * 86400000);
      days35.push(d.toISOString().slice(0, 10));
    }
    cal.innerHTML = `<div class="streak-cal-title">üìÖ √öltimos 35 Dias</div>
      <div class="streak-cal-grid">` +
      days35.map(d => {
        const isStudied = data.studiedDays.includes(d);
        const isToday = d === today;
        const day = parseInt(d.slice(8));
        return `<div class="streak-cal-day ${isStudied?'studied':''} ${isToday?'today':''}" title="${d}">${day}</div>`;
      }).join('') + '</div>';
  }
  
  // Milestones
  const miles = [
    { days:1, icon:'üå±', label:'Primeira Semente' },
    { days:3, icon:'üî•', label:'Fogo Inicial' },
    { days:7, icon:'‚ö°', label:'Semana Completa' },
    { days:14, icon:'üåü', label:'Duas Semanas' },
    { days:21, icon:'üí™', label:'H√°bito Formado' },
    { days:30, icon:'üèÜ', label:'M√™s Completo' },
    { days:60, icon:'üíé', label:'Dois Meses' },
    { days:100, icon:'üëë', label:'Centen√°ria' },
  ];
  const mg = document.getElementById('streakMilesGrid');
  if (mg) {
    mg.innerHTML = miles.map(m => {
      const reached = (data.longestStreak || data.streak) >= m.days;
      return `<div class="streak-mile ${reached?'reached':''}">
        <span class="sm-icon">${reached ? m.icon : 'üîí'}</span>
        <div class="sm-days">${m.days}d</div>
        <div class="sm-label">${m.label}</div>
      </div>`;
    }).join('');
  }
}

// Add streak badges
badgesDef.push(
  { id:'streak3',   icon:'üî•', name:'Chama Acesa',       desc:'3 dias consecutivos de estudo',              check: () => (getStreakData().streak||0) >= 3 },
  { id:'streak7',   icon:'‚ö°', name:'Semana de Fogo',    desc:'7 dias consecutivos de estudo',              check: () => (getStreakData().longestStreak||0) >= 7 },
  { id:'streak30',  icon:'üëë', name:'M√™s de Ouro',       desc:'30 dias consecutivos de estudo',             check: () => (getStreakData().longestStreak||0) >= 30 },
  { id:'plano15',   icon:'üìÖ', name:'Meio Caminho',      desc:'Completou 15 dias do plano de 30 dias',      check: () => JSON.parse(localStorage.getItem('dpe_plano_done')||'[]').length >= 15 },
  { id:'plano30',   icon:'üéì', name:'Plano Completo',    desc:'Completou todos os 30 dias do plano',        check: () => JSON.parse(localStorage.getItem('dpe_plano_done')||'[]').length >= 30 },
  { id:'batalha100',icon:'‚öîÔ∏è', name:'Combatente',        desc:'Atingiu 100 pontos no Modo Batalha',         check: () => parseInt(localStorage.getItem('dpe_batalha_record')||'0') >= 100 },
  { id:'batalha300',icon:'üèÖ', name:'Guerreira da Lei',  desc:'Atingiu 300 pontos no Modo Batalha',         check: () => parseInt(localStorage.getItem('dpe_batalha_record')||'0') >= 300 }
);

// Init
updateStreakHeader();

</script>
</body>
</html>
